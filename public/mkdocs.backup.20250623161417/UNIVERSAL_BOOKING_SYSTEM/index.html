
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Complete documentation for AskProAI platform">
      
      
      
        <link rel="canonical" href="https://api.askproai.de/mkdocs/UNIVERSAL_BOOKING_SYSTEM/">
      
      
        <link rel="prev" href="../ENHANCED_BOOKING_SERVICE/">
      
      
        <link rel="next" href="../CALCOM_V2_API_DOCUMENTATION/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Universal Booking - AskProAI Complete Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#universal-multi-tenant-multi-location-booking-system" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="AskProAI Complete Documentation" class="md-header__button md-logo" aria-label="AskProAI Complete Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AskProAI Complete Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Universal Booking
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../quickstart/" class="md-tabs__link">
        
  
  
    
  
  Quick Start

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../status/" class="md-tabs__link">
        
  
  
    
  
  System Status

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../changelog/" class="md-tabs__link">
        
  
  
    
  
  Changelog

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../architecture/overview/" class="md-tabs__link">
          
  
  
  Architecture

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../api/models/" class="md-tabs__link">
          
  
  
  API Documentation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../MCP_COMPLETE_OVERVIEW/" class="md-tabs__link">
          
  
  
  MCP System

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../SERVICE_ARCHITECTURE/" class="md-tabs__link">
          
  
  
  Service Documentation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../DEPLOYMENT_GUIDE/" class="md-tabs__link">
          
  
  
  Operations

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../configuration/reference/" class="md-tabs__link">
          
  
  
  Configuration

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../TESTING_STRATEGY/" class="md-tabs__link">
          
  
  
  Testing

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../database_cleanup_plan/" class="md-tabs__link">
          
  
  
  Planning

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../DASHBOARD_REDESIGN_README/" class="md-tabs__link">
          
  
  
  UI/UX

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../STRUCTURED_LOGGER_GUIDE/" class="md-tabs__link">
          
  
  
  Developer Tools

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../statistics/" class="md-tabs__link">
        
  
  
    
  
  Statistics

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="AskProAI Complete Documentation" class="md-nav__button md-logo" aria-label="AskProAI Complete Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    AskProAI Complete Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quick Start
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../status/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    System Status
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/database-schema/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Database Schema
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Services
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/mcp-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MCP Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/routes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Routes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    MCP System
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            MCP System
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MCP_COMPLETE_OVERVIEW/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Complete Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MCP_INTEGRATION_GUIDE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Integration Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MCP_SETUP_COMPLETE_GUIDE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setup Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MCP_EVOLUTION_SYSTEM/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Evolution System
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CALCOM_MCP_SERVER_API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cal.com MCP Server
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../KNOWLEDGE_MCP_SERVER/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Knowledge MCP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../QUEUE_MCP_IMPLEMENTATION_COMPLETE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Queue MCP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SENTRY_MCP_INTEGRATION/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sentry MCP
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Service Documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Service Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SERVICE_ARCHITECTURE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Service Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ENHANCED_BOOKING_SERVICE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Enhanced Booking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Universal Booking
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Universal Booking
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    <span class="md-ellipsis">
      Key Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-intelligent-phone-number-resolution" class="md-nav__link">
    <span class="md-ellipsis">
      1. Intelligent Phone Number Resolution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-multi-branch-support" class="md-nav__link">
    <span class="md-ellipsis">
      2. Multi-Branch Support
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-smart-staff-matching" class="md-nav__link">
    <span class="md-ellipsis">
      3. Smart Staff Matching
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-flexible-branch-selection-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      4. Flexible Branch Selection Strategies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture-components" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture Components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Architecture Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-services" class="md-nav__link">
    <span class="md-ellipsis">
      Core Services
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Services">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#universalbookingorchestrator" class="md-nav__link">
    <span class="md-ellipsis">
      UniversalBookingOrchestrator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phonenumberresolver" class="md-nav__link">
    <span class="md-ellipsis">
      PhoneNumberResolver
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#staffservicematcher" class="md-nav__link">
    <span class="md-ellipsis">
      StaffServiceMatcher
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unifiedavailabilityservice" class="md-nav__link">
    <span class="md-ellipsis">
      UnifiedAvailabilityService
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#branch-selection-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      Branch Selection Strategies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#environment-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration File
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#database-schema-enhancements" class="md-nav__link">
    <span class="md-ellipsis">
      Database Schema Enhancements
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Database Schema Enhancements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#customer-preferences" class="md-nav__link">
    <span class="md-ellipsis">
      Customer Preferences
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#staff-capabilities" class="md-nav__link">
    <span class="md-ellipsis">
      Staff Capabilities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Service Requirements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#branch-features" class="md-nav__link">
    <span class="md-ellipsis">
      Branch Features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-branch-staff" class="md-nav__link">
    <span class="md-ellipsis">
      Multi-Branch Staff
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Usage Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-booking-request" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Booking Request
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#with-specific-preferences" class="md-nav__link">
    <span class="md-ellipsis">
      With Specific Preferences
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phone-webhook-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Phone Webhook Integration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flow-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Flow Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-features" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#custom-branch-selection-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Branch Selection Strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#staff-skill-matching" class="md-nav__link">
    <span class="md-ellipsis">
      Staff Skill Matching
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-language-support" class="md-nav__link">
    <span class="md-ellipsis">
      Multi-Language Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring-debugging" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring &amp; Debugging
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Monitoring &amp; Debugging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enable-debug-logging" class="md-nav__link">
    <span class="md-ellipsis">
      Enable Debug Logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-resolution-confidence" class="md-nav__link">
    <span class="md-ellipsis">
      Check Resolution Confidence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#availability-debugging" class="md-nav__link">
    <span class="md-ellipsis">
      Availability Debugging
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Considerations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-features" class="md-nav__link">
    <span class="md-ellipsis">
      Security Features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#future-enhancements" class="md-nav__link">
    <span class="md-ellipsis">
      Future Enhancements
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Common Issues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debug-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Debug Commands
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-endpoints" class="md-nav__link">
    <span class="md-ellipsis">
      API Endpoints
    </span>
  </a>
  
    <nav class="md-nav" aria-label="API Endpoints">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-availability" class="md-nav__link">
    <span class="md-ellipsis">
      Check Availability
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-booking" class="md-nav__link">
    <span class="md-ellipsis">
      Create Booking
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-booking-options" class="md-nav__link">
    <span class="md-ellipsis">
      Get Booking Options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CALCOM_V2_API_DOCUMENTATION/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cal.com V2 API
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Operations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Operations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DEPLOYMENT_GUIDE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deployment Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MONITORING_AND_ALERTING_GUIDE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Monitoring Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../TROUBLESHOOTING_GUIDE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operations/security-audit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security Audit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PERFORMANCE_INDEXES_MIGRATION/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Performance Indexes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DATABASE_SAFETY_GUIDELINES/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Database Safety
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Testing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../TESTING_STRATEGY/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing Strategy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UNIVERSAL_BOOKING_TEST_GUIDE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Universal Booking Tests
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Planning
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Planning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../database_cleanup_plan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Database Cleanup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../service_consolidation_plan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Service Consolidation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    UI/UX
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            UI/UX
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DASHBOARD_REDESIGN_README/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dashboard Redesign
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_14" >
        
          
          <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Developer Tools
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            Developer Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../STRUCTURED_LOGGER_GUIDE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Structured Logger
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RETELL_WEBHOOK_MCP_MIGRATION_GUIDE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Retell Webhook Migration
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../statistics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Statistics
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    <span class="md-ellipsis">
      Key Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-intelligent-phone-number-resolution" class="md-nav__link">
    <span class="md-ellipsis">
      1. Intelligent Phone Number Resolution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-multi-branch-support" class="md-nav__link">
    <span class="md-ellipsis">
      2. Multi-Branch Support
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-smart-staff-matching" class="md-nav__link">
    <span class="md-ellipsis">
      3. Smart Staff Matching
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-flexible-branch-selection-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      4. Flexible Branch Selection Strategies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture-components" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture Components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Architecture Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-services" class="md-nav__link">
    <span class="md-ellipsis">
      Core Services
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Services">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#universalbookingorchestrator" class="md-nav__link">
    <span class="md-ellipsis">
      UniversalBookingOrchestrator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phonenumberresolver" class="md-nav__link">
    <span class="md-ellipsis">
      PhoneNumberResolver
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#staffservicematcher" class="md-nav__link">
    <span class="md-ellipsis">
      StaffServiceMatcher
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unifiedavailabilityservice" class="md-nav__link">
    <span class="md-ellipsis">
      UnifiedAvailabilityService
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#branch-selection-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      Branch Selection Strategies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#environment-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration File
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#database-schema-enhancements" class="md-nav__link">
    <span class="md-ellipsis">
      Database Schema Enhancements
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Database Schema Enhancements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#customer-preferences" class="md-nav__link">
    <span class="md-ellipsis">
      Customer Preferences
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#staff-capabilities" class="md-nav__link">
    <span class="md-ellipsis">
      Staff Capabilities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Service Requirements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#branch-features" class="md-nav__link">
    <span class="md-ellipsis">
      Branch Features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-branch-staff" class="md-nav__link">
    <span class="md-ellipsis">
      Multi-Branch Staff
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Usage Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-booking-request" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Booking Request
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#with-specific-preferences" class="md-nav__link">
    <span class="md-ellipsis">
      With Specific Preferences
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phone-webhook-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Phone Webhook Integration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flow-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Flow Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-features" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#custom-branch-selection-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Branch Selection Strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#staff-skill-matching" class="md-nav__link">
    <span class="md-ellipsis">
      Staff Skill Matching
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-language-support" class="md-nav__link">
    <span class="md-ellipsis">
      Multi-Language Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring-debugging" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring &amp; Debugging
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Monitoring &amp; Debugging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enable-debug-logging" class="md-nav__link">
    <span class="md-ellipsis">
      Enable Debug Logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-resolution-confidence" class="md-nav__link">
    <span class="md-ellipsis">
      Check Resolution Confidence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#availability-debugging" class="md-nav__link">
    <span class="md-ellipsis">
      Availability Debugging
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Considerations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-features" class="md-nav__link">
    <span class="md-ellipsis">
      Security Features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#future-enhancements" class="md-nav__link">
    <span class="md-ellipsis">
      Future Enhancements
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Common Issues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debug-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Debug Commands
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-endpoints" class="md-nav__link">
    <span class="md-ellipsis">
      API Endpoints
    </span>
  </a>
  
    <nav class="md-nav" aria-label="API Endpoints">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-availability" class="md-nav__link">
    <span class="md-ellipsis">
      Check Availability
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-booking" class="md-nav__link">
    <span class="md-ellipsis">
      Create Booking
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-booking-options" class="md-nav__link">
    <span class="md-ellipsis">
      Get Booking Options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="universal-multi-tenant-multi-location-booking-system">Universal Multi-Tenant, Multi-Location Booking System<a class="headerlink" href="#universal-multi-tenant-multi-location-booking-system" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>The Universal Booking System is a comprehensive solution for handling appointment bookings across multiple tenants (companies) and their various locations (branches). It intelligently routes customers to the most suitable branch and staff member based on various criteria including location, service requirements, availability, and preferences.</p>
<h2 id="key-features">Key Features<a class="headerlink" href="#key-features" title="Permanent link">&para;</a></h2>
<h3 id="1-intelligent-phone-number-resolution">1. <strong>Intelligent Phone Number Resolution</strong><a class="headerlink" href="#1-intelligent-phone-number-resolution" title="Permanent link">&para;</a></h3>
<ul>
<li>Maps incoming calls to specific branches or companies</li>
<li>Multiple resolution methods with confidence scoring:</li>
<li>Metadata-based (100% confidence)</li>
<li>Phone number mapping (90% confidence)</li>
<li>Agent ID mapping (80% confidence)</li>
<li>Caller history (70% confidence)</li>
<li>Fallback resolution (30% confidence)</li>
</ul>
<h3 id="2-multi-branch-support">2. <strong>Multi-Branch Support</strong><a class="headerlink" href="#2-multi-branch-support" title="Permanent link">&para;</a></h3>
<ul>
<li>Customers can book at any branch offering their required service</li>
<li>Cross-branch availability checking</li>
<li>Mobile staff who work at multiple locations</li>
<li>Branch selection based on various strategies</li>
</ul>
<h3 id="3-smart-staff-matching">3. <strong>Smart Staff Matching</strong><a class="headerlink" href="#3-smart-staff-matching" title="Permanent link">&para;</a></h3>
<ul>
<li>Skill-based matching for services</li>
<li>Language preference support</li>
<li>Experience and rating consideration</li>
<li>Workload balancing</li>
<li>Customer preference memory</li>
</ul>
<h3 id="4-flexible-branch-selection-strategies">4. <strong>Flexible Branch Selection Strategies</strong><a class="headerlink" href="#4-flexible-branch-selection-strategies" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Nearest Location</strong>: Prioritizes geographic proximity</li>
<li><strong>First Available</strong>: Books at branch with earliest slot</li>
<li><strong>Load Balanced</strong>: Distributes bookings evenly</li>
</ul>
<h2 id="architecture-components">Architecture Components<a class="headerlink" href="#architecture-components" title="Permanent link">&para;</a></h2>
<h3 id="core-services">Core Services<a class="headerlink" href="#core-services" title="Permanent link">&para;</a></h3>
<h4 id="universalbookingorchestrator">UniversalBookingOrchestrator<a class="headerlink" href="#universalbookingorchestrator" title="Permanent link">&para;</a></h4>
<p>The main orchestrator that coordinates the entire booking flow:
<div class="highlight"><pre><span></span><code><span class="x">$orchestrator = app(UniversalBookingOrchestrator::class);</span>
<span class="x">$result = $orchestrator-&gt;processBookingRequest($bookingData, $context);</span>
</code></pre></div></p>
<h4 id="phonenumberresolver">PhoneNumberResolver<a class="headerlink" href="#phonenumberresolver" title="Permanent link">&para;</a></h4>
<p>Enhanced resolver for multi-location scenarios:
<div class="highlight"><pre><span></span><code><span class="x">$resolver = app(PhoneNumberResolver::class);</span>
<span class="x">$context = $resolver-&gt;resolveFromWebhook($webhookData);</span>
<span class="x">// Returns: branch_id, company_id, agent_id, resolution_method, confidence</span>
</code></pre></div></p>
<h4 id="staffservicematcher">StaffServiceMatcher<a class="headerlink" href="#staffservicematcher" title="Permanent link">&para;</a></h4>
<p>Intelligent staff selection based on requirements:
<div class="highlight"><pre><span></span><code><span class="x">$matcher = app(StaffServiceMatcher::class);</span>
<span class="x">$eligibleStaff = $matcher-&gt;findEligibleStaff($branch, $serviceRequirements);</span>
</code></pre></div></p>
<h4 id="unifiedavailabilityservice">UnifiedAvailabilityService<a class="headerlink" href="#unifiedavailabilityservice" title="Permanent link">&para;</a></h4>
<p>Aggregates availability across branches and staff:
<div class="highlight"><pre><span></span><code><span class="x">$availability = app(UnifiedAvailabilityService::class);</span>
<span class="x">$slots = $availability-&gt;getMultiBranchAvailability($branches, $requirements, $dateRange);</span>
</code></pre></div></p>
<h3 id="branch-selection-strategies">Branch Selection Strategies<a class="headerlink" href="#branch-selection-strategies" title="Permanent link">&para;</a></h3>
<p>Strategies implement <code>BranchSelectionStrategyInterface</code>:</p>
<div class="highlight"><pre><span></span><code><span class="x">interface BranchSelectionStrategyInterface</span>
<span class="x">{</span>
<span class="x">    public function selectBranches(array $branches, Customer $customer, array $serviceRequirements): array;</span>
<span class="x">    public function getName(): string;</span>
<span class="x">}</span>
</code></pre></div>
<h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link">&para;</a></h2>
<h3 id="environment-variables">Environment Variables<a class="headerlink" href="#environment-variables" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code># Branch Selection Strategy
BOOKING_BRANCH_STRATEGY=nearest  # Options: nearest, first_available, load_balanced

# Time Constraints
BOOKING_MIN_ADVANCE=60          # Minimum advance booking (minutes)
BOOKING_MAX_ADVANCE=90          # Maximum advance booking (days)
BOOKING_DEFAULT_DURATION=30     # Default appointment duration
BOOKING_BUFFER_TIME=15          # Buffer between appointments
BOOKING_SLOT_INTERVAL=15        # Time slot intervals

# Multi-Location
BOOKING_CROSS_BRANCH=true       # Enable cross-branch booking
BOOKING_MAX_DISTANCE=50         # Max distance for suggestions (km)
BOOKING_MOBILE_STAFF=true       # Consider mobile staff

# Customer Preferences
BOOKING_REMEMBER_BRANCH=true    # Remember preferred branch
BOOKING_REMEMBER_STAFF=true     # Remember preferred staff
BOOKING_PREFERENCE_WEIGHT=0.7   # Weight for preferences (0-1)
</code></pre></div>
<h3 id="configuration-file">Configuration File<a class="headerlink" href="#configuration-file" title="Permanent link">&para;</a></h3>
<p>Located at <code>config/booking.php</code>:</p>
<div class="highlight"><pre><span></span><code><span class="x">return [</span>
<span class="x">    &#39;default_branch_strategy&#39; =&gt; env(&#39;BOOKING_BRANCH_STRATEGY&#39;, &#39;nearest&#39;),</span>
<span class="x">    &#39;time_constraints&#39; =&gt; [</span>
<span class="x">        &#39;min_advance_booking&#39; =&gt; 60,</span>
<span class="x">        &#39;max_advance_booking&#39; =&gt; 90,</span>
<span class="x">        &#39;default_duration&#39; =&gt; 30,</span>
<span class="x">        &#39;buffer_time&#39; =&gt; 15,</span>
<span class="x">        &#39;slot_interval&#39; =&gt; 15,</span>
<span class="x">    ],</span>
<span class="x">    &#39;multi_location&#39; =&gt; [</span>
<span class="x">        &#39;enable_cross_branch&#39; =&gt; true,</span>
<span class="x">        &#39;max_distance_km&#39; =&gt; 50,</span>
<span class="x">        &#39;enable_mobile_staff&#39; =&gt; true,</span>
<span class="x">    ],</span>
<span class="x">    // ... more configuration</span>
<span class="x">];</span>
</code></pre></div>
<h2 id="database-schema-enhancements">Database Schema Enhancements<a class="headerlink" href="#database-schema-enhancements" title="Permanent link">&para;</a></h2>
<h3 id="customer-preferences">Customer Preferences<a class="headerlink" href="#customer-preferences" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">customers</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">preferred_branch_id</span><span class="w"> </span><span class="p">(</span><span class="n">UUID</span><span class="p">,</span><span class="w"> </span><span class="k">nullable</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">preferred_staff_id</span><span class="w"> </span><span class="p">(</span><span class="n">UUID</span><span class="p">,</span><span class="w"> </span><span class="k">nullable</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">location_data</span><span class="w"> </span><span class="p">(</span><span class="n">JSON</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">city</span><span class="p">,</span><span class="w"> </span><span class="n">postal_code</span><span class="p">,</span><span class="w"> </span><span class="n">coordinates</span><span class="p">)</span>
</code></pre></div>
<h3 id="staff-capabilities">Staff Capabilities<a class="headerlink" href="#staff-capabilities" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">staff</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">skills</span><span class="w"> </span><span class="p">(</span><span class="n">JSON</span><span class="w"> </span><span class="nb">array</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">languages</span><span class="w"> </span><span class="p">(</span><span class="n">JSON</span><span class="w"> </span><span class="nb">array</span><span class="p">,</span><span class="w"> </span><span class="k">default</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;de&#39;</span><span class="p">])</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">mobility_radius_km</span><span class="w"> </span><span class="p">(</span><span class="nb">integer</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">specializations</span><span class="w"> </span><span class="p">(</span><span class="n">JSON</span><span class="w"> </span><span class="nb">array</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">average_rating</span><span class="w"> </span><span class="p">(</span><span class="nb">decimal</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">certifications</span><span class="w"> </span><span class="p">(</span><span class="n">JSON</span><span class="w"> </span><span class="nb">array</span><span class="p">)</span>
</code></pre></div>
<h3 id="service-requirements">Service Requirements<a class="headerlink" href="#service-requirements" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">services</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">required_skills</span><span class="w"> </span><span class="p">(</span><span class="n">JSON</span><span class="w"> </span><span class="nb">array</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">required_certifications</span><span class="w"> </span><span class="p">(</span><span class="n">JSON</span><span class="w"> </span><span class="nb">array</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">complexity_level</span><span class="w"> </span><span class="p">(</span><span class="n">enum</span><span class="p">:</span><span class="w"> </span><span class="n">basic</span><span class="p">,</span><span class="w"> </span><span class="n">intermediate</span><span class="p">,</span><span class="w"> </span><span class="n">advanced</span><span class="p">,</span><span class="w"> </span><span class="n">expert</span><span class="p">)</span>
</code></pre></div>
<h3 id="branch-features">Branch Features<a class="headerlink" href="#branch-features" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">branches</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">coordinates</span><span class="w"> </span><span class="p">(</span><span class="n">JSON</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">lng</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">service_radius_km</span><span class="w"> </span><span class="p">(</span><span class="nb">integer</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">accepts_walkins</span><span class="w"> </span><span class="p">(</span><span class="nb">boolean</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">parking_available</span><span class="w"> </span><span class="p">(</span><span class="nb">boolean</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">public_transport_access</span><span class="w"> </span><span class="p">(</span><span class="nb">text</span><span class="p">)</span>
</code></pre></div>
<h3 id="multi-branch-staff">Multi-Branch Staff<a class="headerlink" href="#multi-branch-staff" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">staff_branches</span><span class="w"> </span><span class="p">(</span><span class="n">junction</span><span class="w"> </span><span class="k">table</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">staff_id</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">branch_id</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">is_primary</span><span class="w"> </span><span class="p">(</span><span class="nb">boolean</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">working_days</span><span class="w"> </span><span class="p">(</span><span class="n">JSON</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">travel_compensation</span><span class="w"> </span><span class="p">(</span><span class="nb">decimal</span><span class="p">)</span>
</code></pre></div>
<h2 id="usage-examples">Usage Examples<a class="headerlink" href="#usage-examples" title="Permanent link">&para;</a></h2>
<h3 id="basic-booking-request">Basic Booking Request<a class="headerlink" href="#basic-booking-request" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="x">$bookingRequest = [</span>
<span class="x">    &#39;company_id&#39; =&gt; $companyId,</span>
<span class="x">    &#39;service_name&#39; =&gt; &#39;Haircut&#39;,</span>
<span class="x">    &#39;date&#39; =&gt; &#39;2025-06-20&#39;,</span>
<span class="x">    &#39;time&#39; =&gt; &#39;14:00&#39;,</span>
<span class="x">    &#39;customer&#39; =&gt; [</span>
<span class="x">        &#39;name&#39; =&gt; &#39;John Doe&#39;,</span>
<span class="x">        &#39;phone&#39; =&gt; &#39;+49 30 12345678&#39;,</span>
<span class="x">        &#39;email&#39; =&gt; &#39;john@example.com&#39;</span>
<span class="x">    ]</span>
<span class="x">];</span>

<span class="x">$result = $orchestrator-&gt;processBookingRequest($bookingRequest);</span>

<span class="x">if ($result[&#39;success&#39;]) {</span>
<span class="x">    $appointment = $result[&#39;appointment&#39;];</span>
<span class="x">    echo &quot;Booked at {$appointment-&gt;branch-&gt;name} with {$appointment-&gt;staff-&gt;name}&quot;;</span>
<span class="x">}</span>
</code></pre></div>
<h3 id="with-specific-preferences">With Specific Preferences<a class="headerlink" href="#with-specific-preferences" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="x">$bookingRequest = [</span>
<span class="x">    &#39;company_id&#39; =&gt; $companyId,</span>
<span class="x">    &#39;branch_id&#39; =&gt; $preferredBranchId,  // Optional: specific branch</span>
<span class="x">    &#39;service_id&#39; =&gt; $serviceId,</span>
<span class="x">    &#39;date&#39; =&gt; &#39;2025-06-20&#39;,</span>
<span class="x">    &#39;time&#39; =&gt; &#39;14:00&#39;,</span>
<span class="x">    &#39;staff_preference&#39; =&gt; &#39;Maria&#39;,      // Optional: preferred staff name</span>
<span class="x">    &#39;language&#39; =&gt; &#39;en&#39;,                 // Optional: language preference</span>
<span class="x">    &#39;customer&#39; =&gt; [</span>
<span class="x">        &#39;name&#39; =&gt; &#39;John Doe&#39;,</span>
<span class="x">        &#39;phone&#39; =&gt; &#39;+49 30 12345678&#39;</span>
<span class="x">    ]</span>
<span class="x">];</span>
</code></pre></div>
<h3 id="phone-webhook-integration">Phone Webhook Integration<a class="headerlink" href="#phone-webhook-integration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="x">// In RetellWebhookHandler</span>
<span class="x">$phoneResolver = app(PhoneNumberResolver::class);</span>
<span class="x">$context = $phoneResolver-&gt;resolveFromWebhook($webhookData);</span>

<span class="x">$bookingRequest = [</span>
<span class="x">    &#39;company_id&#39; =&gt; $context[&#39;company_id&#39;],</span>
<span class="x">    &#39;branch_id&#39; =&gt; $context[&#39;branch_id&#39;],</span>
<span class="x">    // ... rest of booking data from webhook</span>
<span class="x">];</span>

<span class="x">$result = $orchestrator-&gt;processBookingRequest($bookingRequest, $context);</span>
</code></pre></div>
<h2 id="flow-diagram">Flow Diagram<a class="headerlink" href="#flow-diagram" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>Phone Call  Retell.ai
    
Webhook  PhoneNumberResolver
    
Resolve Company/Branch Context
    
UniversalBookingOrchestrator
     Find/Create Customer
     Analyze Service Requirements
     Select Suitable Branches (Strategy)
     Find Eligible Staff (Matcher)
     Check Availability (Unified Service)
     Score &amp; Select Optimal Option
     Create Appointment
     Sync with Cal.com
     Send Notifications
</code></pre></div>
<h2 id="advanced-features">Advanced Features<a class="headerlink" href="#advanced-features" title="Permanent link">&para;</a></h2>
<h3 id="custom-branch-selection-strategy">Custom Branch Selection Strategy<a class="headerlink" href="#custom-branch-selection-strategy" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="x">class PreferredPartnerStrategy implements BranchSelectionStrategyInterface</span>
<span class="x">{</span>
<span class="x">    public function selectBranches(array $branches, Customer $customer, array $serviceRequirements): array</span>
<span class="x">    {</span>
<span class="x">        // Custom logic to prioritize partner branches</span>
<span class="x">        return array_filter($branches, function($branch) {</span>
<span class="x">            return $branch-&gt;metadata[&#39;is_partner&#39;] ?? false;</span>
<span class="x">        });</span>
<span class="x">    }</span>

<span class="x">    public function getName(): string</span>
<span class="x">    {</span>
<span class="x">        return &#39;preferred_partner&#39;;</span>
<span class="x">    }</span>
<span class="x">}</span>

<span class="x">// Register in service provider</span>
<span class="x">$orchestrator-&gt;setBranchSelectionStrategy(new PreferredPartnerStrategy());</span>
</code></pre></div>
<h3 id="staff-skill-matching">Staff Skill Matching<a class="headerlink" href="#staff-skill-matching" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="x">// Define service with requirements</span>
<span class="x">$service-&gt;update([</span>
<span class="x">    &#39;required_skills&#39; =&gt; [&#39;color_specialist&#39;, &#39;senior_stylist&#39;],</span>
<span class="x">    &#39;complexity_level&#39; =&gt; &#39;advanced&#39;</span>
<span class="x">]);</span>

<span class="x">// Staff with matching skills</span>
<span class="x">$staff-&gt;update([</span>
<span class="x">    &#39;skills&#39; =&gt; [&#39;color_specialist&#39;, &#39;senior_stylist&#39;, &#39;makeup_artist&#39;],</span>
<span class="x">    &#39;certifications&#39; =&gt; [&#39;Wella Color Expert&#39;, &#39;L\&#39;Oreal Professional&#39;]</span>
<span class="x">]);</span>

<span class="x">// The system automatically matches staff to service requirements</span>
</code></pre></div>
<h3 id="multi-language-support">Multi-Language Support<a class="headerlink" href="#multi-language-support" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="x">// Customer speaks Turkish</span>
<span class="x">$bookingRequest[&#39;language&#39;] = &#39;tr&#39;;</span>

<span class="x">// System finds staff who speak Turkish</span>
<span class="x">$staff-&gt;languages = [&#39;de&#39;, &#39;en&#39;, &#39;tr&#39;];  // Will be preferred</span>
</code></pre></div>
<h2 id="monitoring-debugging">Monitoring &amp; Debugging<a class="headerlink" href="#monitoring-debugging" title="Permanent link">&para;</a></h2>
<h3 id="enable-debug-logging">Enable Debug Logging<a class="headerlink" href="#enable-debug-logging" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>BOOKING_DEBUG=true
BOOKING_LOG_AVAILABILITY=true
BOOKING_LOG_BRANCHES=true
</code></pre></div>
<h3 id="check-resolution-confidence">Check Resolution Confidence<a class="headerlink" href="#check-resolution-confidence" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="x">Log::info(&#39;Phone resolution&#39;, [</span>
<span class="x">    &#39;method&#39; =&gt; $context[&#39;resolution_method&#39;],</span>
<span class="x">    &#39;confidence&#39; =&gt; $context[&#39;confidence&#39;],</span>
<span class="x">    &#39;branch_id&#39; =&gt; $context[&#39;branch_id&#39;]</span>
<span class="x">]);</span>
</code></pre></div>
<h3 id="availability-debugging">Availability Debugging<a class="headerlink" href="#availability-debugging" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="x">$availabilityService-&gt;clearStaffAvailabilityCache($staff);</span>
<span class="x">$slots = $availabilityService-&gt;getStaffAvailability($staff, $dateRange, 30);</span>
<span class="x">Log::info(&#39;Available slots&#39;, [&#39;count&#39; =&gt; count($slots), &#39;slots&#39; =&gt; $slots]);</span>
</code></pre></div>
<h2 id="performance-considerations">Performance Considerations<a class="headerlink" href="#performance-considerations" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Caching</strong>: Availability data is cached for 5 minutes by default</li>
<li><strong>Eager Loading</strong>: Relationships are loaded to prevent N+1 queries</li>
<li><strong>Async Processing</strong>: Webhooks are processed asynchronously</li>
<li><strong>Connection Pooling</strong>: Database connections are pooled</li>
<li><strong>Rate Limiting</strong>: API endpoints have adaptive rate limiting</li>
</ol>
<h2 id="security-features">Security Features<a class="headerlink" href="#security-features" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Webhook Signature Verification</strong>: All webhooks are verified</li>
<li><strong>Multi-Tenancy Isolation</strong>: Data is automatically scoped by company</li>
<li><strong>Input Validation</strong>: Phone numbers and other inputs are validated</li>
<li><strong>SQL Injection Prevention</strong>: Using parameterized queries</li>
<li><strong>API Rate Limiting</strong>: Prevents abuse and DDoS</li>
</ol>
<h2 id="future-enhancements">Future Enhancements<a class="headerlink" href="#future-enhancements" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>AI-Powered Predictions</strong>: Predict no-shows and optimize overbooking</li>
<li><strong>Dynamic Pricing</strong>: Adjust prices based on demand and time</li>
<li><strong>Route Optimization</strong>: For mobile service providers</li>
<li><strong>Customer Scoring</strong>: Prioritize reliable customers</li>
<li><strong>Automated Rescheduling</strong>: Handle cancellations intelligently</li>
<li><strong>Multi-Provider Marketplace</strong>: Book across different companies</li>
</ol>
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">&para;</a></h2>
<h3 id="common-issues">Common Issues<a class="headerlink" href="#common-issues" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>"Could not resolve company"</strong></li>
<li>Check phone number mapping in <code>phone_numbers</code> table</li>
<li>Verify branch <code>phone_number</code> field</li>
<li>
<p>Check if branch is active</p>
</li>
<li>
<p><strong>"No eligible staff found"</strong></p>
</li>
<li>Verify staff is active and assigned to branch</li>
<li>Check service assignments in <code>staff_event_types</code></li>
<li>
<p>Verify skill requirements match</p>
</li>
<li>
<p><strong>"No available slots"</strong></p>
</li>
<li>Check staff working hours</li>
<li>Verify Cal.com integration</li>
<li>Clear availability cache</li>
</ol>
<h3 id="debug-commands">Debug Commands<a class="headerlink" href="#debug-commands" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Test phone resolution</span>
php<span class="w"> </span>artisan<span class="w"> </span>askproai:test-phone-resolution<span class="w"> </span>+49<span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">12345678</span>

<span class="c1"># Check branch availability</span>
php<span class="w"> </span>artisan<span class="w"> </span>askproai:check-availability<span class="w"> </span>--branch<span class="o">=</span>UUID<span class="w"> </span>--date<span class="o">=</span><span class="m">2025</span>-06-20

<span class="c1"># Sync staff capabilities</span>
php<span class="w"> </span>artisan<span class="w"> </span>askproai:sync-staff-capabilities

<span class="c1"># Clear booking caches</span>
php<span class="w"> </span>artisan<span class="w"> </span>booking:clear-cache
</code></pre></div>
<h2 id="api-endpoints">API Endpoints<a class="headerlink" href="#api-endpoints" title="Permanent link">&para;</a></h2>
<h3 id="check-availability">Check Availability<a class="headerlink" href="#check-availability" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">POST /api/booking/check-availability</span>
<span class="err">{</span>
<span class="err">    &quot;company_id&quot;: &quot;uuid&quot;,</span>
<span class="err">    &quot;service_id&quot;: &quot;uuid&quot;,</span>
<span class="err">    &quot;date&quot;: &quot;2025-06-20&quot;,</span>
<span class="err">    &quot;branch_id&quot;: &quot;uuid&quot; (optional)</span>
<span class="err">}</span>
</code></pre></div>
<h3 id="create-booking">Create Booking<a class="headerlink" href="#create-booking" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">POST /api/booking/create</span>
<span class="err">{</span>
<span class="err">    &quot;company_id&quot;: &quot;uuid&quot;,</span>
<span class="err">    &quot;service_id&quot;: &quot;uuid&quot;,</span>
<span class="err">    &quot;date&quot;: &quot;2025-06-20&quot;,</span>
<span class="err">    &quot;time&quot;: &quot;14:00&quot;,</span>
<span class="err">    &quot;customer&quot;: {</span>
<span class="err">        &quot;name&quot;: &quot;John Doe&quot;,</span>
<span class="err">        &quot;phone&quot;: &quot;+49 30 12345678&quot;,</span>
<span class="err">        &quot;email&quot;: &quot;john@example.com&quot;</span>
<span class="err">    },</span>
<span class="err">    &quot;preferences&quot;: {</span>
<span class="err">        &quot;branch_id&quot;: &quot;uuid&quot;,</span>
<span class="err">        &quot;staff_name&quot;: &quot;Maria&quot;,</span>
<span class="err">        &quot;language&quot;: &quot;en&quot;</span>
<span class="err">    }</span>
<span class="err">}</span>
</code></pre></div>
<h3 id="get-booking-options">Get Booking Options<a class="headerlink" href="#get-booking-options" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="err">POST /api/booking/options</span>
<span class="err">{</span>
<span class="err">    &quot;company_id&quot;: &quot;uuid&quot;,</span>
<span class="err">    &quot;service_id&quot;: &quot;uuid&quot;,</span>
<span class="err">    &quot;date_range&quot;: {</span>
<span class="err">        &quot;start&quot;: &quot;2025-06-20&quot;,</span>
<span class="err">        &quot;end&quot;: &quot;2025-06-27&quot;</span>
<span class="err">    },</span>
<span class="err">    &quot;location&quot;: {</span>
<span class="err">        &quot;postal_code&quot;: &quot;10115&quot;,</span>
<span class="err">        &quot;city&quot;: &quot;Berlin&quot;</span>
<span class="err">    }</span>
<span class="err">}</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "search.suggest", "search.highlight", "content.code.copy"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>