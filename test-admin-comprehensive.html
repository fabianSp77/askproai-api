<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Admin Panel Comprehensive Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { 
            border: 1px solid #ddd; 
            padding: 15px; 
            margin: 10px 0;
            background: #f9f9f9;
        }
        .success { color: #059669; font-weight: bold; }
        .error { color: #dc2626; font-weight: bold; }
        .warning { color: #d97706; font-weight: bold; }
        iframe { border: 2px solid #333; }
        pre { background: #1a1a1a; color: #00ff00; padding: 10px; overflow: auto; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>üö® Admin Panel Comprehensive Test - Issue #506</h1>
    
    <div class="test-section">
        <h2>1. Live Admin Panel</h2>
        <iframe id="adminFrame" src="/admin" width="100%" height="600"></iframe>
    </div>
    
    <div class="test-section">
        <h2>2. JavaScript Fix Status</h2>
        <div id="jsStatus">Checking...</div>
        <button onclick="checkJSFix()">Re-check JS Fix</button>
    </div>
    
    <div class="test-section">
        <h2>3. Clickability Analysis</h2>
        <div id="clickAnalysis">Analyzing...</div>
        <button onclick="analyzeClickability()">Analyze Links</button>
    </div>
    
    <div class="test-section">
        <h2>4. Console Output</h2>
        <pre id="consoleOutput">Waiting for console messages...</pre>
        <button onclick="clearConsole()">Clear Console</button>
    </div>
    
    <div class="test-section">
        <h2>5. Manual Tests</h2>
        <ol>
            <li>Can you click sidebar navigation links? <span id="test1">‚ùì</span></li>
            <li>Is content visible without being cut off? <span id="test2">‚ùì</span></li>
            <li>Can you scroll in the sidebar? <span id="test3">‚ùì</span></li>
            <li>Do you see a red "NUCLEAR FIX ACTIVE" banner? <span id="test4">‚ùì</span></li>
            <li>Do you see a red debug box in bottom-right? <span id="test5">‚ùì</span></li>
        </ol>
        <button onclick="markTest(1, true)">‚úÖ Test 1</button>
        <button onclick="markTest(1, false)">‚ùå Test 1</button>
        <button onclick="markTest(2, true)">‚úÖ Test 2</button>
        <button onclick="markTest(2, false)">‚ùå Test 2</button>
        <button onclick="markTest(3, true)">‚úÖ Test 3</button>
        <button onclick="markTest(3, false)">‚ùå Test 3</button>
        <button onclick="markTest(4, true)">‚úÖ Test 4</button>
        <button onclick="markTest(4, false)">‚ùå Test 4</button>
        <button onclick="markTest(5, true)">‚úÖ Test 5</button>
        <button onclick="markTest(5, false)">‚ùå Test 5</button>
    </div>
    
    <script>
        const iframe = document.getElementById('adminFrame');
        const consoleOutput = document.getElementById('consoleOutput');
        let consoleLogs = [];
        
        function addConsoleLog(msg) {
            const time = new Date().toLocaleTimeString();
            consoleLogs.push(`[${time}] ${msg}`);
            if (consoleLogs.length > 20) consoleLogs.shift();
            consoleOutput.textContent = consoleLogs.join('\n');
        }
        
        function clearConsole() {
            consoleLogs = [];
            consoleOutput.textContent = 'Console cleared.';
        }
        
        function checkJSFix() {
            try {
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                const debugDiv = iframeDoc.getElementById('admin-fix-debug');
                const status = document.getElementById('jsStatus');
                
                if (debugDiv) {
                    status.innerHTML = '<span class="success">‚úÖ JavaScript Fix is ACTIVE!</span><br>' + 
                                     'Debug info: ' + debugDiv.textContent;
                    addConsoleLog('JS Fix confirmed active');
                } else {
                    status.innerHTML = '<span class="error">‚ùå JavaScript Fix NOT detected!</span>';
                    addConsoleLog('JS Fix not found');
                }
                
                // Check for console errors
                if (iframe.contentWindow.console) {
                    // Try to capture console logs
                    const originalLog = iframe.contentWindow.console.log;
                    const originalError = iframe.contentWindow.console.error;
                    
                    iframe.contentWindow.console.log = function(...args) {
                        addConsoleLog('LOG: ' + args.join(' '));
                        originalLog.apply(this, args);
                    };
                    
                    iframe.contentWindow.console.error = function(...args) {
                        addConsoleLog('ERROR: ' + args.join(' '));
                        originalError.apply(this, args);
                    };
                }
            } catch (e) {
                document.getElementById('jsStatus').innerHTML = 
                    '<span class="error">‚ùå Error: ' + e.message + '</span>';
            }
        }
        
        function analyzeClickability() {
            try {
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                const analysis = document.getElementById('clickAnalysis');
                
                // Find all sidebar links
                const sidebarLinks = iframeDoc.querySelectorAll('.fi-sidebar a, .fi-sidebar-nav-item a');
                let html = '<h3>Sidebar Links Analysis:</h3><ul>';
                
                sidebarLinks.forEach((link, i) => {
                    const style = iframe.contentWindow.getComputedStyle(link);
                    const rect = link.getBoundingClientRect();
                    const isClickable = style.pointerEvents !== 'none';
                    
                    html += `<li>
                        ${isClickable ? '‚úÖ' : '‚ùå'} Link ${i+1}: "${link.textContent.trim()}"<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;pointer-events: ${style.pointerEvents}<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;z-index: ${style.zIndex}<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;position: ${rect.width}x${rect.height} at (${rect.left}, ${rect.top})
                    </li>`;
                });
                
                html += '</ul>';
                
                // Check main content
                const mainContent = iframeDoc.querySelector('.fi-main');
                if (mainContent) {
                    const mainStyle = iframe.contentWindow.getComputedStyle(mainContent);
                    html += '<h3>Main Content:</h3>';
                    html += `<ul>
                        <li>Width: ${mainContent.offsetWidth}px</li>
                        <li>Overflow-x: ${mainStyle.overflowX}</li>
                        <li>Padding: ${mainStyle.padding}</li>
                    </ul>`;
                }
                
                analysis.innerHTML = html;
                addConsoleLog('Clickability analysis completed');
            } catch (e) {
                document.getElementById('clickAnalysis').innerHTML = 
                    '<span class="error">Error: ' + e.message + '</span>';
            }
        }
        
        function markTest(num, passed) {
            const span = document.getElementById('test' + num);
            span.textContent = passed ? '‚úÖ' : '‚ùå';
            addConsoleLog(`Test ${num}: ${passed ? 'PASSED' : 'FAILED'}`);
        }
        
        // Auto-check when iframe loads
        iframe.onload = function() {
            addConsoleLog('Admin panel loaded');
            setTimeout(() => {
                checkJSFix();
                analyzeClickability();
            }, 2000);
        };
        
        // Initial message
        addConsoleLog('Test page loaded. Waiting for admin panel...');
    </script>
</body>
</html>