<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin CSS Debug</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .status { font-weight: bold; }
        .success { color: green; }
        .error { color: red; }
        .warning { color: orange; }
        code {
            background: #f5f5f5;
            padding: 2px 6px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <h1>Admin Portal CSS Debug</h1>
    
    <div class="test-section">
        <h2>1. CSS File Loading Test</h2>
        <div id="css-test"></div>
    </div>
    
    <div class="test-section">
        <h2>2. JavaScript Console Errors</h2>
        <div id="js-errors"></div>
    </div>
    
    <div class="test-section">
        <h2>3. Filament Components Test</h2>
        <div id="filament-test"></div>
    </div>
    
    <div class="test-section">
        <h2>4. Network Resources</h2>
        <div id="network-test"></div>
    </div>

    <script>
        // Test CSS loading
        async function testCSS() {
            const cssFiles = [
                '/css/filament/filament/app.css',
                '/css/filament-hotfix.css',
                '/css/filament-hotfix-override.css',
                '/css/filament/forms/forms.css',
                '/css/filament/support/support.css'
            ];
            
            let results = '<h3>CSS Files:</h3><ul>';
            
            for (const file of cssFiles) {
                try {
                    const response = await fetch('https://api.askproai.de' + file);
                    const status = response.ok ? 'success' : 'error';
                    results += `<li><span class="status ${status}">${response.status}</span> - <code>${file}</code></li>`;
                } catch (e) {
                    results += `<li><span class="status error">Failed</span> - <code>${file}</code> - ${e.message}</li>`;
                }
            }
            
            results += '</ul>';
            document.getElementById('css-test').innerHTML = results;
        }
        
        // Check JavaScript errors
        function checkJSErrors() {
            let errors = '<h3>Console Errors:</h3>';
            
            // Create iframe to load admin page
            const iframe = document.createElement('iframe');
            iframe.style.width = '100%';
            iframe.style.height = '400px';
            iframe.style.border = '1px solid #ccc';
            iframe.src = '/admin/';
            
            document.getElementById('js-errors').innerHTML = errors + '<p>Loading admin page in iframe...</p>';
            document.getElementById('js-errors').appendChild(iframe);
        }
        
        // Test Filament components
        async function testFilament() {
            let results = '<h3>Filament Check:</h3><ul>';
            
            // Check for common issues
            const checks = [
                { name: 'Livewire JS', url: '/livewire/livewire.js' },
                { name: 'Alpine JS', url: '/js/app.js' },
                { name: 'Filament Forms', url: '/js/filament/forms/components/select.js' }
            ];
            
            for (const check of checks) {
                try {
                    const response = await fetch(check.url);
                    const status = response.ok ? 'success' : 'error';
                    results += `<li><span class="status ${status}">${check.name}</span> - ${response.status}</li>`;
                } catch (e) {
                    results += `<li><span class="status error">${check.name}</span> - Failed: ${e.message}</li>`;
                }
            }
            
            results += '</ul>';
            document.getElementById('filament-test').innerHTML = results;
        }
        
        // Check network resources
        async function checkNetwork() {
            let results = '<h3>Key Resources:</h3>';
            
            // Test main admin endpoint
            try {
                const adminResponse = await fetch('/admin/', {
                    credentials: 'include'
                });
                
                results += `<p>Admin Page: <span class="status ${adminResponse.ok ? 'success' : 'warning'}">${adminResponse.status} ${adminResponse.statusText}</span></p>`;
                
                if (adminResponse.ok) {
                    const text = await adminResponse.text();
                    const hasContent = text.includes('filament');
                    results += `<p>Contains Filament: <span class="status ${hasContent ? 'success' : 'error'}">${hasContent}</span></p>`;
                    
                    // Check for common issues
                    if (text.includes('<!DOCTYPE html>')) {
                        results += '<p class="success">✓ HTML structure found</p>';
                    }
                    if (text.includes('x-data')) {
                        results += '<p class="success">✓ Alpine.js directives found</p>';
                    }
                    if (text.includes('wire:')) {
                        results += '<p class="success">✓ Livewire directives found</p>';
                    }
                }
            } catch (e) {
                results += `<p class="error">Admin page error: ${e.message}</p>`;
            }
            
            document.getElementById('network-test').innerHTML = results;
        }
        
        // Run all tests
        testCSS();
        checkJSErrors();
        testFilament();
        checkNetwork();
    </script>
</body>
</html>