/* ================================================================
   FIX FOR ISSUE #448, #450, #451 - Black Screen & Large Icons
   Created: 2025-07-30
   Updated: 2025-07-30
   
   This file fixes:
   1. Black overlay covering the middle of the screen
   2. Icons that are too large
   3. Dynamic styling issues with Alpine.js and Livewire
   
   IMPORTANT: This CSS has highest priority to override all other styles
   ================================================================ */

/* ================================================================
   1. REMOVE BLACK OVERLAY COMPLETELY
   ================================================================ */

/* Remove ALL overlay effects that might create black screen */
.fi-sidebar-open::before,
body.fi-sidebar-open::before,
.fi-main-ctn::before,
.fi-main-ctn::after,
.fi-layout::before,
.fi-layout::after,
body::before,
body::after {
    display: none !important;
    content: none !important;
    background: none !important;
    opacity: 0 !important;
    visibility: hidden !important;
    pointer-events: none !important;
}

/* Ensure main content area has proper background */
.fi-main-ctn {
    background-color: rgb(249 250 251) !important; /* Light gray */
    opacity: 1 !important;
    visibility: visible !important;
    position: relative !important;
    z-index: 1 !important;
}

/* Dark mode background */
.dark .fi-main-ctn {
    background-color: rgb(17 24 39) !important;
}

/* Ensure body has no black background */
body {
    background-color: rgb(249 250 251) !important;
    overflow: visible !important;
}

.dark body {
    background-color: rgb(17 24 39) !important;
}

/* ================================================================
   2. FIX ICON SIZES - Make them reasonable
   ================================================================ */

/* Standard icon size for ALL icons (20px) */
.fi-icon svg,
.fi-ta-icon svg,
.fi-sidebar-item-icon svg,
.fi-dropdown-list-item-icon svg,
.fi-notification-icon svg,
.fi-wi-icon svg {
    width: 1.25rem !important;
    height: 1.25rem !important;
    max-width: 1.25rem !important;
    max-height: 1.25rem !important;
}

/* Modal and empty state icons should be larger but not huge (32px instead of 48px) */
.fi-empty-state-icon svg,
.fi-modal-icon svg,
.fi-section-header-icon svg {
    width: 2rem !important;
    height: 2rem !important;
    max-width: 2rem !important;
    max-height: 2rem !important;
}

/* Icon buttons maintain clickable area but icon stays small */
.fi-icon-btn {
    min-width: 2.5rem !important;
    min-height: 2.5rem !important;
    padding: 0.5rem !important;
}

.fi-icon-btn svg {
    width: 1.25rem !important;
    height: 1.25rem !important;
    max-width: 1.25rem !important;
    max-height: 1.25rem !important;
}

/* Badge icons are smallest (14px) */
.fi-badge svg {
    width: 0.875rem !important;
    height: 0.875rem !important;
    max-width: 0.875rem !important;
    max-height: 0.875rem !important;
}

/* Widget stat icons slightly larger (24px) */
.fi-wi-stats-overview-stat-icon svg {
    width: 1.5rem !important;
    height: 1.5rem !important;
    max-width: 1.5rem !important;
    max-height: 1.5rem !important;
}

/* ================================================================
   3. ENSURE PROPER LAYOUT STRUCTURE
   ================================================================ */

/* Main layout should use flexbox properly */
.fi-layout {
    display: flex !important;
    flex-direction: row !important;
    min-height: 100vh !important;
    background: transparent !important;
}

/* Sidebar on desktop */
@media (min-width: 1024px) {
    .fi-sidebar {
        position: sticky !important;
        top: 0 !important;
        left: 0 !important;
        width: var(--sidebar-width, 16rem) !important;
        height: 100vh !important;
        background: white !important;
        opacity: 1 !important;
        visibility: visible !important;
        z-index: 30 !important;
    }
    
    .dark .fi-sidebar {
        background: rgb(31 41 55) !important;
    }
    
    .fi-main-ctn {
        flex: 1 !important;
        margin-left: 0 !important;
        width: calc(100% - var(--sidebar-width, 16rem)) !important;
    }
}

/* Mobile sidebar without overlay */
@media (max-width: 1023px) {
    .fi-sidebar {
        position: fixed !important;
        top: 0 !important;
        left: -100% !important;
        width: 80% !important;
        max-width: 320px !important;
        height: 100vh !important;
        background: white !important;
        z-index: 50 !important;
        transition: left 0.3s ease-out !important;
    }
    
    .dark .fi-sidebar {
        background: rgb(31 41 55) !important;
    }
    
    .fi-sidebar-open .fi-sidebar {
        left: 0 !important;
    }
    
    /* Main content full width on mobile */
    .fi-main-ctn {
        width: 100% !important;
        margin-left: 0 !important;
    }
}

/* ================================================================
   4. ENSURE CONTENT IS VISIBLE
   ================================================================ */

/* All content should be visible */
* {
    visibility: visible !important;
}

/* Remove any filters or transforms that might hide content */
.fi-main-ctn *,
.fi-page *,
.fi-simple-page * {
    filter: none !important;
}

/* Ensure interactive elements work */
button,
a,
input,
select,
textarea,
.fi-btn,
.fi-link,
[role="button"] {
    pointer-events: auto !important;
    cursor: pointer !important;
}

/* Page content should have white background */
.fi-page {
    background-color: white !important;
    min-height: calc(100vh - 4rem) !important;
    padding: 1.5rem !important;
    margin: 1rem !important;
    border-radius: 0.5rem !important;
}

.dark .fi-page {
    background-color: rgb(31 41 55) !important;
}

/* ================================================================
   5. AGGRESSIVE FIXES FOR PERSISTENT ISSUES
   ================================================================ */

/* Force remove any overlays with high specificity */
html body.fi-sidebar-open::before,
html body.fi-sidebar-open::after,
html .fi-sidebar-open::before,
html .fi-sidebar-open::after {
    display: none !important;
    content: none !important;
    width: 0 !important;
    height: 0 !important;
    position: static !important;
}

/* Ensure no element can create a full-screen overlay */
*[style*="position: fixed"] {
    z-index: auto !important;
}

/* Exception for legitimate fixed elements */
.fi-sidebar,
.fi-topbar,
.fi-notification,
.fi-modal {
    z-index: 40 !important;
}

/* Force all icons to reasonable sizes with high specificity */
html body .fi-icon svg,
html body .fi-ta-icon svg,
html body .heroicon,
html body [class*="heroicon-"],
html body .fi-sidebar-item-icon svg,
html body .fi-dropdown-list-item-icon svg {
    width: 1.25rem !important;
    height: 1.25rem !important;
    min-width: 1.25rem !important;
    min-height: 1.25rem !important;
    max-width: 1.25rem !important;
    max-height: 1.25rem !important;
}

/* Specific overrides for known large icons */
html body .fi-empty-state-icon svg,
html body .fi-modal-icon svg,
html body .fi-section-header-icon svg {
    width: 2rem !important;
    height: 2rem !important;
    min-width: 2rem !important;
    min-height: 2rem !important;
    max-width: 2rem !important;
    max-height: 2rem !important;
}

/* Remove any transform or scale on icons */
.fi-icon svg,
.fi-ta-icon svg,
.heroicon,
[class*="heroicon-"] {
    transform: none !important;
    scale: 1 !important;
}

/* ================================================================
   6. TIMING FIXES FOR ALPINE/LIVEWIRE
   ================================================================ */

/* Prevent flash of unstyled content */
[x-cloak] {
    display: none !important;
}

/* Ensure Alpine components don't create overlays */
[x-data] {
    position: relative !important;
}

/* Fix for Livewire navigation issues */
[wire\:navigate] {
    pointer-events: auto !important;
}