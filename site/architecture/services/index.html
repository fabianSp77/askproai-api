
<!doctype html>
<html lang="de" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Comprehensive documentation for the AskProAI AI-powered appointment booking platform">
      
      
      
        <link rel="canonical" href="https://docs.askproai.de/architecture/services/">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Service Layer Documentation - AskProAI Complete Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-XXXXXXXXXX"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-XXXXXXXXXX",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#service-layer-documentation" class="md-skip">
          Zum Inhalt
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Kopfzeile">
    <a href="../.." title="AskProAI Complete Documentation" class="md-header__button md-logo" aria-label="AskProAI Complete Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 12h2a5 5 0 0 0-5-5v2a3 3 0 0 1 3 3m4 0h2c0-5-4.03-9-9-9v2c3.86 0 7 3.13 7 7m1 3.5c-1.25 0-2.45-.2-3.57-.57-.35-.11-.74-.03-1.02.25l-2.2 2.2a15.1 15.1 0 0 1-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02A11.4 11.4 0 0 1 8.5 4a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1 17 17 0 0 0 17 17 1 1 0 0 0 1-1v-3.5a1 1 0 0 0-1-1"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AskProAI Complete Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Service Layer Documentation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="purple"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Suche" placeholder="Suche" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Suche">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Teilen" aria-label="Teilen" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Zurücksetzen" aria-label="Zurücksetzen" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Suche wird initialisiert
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/askproai/api-gateway" title="Zum Repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    askproai/api-gateway
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Hauptnavigation" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../overview/" class="md-tabs__link">
          
  
  
  Architecture

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../features/phone-system/" class="md-tabs__link">
          
  
  
  Core Features

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../integrations/overview/" class="md-tabs__link">
          
  
  
  Integrations

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api/complete-endpoint-reference/" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../configuration/environment.md" class="md-tabs__link">
          
  
  
  Configuration

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../deployment/requirements.md" class="md-tabs__link">
          
  
  
  Deployment

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../development/setup.md" class="md-tabs__link">
          
  
  
  Development

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../operations/monitoring.md" class="md-tabs__link">
          
  
  
  Operations

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../migration/complete-migration-history/" class="md-tabs__link">
          
  
  
  Migration Guides

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="AskProAI Complete Documentation" class="md-nav__button md-logo" aria-label="AskProAI Complete Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 12h2a5 5 0 0 0-5-5v2a3 3 0 0 1 3 3m4 0h2c0-5-4.03-9-9-9v2c3.86 0 7 3.13 7 7m1 3.5c-1.25 0-2.45-.2-3.57-.57-.35-.11-.74-.03-1.02.25l-2.2 2.2a15.1 15.1 0 0 1-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02A11.4 11.4 0 0 1 8.5 4a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1 17 17 0 0 0 17 17 1 1 0 0 0 1-1v-3.5a1 1 0 0 0-1-1"/></svg>

    </a>
    AskProAI Complete Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/askproai/api-gateway" title="Zum Repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    askproai/api-gateway
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../.." class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../overview/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../features/phone-system/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Core Features
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../integrations/overview/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Integrations
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../api/complete-endpoint-reference/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../configuration/environment.md" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../deployment/requirements.md" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Deployment
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../development/setup.md" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../operations/monitoring.md" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Operations
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../migration/complete-migration-history/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Migration Guides
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="service-layer-documentation">Service Layer Documentation<a class="headerlink" href="#service-layer-documentation" title="Permanent link">&para;</a></h1>
<p>Generated on: 2025-06-23 16:14:16</p>
<h2 id="service-architecture">Service Architecture<a class="headerlink" href="#service-architecture" title="Permanent link">&para;</a></h2>
<div class="admonition info">
<p class="admonition-title">Service Count</p>
<p>Found <strong>69 services</strong> in the codebase.</p>
</div>
<h2 id="integration-services">Integration Services<a class="headerlink" href="#integration-services" title="Permanent link">&para;</a></h2>
<h3 id="calcomeventsyncservice">CalcomEventSyncService<a class="headerlink" href="#calcomeventsyncservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>syncAllEventTypes()</code></li>
</ul>
<p>Synchronisiert alle Event-Types aus Cal.com
- <code>linkStaffToEventTypes()</code></p>
<p>Verknüpft Mitarbeiter mit Event-Types basierend auf Cal.com Daten</p>
<hr />
<h3 id="calcomeventtypeimportservice">CalcomEventTypeImportService<a class="headerlink" href="#calcomeventtypeimportservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>importEventTypes(): array</code></li>
<li><code>getEventTypeById($eventTypeId): ?array</code></li>
</ul>
<hr />
<h3 id="calcomeventtypesyncservice">CalcomEventTypeSyncService<a class="headerlink" href="#calcomeventtypesyncservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>validateApiKey($apiKey): array</code></li>
<li><code>fetchEventTypes($apiKey, $useCache = false): array</code></li>
<li><code>checkWebhookStatus($eventTypeId, $apiKey): bool</code></li>
<li><code>clearCache($apiKey): void</code></li>
<li><code>debugApiCall($apiKey): array</code></li>
</ul>
<hr />
<h3 id="calcomimportservice">CalcomImportService<a class="headerlink" href="#calcomimportservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>importEventTypes()</code></li>
<li><code>resolveDuplicate($eventTypeId, $action = "keep_local")</code></li>
</ul>
<hr />
<h3 id="calcommigrationservice">CalcomMigrationService<a class="headerlink" href="#calcommigrationservice" title="Permanent link">&para;</a></h3>
<p>Service to handle gradual migration from Cal.com V1 to V2 API
This service provides a unified interface that can switch between
V1 and V2 implementations based on configuration or feature flags.</p>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>getEventTypes(?string $teamSlug = null)</code></li>
</ul>
<p>Get event types with migration support
- <code>getAvailableSlots(int $eventTypeId, string $startDate, string $endDate, string $timezone = "Europe\/Berlin")</code></p>
<p>Get available slots with migration support
- <code>bookAppointment(int $eventTypeId, string $startTime, ?string $endTime = null, array $customerData = [], ?string $notes = null, array $metadata = [])</code></p>
<p>Create booking with migration support
- <code>cancelBooking(string $bookingId, ?string $reason = null)</code></p>
<p>Cancel booking with migration support
- <code>getBooking(string $bookingId)</code></p>
<p>Get booking by ID with migration support
- <code>enableV2ForMethod(string $method, int $ttl = 3600): void</code></p>
<p>Enable V2 for specific method (for gradual rollout)
- <code>disableV2ForMethod(string $method): void</code></p>
<p>Disable V2 for specific method (for rollback)
- <code>getMigrationStatus(): array</code></p>
<p>Get migration status</p>
<hr />
<h3 id="calcomservice">CalcomService<a class="headerlink" href="#calcomservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>setApiKey(string $apiKey): self</code></li>
</ul>
<p>Set API key (for dynamic configuration)
- <code>checkAvailability($eventTypeId, $dateFrom, $dateTo)</code>
- <code>bookAppointment($eventTypeId, $startTime, $endTime, $customerData, $notes = null)</code>
- <code>getEventTypes($companyId = null)</code></p>
<hr />
<h3 id="calcomservicev1legacy">CalcomServiceV1Legacy<a class="headerlink" href="#calcomservicev1legacy" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>checkAvailability($eventTypeId, $dateFrom, $dateTo)</code></li>
<li><code>bookAppointment($eventTypeId, $startTime, $endTime, $customerData, $notes = null)</code></li>
<li><code>getEventTypes()</code></li>
<li><code>getBookings($params = [])</code></li>
<li><code>cancelBooking($bookingId, $reason = null)</code></li>
</ul>
<hr />
<h3 id="calcomsyncservice">CalcomSyncService<a class="headerlink" href="#calcomsyncservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>syncEventTypesForCompany($companyId)</code></li>
</ul>
<p>Synchronisiere Event-Types für ein Unternehmen
- <code>syncTeamMembers($companyId)</code></p>
<p>Synchronisiere Team-Mitglieder für ein Unternehmen
- <code>checkAvailability($eventTypeId, $dateFrom, $dateTo, $staffId = null)</code></p>
<p>Prüfe Verfügbarkeit für einen Event-Type
- <code>invalidateEventTypeCache($eventTypeId)</code></p>
<p>Cache für einen Event-Type invalidieren
- <code>invalidateCompanyCache($companyId)</code></p>
<p>Cache für alle Event-Types einer Company invalidieren</p>
<hr />
<h3 id="calcomv2migrationservice">CalcomV2MigrationService<a class="headerlink" href="#calcomv2migrationservice" title="Permanent link">&para;</a></h3>
<p>Cal.com V2 Migration Service
This service provides v2 API compatibility while maintaining
backward compatibility with existing v1 implementations.</p>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>getEventTypes(string $apiKey): ?array</code></li>
</ul>
<p>Fetch event types using v2 API
- <code>checkAvailability(string $apiKey, int $eventTypeId, string $startDate, string $endDate, ?string $timezone = null): ?array</code></p>
<p>Check availability using v2 API
- <code>createBooking(string $apiKey, array $bookingData): ?array</code></p>
<p>Create a booking using v2 API
- <code>testConnection(string $apiKey): array</code></p>
<p>Test API connection and permissions</p>
<hr />
<h3 id="calcomv2service">CalcomV2Service<a class="headerlink" href="#calcomv2service" title="Permanent link">&para;</a></h3>
<p>Cal.com V2 API Integration Service
Provides comprehensive integration with Cal.com's V2 API for calendar management.
This service handles:
- Event type management and synchronization
- Availability checking with real-time slot calculation
- Booking creation and management
- Circuit breaker pattern for fault tolerance
- Rate limiting to respect API quotas
- Automatic retries with exponential backoff</p>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>getMe()</code></li>
</ul>
<p>Get current user info (v2)
- <code>getUsers()</code></p>
<p>V1 API für Users nutzen
- <code>getEventTypes()</code></p>
<p>V1 API für Event-Types nutzen
- <code>getEventTypeDetails($eventTypeId)</code></p>
<p>Get detailed information for a specific event type
- <code>checkAvailability($eventTypeId, $date, $timezone = "Europe\/Berlin")</code></p>
<p>V2 API für Verfügbarkeiten - mit korrektem Slot-Flattening
- <code>bookAppointment($eventTypeId, $startTime, $endTime, $customerData, $notes = null)</code></p>
<p>Create a booking in Cal.com calendar
  Books an appointment slot in Cal.com using the V1 API for compatibility.
  This method handles customer data validation, time slot verification,
  and creates the booking with proper error handling.
    name: string,
    email: string,
    phone?: string,
    metadata?: array
  } $customerData Customer information
    success: bool,
    booking_id?: int,
    booking_uid?: string,
    error?: string,
    details?: array
  }
- <code>getBookings($params = [])</code></p>
<p>Hole alle Bookings mit Paginierung
- <code>getBooking($bookingId)</code></p>
<p>Hole ein einzelnes Booking
- <code>getSchedules()</code></p>
<p>Get all schedules - Note: V2 doesn't have schedules endpoint, use V1
- <code>getTeams()</code></p>
<p>Get teams (v2)
- <code>getTeamEventTypes($teamId)</code></p>
<p>Get team event types (v2)
- <code>getWebhooks()</code></p>
<p>Get webhooks (v2)
- <code>createWebhook($subscriberUrl, $triggers = ["BOOKING_CREATED","BOOKING_CANCELLED","BOOKING_RESCHEDULED"])</code></p>
<p>Create webhook (v2)
- <code>cancelBooking($bookingId, $reason = null)</code></p>
<p>Cancel booking (v2)
- <code>rescheduleBooking($bookingId, $start, $reason = null)</code></p>
<p>Reschedule booking (v2)
- <code>getSlots($eventTypeId, $startDate, $endDate, $timeZone = "Europe\/Berlin")</code></p>
<p>Get available time slots for an event type
  Uses V2 API
- <code>updateBooking($bookingId, array $updateData)</code></p>
<p>Update an existing booking</p>
<hr />
<h3 id="retellagentservice">RetellAgentService<a class="headerlink" href="#retellagentservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>getAgentDetails($agentId)</code></li>
<li><code>getAgentStatistics($agentId, $days = 7)</code></li>
<li><code>listAgents()</code></li>
<li><code>validateAgentConfiguration($agentId)</code></li>
</ul>
<hr />
<h3 id="retellservice">RetellService<a class="headerlink" href="#retellservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>getAgents()</code></li>
</ul>
<p>Alle Agenten abrufen
- <code>getAgent($agentId)</code></p>
<p>Einzelnen Agenten abrufen
- <code>updateAgent($agentId, array $data)</code></p>
<p>Update agent metadata
- <code>clearCache()</code></p>
<p>Cache leeren
- <code>buildInboundResponse($agentId, $fromNumber = null, $dynamicVariables = [])</code></p>
<p>Build response for inbound calls with dynamic variables</p>
<hr />
<h3 id="retellv2service">RetellV2Service<a class="headerlink" href="#retellv2service" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>createPhoneCall(array $payload): array</code></li>
</ul>
<p>Einen Anruf starten.
   Erforderlich   : from_number  (+E.164)
   Entweder ODER  : to_number    (+E.164)  <strong>oder</strong>  agent_id
- <code>createAgent(array $config): array</code></p>
<p>Create a new agent
- <code>updateAgent(string $agentId, array $config): array</code></p>
<p>Update existing agent
- <code>getAgent(string $agentId): ?array</code></p>
<p>Get agent details
- <code>listAgents(): array</code></p>
<p>List all agents
- <code>deleteAgent(string $agentId): bool</code></p>
<p>Delete an agent
- <code>updatePhoneNumber(string $phoneNumber, array $config): array</code></p>
<p>Update phone number configuration
- <code>getCall(string $callId): ?array</code></p>
<p>Get call details
- <code>listCalls(int $limit = 50): array</code></p>
<p>List recent calls
- <code>listPhoneNumbers(): array</code></p>
<p>List all phone numbers
- <code>getPhoneNumber(string $phoneNumberId): ?array</code></p>
<p>Get phone number details
- <code>getAgentPrompt(string $agentId): ?string</code></p>
<p>Get agent prompt only</p>
<hr />
<h3 id="stripeinvoiceservice">StripeInvoiceService<a class="headerlink" href="#stripeinvoiceservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>ensureStripeCustomer(App\Models\Company $company): ?string</code></li>
</ul>
<p>Create or update Stripe customer for a company.
- <code>createInvoiceForBillingPeriod(App\Models\BillingPeriod $billingPeriod): ?App\Models\Invoice</code></p>
<p>Create invoice for a billing period.
- <code>processWebhook(array $event): void</code></p>
<p>Process Stripe webhook for invoice events.
- <code>createManualInvoice(App\Models\Company $company, array $items, ?int $branchId = null): ?App\Models\Invoice</code></p>
<p>Create manual invoice for additional services.</p>
<hr />
<h2 id="business-services">Business Services<a class="headerlink" href="#business-services" title="Permanent link">&para;</a></h2>
<h3 id="appointmentbookingservice">AppointmentBookingService<a class="headerlink" href="#appointmentbookingservice" title="Permanent link">&para;</a></h3>
<p>Central service for managing appointment bookings across all channels
This service orchestrates the complete appointment booking flow, including:
- Customer management (find/create)
- Service and staff validation
- Availability checking with time slot locking
- Calendar integration (Cal.com)
- Notification sending
- Transaction management</p>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>bookFromPhoneCall($callOrData, ?array $appointmentData = null): array</code></li>
</ul>
<p>Book an appointment from a phone call with AI-extracted data
  Handles the complete phone-to-appointment flow, supporting both legacy
  format and the new collect_appointment_data format from Retell.ai
    success: bool,
    appointment: Appointment|null,
    message: string,
    confirmation_number?: string,
    errors?: array
  }
- <code>cleanupExpiredLocks(): int</code></p>
<p>Clean up expired locks (delegates to TimeSlotLockManager)
- <code>extendLock(string $lockToken, int $additionalMinutes = 5): bool</code></p>
<p>Extend an existing lock (useful for long-running operations)
- <code>isSlotLocked($staff, $startTime, $endTime): bool</code></p>
<p>Check if a time slot is currently locked</p>
<hr />
<h3 id="appointmentservice">AppointmentService<a class="headerlink" href="#appointmentservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>create(array $data): App\Models\Appointment</code></li>
</ul>
<p>Create new appointment
- <code>update(int $appointmentId, array $data): App\Models\Appointment</code></p>
<p>Update appointment
- <code>cancel(int $appointmentId, ?string $reason = null): bool</code></p>
<p>Cancel appointment
- <code>checkAvailability(int $staffId, $startTime, $endTime, ?int $excludeAppointmentId = null): bool</code></p>
<p>Check availability
- <code>getAvailableSlots(int $staffId, Carbon\Carbon $date, int $duration = 30): array</code></p>
<p>Get available time slots
- <code>complete(int $appointmentId, array $data = []): bool</code></p>
<p>Complete appointment
- <code>markAsNoShow(int $appointmentId): bool</code></p>
<p>Mark as no-show
- <code>getStatistics(Carbon\Carbon $startDate, Carbon\Carbon $endDate): array</code></p>
<p>Get appointment statistics</p>
<hr />
<h3 id="customerportalservice">CustomerPortalService<a class="headerlink" href="#customerportalservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>enablePortalAccess(App\Models\CustomerAuth $customer, ?string $password = null): bool</code></li>
</ul>
<p>Enable portal access for a customer.
- <code>disablePortalAccess(App\Models\CustomerAuth $customer): bool</code></p>
<p>Disable portal access for a customer.
- <code>sendMagicLink(App\Models\CustomerAuth $customer, string $token): bool</code></p>
<p>Send magic link to customer.
- <code>getPortalUrl(App\Models\Company $company): string</code></p>
<p>Generate portal URL for company.
- <code>canAccessPortal(App\Models\CustomerAuth $customer): bool</code></p>
<p>Check if customer can access portal.
- <code>getPortalFeatures(App\Models\Company $company): array</code></p>
<p>Get portal features for company.
- <code>getCustomerStats(App\Models\CustomerAuth $customer): array</code></p>
<p>Get portal statistics for customer.
- <code>bulkEnablePortalAccess(App\Models\Company $company, array $customerIds = []): array</code></p>
<p>Bulk enable portal access.</p>
<hr />
<h3 id="customerservice">CustomerService<a class="headerlink" href="#customerservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>findByPhone(string $phone, int $companyId): ?App\Models\Customer</code></li>
</ul>
<p>Find customer by phone with caching
- <code>create(array $data): App\Models\Customer</code></p>
<p>Create new customer
- <code>update(int $customerId, array $data): App\Models\Customer</code></p>
<p>Update customer
- <code>mergeDuplicates(int $primaryId, int $duplicateId): App\Models\Customer</code></p>
<p>Merge duplicate customers
- <code>getHistory(int $customerId): array</code></p>
<p>Get customer history
- <code>findPotentialDuplicates(int $customerId): Illuminate\Support\Collection</code></p>
<p>Search for potential duplicates
- <code>block(int $customerId, string $reason): void</code></p>
<p>Block customer
- <code>unblock(int $customerId): void</code></p>
<p>Unblock customer
- <code>addTag(int $customerId, string $tag): void</code></p>
<p>Add tag to customer
- <code>removeTag(int $customerId, string $tag): void</code></p>
<p>Remove tag from customer
- <code>getByTag(string $tag): Illuminate\Support\Collection</code></p>
<p>Get customers by tag
- <code>export(int $customerId): array</code></p>
<p>Export customer data</p>
<hr />
<h3 id="smartbookingservice">SmartBookingService<a class="headerlink" href="#smartbookingservice" title="Permanent link">&para;</a></h3>
<p>SmartBookingService - Der zentrale Service für alle Terminbuchungen
Konsolidiert die Funktionalität von:
- AppointmentService
- BookingService
- Teile von CallService</p>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>handleIncomingCall(array $webhookData): ?App\Models\Appointment</code></li>
</ul>
<p>Hauptmethode: Verarbeitet einen eingehenden Anruf und bucht einen Termin</p>
<hr />
<h2 id="other-services">Other Services<a class="headerlink" href="#other-services" title="Permanent link">&para;</a></h2>
<h3 id="anomalydetectionservice">AnomalyDetectionService<a class="headerlink" href="#anomalydetectionservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>detectSystemAnomalies(): array</code></li>
</ul>
<p>Detect anomalies across the entire system
- <code>getSeverityScore(string $severity): int</code></p>
<p>Get severity score for prioritization
- <code>getSystemRecommendations(array $anomalies): array</code></p>
<p>Get recommendations based on current anomalies</p>
<hr />
<h3 id="availabilitychecker">AvailabilityChecker<a class="headerlink" href="#availabilitychecker" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>checkAvailabilityFromRequest($request)</code></li>
</ul>
<p>Parse eine Anfrage und prüfe Verfügbarkeiten intelligent
- <code>checkAvailability($eventTypeId, $dateFrom, $dateTo, $staffId = null, $branchId = null)</code></p>
<p>Prüfe Verfügbarkeit mit allen Business-Regeln
- <code>findNextAvailableSlot($eventTypeId, $staffId = null, $branchId = null)</code></p>
<p>Finde nächsten verfügbaren Termin</p>
<hr />
<h3 id="availabilityservice">AvailabilityService<a class="headerlink" href="#availabilityservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>checkRealTimeAvailability(string $staffId, int $eventTypeId, Carbon\Carbon $date): array</code></li>
</ul>
<p>Prüfe Echtzeit-Verfügbarkeit für einen Mitarbeiter
- <code>checkMultipleStaffAvailability(array $staffIds, int $eventTypeId, Carbon\Carbon $date): Illuminate\Support\Collection</code></p>
<p>Prüfe Verfügbarkeit für mehrere Mitarbeiter gleichzeitig
- <code>getNextAvailableSlot(string $staffId, int $eventTypeId, Carbon\Carbon $fromDate): ?array</code></p>
<p>Finde nächsten verfügbaren Slot</p>
<hr />
<h3 id="cacheservice">CacheService<a class="headerlink" href="#cacheservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>getEventTypes(int $companyId, callable $callback)</code></li>
</ul>
<p>Get Cal.com event types with caching
- <code>getCustomerByPhone(string $phone, int $companyId, callable $callback)</code></p>
<p>Get customer by phone with caching
- <code>getAvailability(int $staffId, string $date, callable $callback)</code></p>
<p>Get appointment availability with caching
- <code>getCompanySettings(int $companyId, callable $callback)</code></p>
<p>Get company settings with caching
- <code>getStaffSchedules(int $staffId, callable $callback)</code></p>
<p>Get staff schedules with caching
- <code>getServiceLists(int $companyId, ?int $branchId, callable $callback)</code></p>
<p>Get service lists with caching
- <code>clearCompanyCache(int $companyId): void</code></p>
<p>Clear cache by company
- <code>clearStaffCache(int $staffId): void</code></p>
<p>Clear cache by staff
- <code>clearCustomerCache(string $identifier): void</code></p>
<p>Clear cache by customer
- <code>clearAppointmentsCache(string $date): void</code></p>
<p>Clear appointments cache by date
- <code>clearEventTypesCache(): void</code></p>
<p>Clear all event types cache</p>
<hr />
<h3 id="cachewarmer">CacheWarmer<a class="headerlink" href="#cachewarmer" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>warmInvoiceCaches(): void</code></li>
</ul>
<p>Warm invoice-related caches
- <code>isUsageBasedInvoice(App\Models\Invoice $invoice): bool</code></p>
<p>Check if an invoice is usage-based using cache</p>
<hr />
<h3 id="calservice">CalService<a class="headerlink" href="#calservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>getEventTypes()</code></li>
<li><code>createBooking($data)</code></li>
</ul>
<hr />
<h3 id="calldatarefresher">CallDataRefresher<a class="headerlink" href="#calldatarefresher" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>refresh(App\Models\Call $call): bool</code></li>
</ul>
<hr />
<h3 id="callservice">CallService<a class="headerlink" href="#callservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>processWebhook(array $webhookData): App\Models\Call</code></li>
</ul>
<p>Process incoming call webhook
- <code>getStatistics(Carbon\Carbon $startDate, Carbon\Carbon $endDate): array</code></p>
<p>Get call statistics
- <code>refreshCallData(int $callId): bool</code></p>
<p>Refresh call data from Retell
- <code>markAsFailed(int $callId, string $reason): void</code></p>
<p>Mark call as failed</p>
<hr />
<h3 id="callbackservice">CallbackService<a class="headerlink" href="#callbackservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>createFromFailedBooking(App\Models\Call $call, string $reason, array $bookingData, ?string $errorDetails = null): App\Models\CallbackRequest</code></li>
</ul>
<p>Create callback request from failed booking
- <code>sendDailySummary(App\Models\Company $company, string $email): void</code></p>
<p>Send daily summary email
- <code>autoCloseOldCallbacks(): int</code></p>
<p>Auto-close old callbacks
- <code>getStatistics(App\Models\Company $company, ?Carbon\Carbon $from = null, ?Carbon\Carbon $to = null): array</code></p>
<p>Get callback statistics for company</p>
<hr />
<h3 id="companyservice">CompanyService<a class="headerlink" href="#companyservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>getSettings(int $companyId): ?array</code></li>
</ul>
<p>Get company settings with caching
- <code>updateSettings(int $companyId, array $settings): bool</code></p>
<p>Update company settings
- <code>updateConfiguration(int $companyId, array $data): bool</code></p>
<p>Update company configuration
- <code>getCompany(int $companyId): ?App\Models\Company</code></p>
<p>Get company by ID with caching
- <code>isActive(int $companyId): bool</code></p>
<p>Check if company is active
- <code>isInTrial(int $companyId): bool</code></p>
<p>Check if company is in trial
- <code>getNotificationEmails(int $companyId): array</code></p>
<p>Get company notification emails
- <code>getCalendarConfig(int $companyId): array</code></p>
<p>Get company calendar configuration</p>
<hr />
<h3 id="conflictdetectionservice">ConflictDetectionService<a class="headerlink" href="#conflictdetectionservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>detectConflicts(string $staffId, Carbon\Carbon $startTime, Carbon\Carbon $endTime, ?int $excludeAppointmentId = null): array</code></li>
</ul>
<p>Erkenne Konflikte für eine neue Buchung
- <code>batchConflictCheck(array $appointments): array</code></p>
<p>Batch-Konfliktprüfung für mehrere Termine</p>
<hr />
<h3 id="cookieconsentservice">CookieConsentService<a class="headerlink" href="#cookieconsentservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>hasConsent(?string $category = null): bool</code></li>
</ul>
<p>Check if user has given consent
- <code>getCurrentConsent(): ?array</code></p>
<p>Get current consent status
- <code>saveConsent(array $preferences): App\Models\CookieConsent</code></p>
<p>Save consent preferences
- <code>withdrawConsent(): void</code></p>
<p>Withdraw consent
- <code>getCookieCategories(): array</code></p>
<p>Get cookie categories with descriptions
- <code>shouldShowBanner(): bool</code></p>
<p>Check if cookie banner should be shown
- <code>getConsentStatistics(int $companyId): array</code></p>
<p>Get consent statistics for a company</p>
<hr />
<h3 id="currencyconverter">CurrencyConverter<a class="headerlink" href="#currencyconverter" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>centsToEuros(float $cents): float</code></li>
</ul>
<p>Convert cents to euros
- <code>dollarsToEuros(float $dollars): float</code></p>
<p>Convert dollars to euros
- <code>getExchangeRate($date = null): float</code></p>
<p>Get current exchange rate (cached)
- <code>convertRetellCostToEuros($costData): float</code></p>
<p>Convert Retell cost structure to euros
- <code>formatCostBreakdown(array $costBreakdown): array</code></p>
<p>Format cost breakdown for storage
  Konvertiert alle Cent-Werte zu Euro-Werten</p>
<hr />
<h3 id="dashboardrouteresolver">DashboardRouteResolver<a class="headerlink" href="#dashboardrouteresolver" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>resolve(string $slug): ?string</code></li>
</ul>
<p>Resolve a dashboard route by its slug
- <code>getDefault(): string</code></p>
<p>Get the default dashboard route
- <code>exists(string $slug): bool</code></p>
<p>Check if a dashboard exists
- <code>getAllDashboards(): array</code></p>
<p>Get all available dashboards</p>
<hr />
<h3 id="datevexportservice">DatevExportService<a class="headerlink" href="#datevexportservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>exportInvoices(App\Models\Company $company, Carbon\Carbon $startDate, Carbon\Carbon $endDate, string $format = "EXTF"): array</code></li>
</ul>
<p>Exportiert Rechnungen im DATEV-Format</p>
<hr />
<h3 id="eagerloadinganalyzer">EagerLoadingAnalyzer<a class="headerlink" href="#eagerloadinganalyzer" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>startAnalysis(): void</code></li>
</ul>
<p>Start analyzing queries for N+1 problems
- <code>stopAnalysis(): array</code></p>
<p>Stop analyzing and return results
- <code>analyzeModel(string $modelClass): array</code></p>
<p>Analyze a specific model for potential N+1 issues</p>
<hr />
<h3 id="encryptionservice">EncryptionService<a class="headerlink" href="#encryptionservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>encrypt(?string $value): ?string</code></li>
</ul>
<p>Encrypt sensitive data
- <code>decrypt(?string $value): ?string</code></p>
<p>Decrypt sensitive data
- <code>isEncrypted(string $value): bool</code></p>
<p>Check if a value is encrypted
- <code>rotateKey(array $models, array $fields): void</code></p>
<p>Rotate encryption key (requires APP_KEY rotation)</p>
<hr />
<h3 id="eventtypematchingservice">EventTypeMatchingService<a class="headerlink" href="#eventtypematchingservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>findMatchingEventType(string $serviceRequest, App\Models\Branch $branch, ?string $staffName = null, ?array $timePreference = null): ?array</code></li>
</ul>
<p>Find matching event type based on service request and optional staff preference
- <code>createMapping(App\Models\Service $service, App\Models\CalcomEventType $eventType, ?array $keywords = null, int $priority = 0): void</code></p>
<p>Create or update service to event type mapping</p>
<hr />
<h3 id="eventtypenameparser">EventTypeNameParser<a class="headerlink" href="#eventtypenameparser" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>parseEventTypeName(string $eventTypeName): array</code></li>
</ul>
<p>Parse einen Event-Type Namen nach dem Schema: "Filial-Unternehmen-Dienstleistung"
- <code>validateBranchMatch(string $parsedBranchName, App\Models\Branch $selectedBranch): bool</code></p>
<p>Validiere ob der geparste Filialname zur ausgewählten Filiale passt
- <code>generateEventTypeName(App\Models\Branch $branch, string $serviceName): string</code></p>
<p>Generiere den korrekten Event-Type Namen nach Schema
- <code>analyzeEventTypesForImport(array $eventTypes, App\Models\Branch $targetBranch): array</code></p>
<p>Analysiere eine Liste von Event-Types und schlage Zuordnungen vor
- <code>extractServiceName(string $eventTypeName): string</code></p>
<p>Extrahiere nur den Service-Namen aus einem vollständigen Event-Type Namen</p>
<hr />
<h3 id="featureflagservice">FeatureFlagService<a class="headerlink" href="#featureflagservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>isEnabled(string $key, ?string $companyId = null, bool $trackUsage = true): bool</code></li>
</ul>
<p>Check if a feature is enabled
- <code>createOrUpdate(array $data): void</code></p>
<p>Create or update a feature flag
- <code>setOverride(string $key, string $companyId, bool $enabled, ?string $reason = null): void</code></p>
<p>Set company override
- <code>removeOverride(string $key, string $companyId): void</code></p>
<p>Remove company override
- <code>getAllFlags(): array</code></p>
<p>Get all feature flags
- <code>getCompanyOverrides(string $companyId): array</code></p>
<p>Get company overrides
- <code>getUsageStats(string $key, int $hours = 24): array</code></p>
<p>Get usage statistics
- <code>areEnabled(array $keys, ?string $companyId = null): array</code></p>
<p>Batch check multiple flags
- <code>emergencyDisableAll(string $reason): void</code></p>
<p>Emergency kill switch - disable all features</p>
<hr />
<h3 id="filewatcherservice">FileWatcherService<a class="headerlink" href="#filewatcherservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>checkForChanges(): array</code></li>
</ul>
<p>Check for file changes and re-index if needed
- <code>forceReindex(): array</code></p>
<p>Force re-index all files
- <code>getStatus(): array</code></p>
<p>Get watcher status
- <code>setLastCheck(): void</code></p>
<p>Set last check time</p>
<hr />
<h3 id="gdprservice">GdprService<a class="headerlink" href="#gdprservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>exportCustomerData(App\Models\Customer $customer): array</code></li>
</ul>
<p>Export all customer data in a machine-readable format
- <code>createExportFile(App\Models\Customer $customer): string</code></p>
<p>Create a downloadable export file
- <code>deleteCustomerData(App\Models\Customer $customer, bool $anonymize = true): void</code></p>
<p>Delete all customer data (right to be forgotten)</p>
<hr />
<h3 id="healthcheckservice">HealthCheckService<a class="headerlink" href="#healthcheckservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>setCompany(App\Models\Company $company): self</code></li>
</ul>
<p>Set the company context
- <code>runAll(): App\Contracts\HealthReport</code></p>
<p>Run all health checks
- <code>runCheck(App\Contracts\IntegrationHealthCheck $check): App\Contracts\HealthCheckResult</code></p>
<p>Run a specific health check
- <code>runCheckByName(string $name): ?App\Contracts\HealthCheckResult</code></p>
<p>Run check by name
- <code>getCriticalChecks(): array</code></p>
<p>Get all critical checks
- <code>getChecksByStatus(string $status): array</code></p>
<p>Get checks by status
- <code>attemptAutoFix(): array</code></p>
<p>Attempt auto-fix for all checks with issues
- <code>getSuggestedFixes(): array</code></p>
<p>Get suggested fixes for all issues
- <code>getHealthStatusForBadge(): array</code></p>
<p>Get health status for admin badge
- <code>clearCache(): void</code></p>
<p>Clear all health check caches
- <code>getHistory(string $checkName, int $days = 7): Illuminate\Support\Collection</code></p>
<p>Get historical health check results</p>
<hr />
<h3 id="horizonhealth">HorizonHealth<a class="headerlink" href="#horizonhealth" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>ok(): bool</code></li>
</ul>
<p>true = queues healthy, false = stalled/offline */</p>
<hr />
<h3 id="improvedeventtypenameparser">ImprovedEventTypeNameParser<a class="headerlink" href="#improvedeventtypenameparser" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>extractCleanServiceName(string $eventTypeName, ?App\Models\Branch $branch = null, ?App\Models\Company $company = null): string</code></li>
</ul>
<p>Extract a clean service name from a marketing-style event type name
- <code>analyzeEventTypesForImport(array $eventTypes, App\Models\Branch $targetBranch): array</code></p>
<p>Improved analyze method that handles marketing-style names better
- <code>generateEventTypeName(App\Models\Branch $branch, string $serviceName, string $format = "standard"): string</code></p>
<p>Generate a standardized event type name with optional format
- <code>parseEventTypeName(string $eventTypeName): array</code></p>
<p>Parse einen Event-Type Namen nach dem Schema: "Filial-Unternehmen-Dienstleistung"
- <code>validateBranchMatch(string $parsedBranchName, App\Models\Branch $selectedBranch): bool</code></p>
<p>Validiere ob der geparste Filialname zur ausgewählten Filiale passt
- <code>extractServiceName(string $eventTypeName): string</code></p>
<p>Extrahiere nur den Service-Namen aus einem vollständigen Event-Type Namen</p>
<hr />
<h3 id="integrationtestservice">IntegrationTestService<a class="headerlink" href="#integrationtestservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>createTestBooking(App\Models\Branch $branch): array</code></li>
</ul>
<p>Create a test booking for a branch
- <code>testCalcomConnection($apiKey)</code></p>
<p>Test Cal.com connection
- <code>testRetellConnection($apiKey, $agentId = null)</code></p>
<p>Test Retell.ai connection</p>
<hr />
<h3 id="invoicecomplianceservice">InvoiceComplianceService<a class="headerlink" href="#invoicecomplianceservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>generateCompliantInvoiceNumber(App\Models\Company $company): string</code></li>
</ul>
<p>Generiert eine GoBD-konforme Rechnungsnummer
  Format: [Mandantenkürzel]-[Jahr]-[Laufende Nr]-[Prüfziffer]
  Beispiel: ASK-2024-00001-7
- <code>finalizeInvoice(App\Models\Invoice $invoice): void</code></p>
<p>Finalisiert eine Rechnung (macht sie unveränderbar)
- <code>archiveInvoice(App\Models\Invoice $invoice): void</code></p>
<p>Archiviert eine Rechnung GoBD-konform
- <code>createAuditLog(App\Models\Invoice $invoice, string $action, ?array $changes = null): void</code></p>
<p>Erstellt Audit-Log Eintrag
- <code>validateInvoiceCompliance(App\Models\Invoice $invoice): array</code></p>
<p>Validiert Rechnungspflichtangaben nach §14 UStG
- <code>createCancellationInvoice(App\Models\Invoice $originalInvoice): App\Models\Invoice</code></p>
<p>Generiert eine Storno-Rechnung
- <code>canModifyInvoice(App\Models\Invoice $invoice): bool</code></p>
<p>Prüft ob eine Rechnung geändert werden darf
- <code>generateDatevExport(App\Models\Company $company, Carbon\Carbon $startDate, Carbon\Carbon $endDate): array</code></p>
<p>Generiert DATEV-kompatible Buchungssätze</p>
<hr />
<h3 id="knowledgebaseservice">KnowledgeBaseService<a class="headerlink" href="#knowledgebaseservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>discoverAndIndexDocuments(array $paths = []): array</code></li>
</ul>
<p>Discover and index all documentation files
- <code>indexFile(string $filePath): ?App\Models\KnowledgeDocument</code></p>
<p>Index a single documentation file
- <code>search(string $query, array $filters = []): Illuminate\Support\Collection</code></p>
<p>Search documents</p>
<hr />
<h3 id="masterservicemanager">MasterServiceManager<a class="headerlink" href="#masterservicemanager" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>getEffectiveServicesForBranch(App\Models\Branch $branch): array</code></li>
<li><code>deployServiceToBranches(App\Models\MasterService $service, array $branchIds): void</code></li>
</ul>
<hr />
<h3 id="mobiledetector">MobileDetector<a class="headerlink" href="#mobiledetector" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>setRequest(Illuminate\Http\Request $request): self</code></li>
<li><code>isMobile(): bool</code></li>
<li><code>isTablet(): bool</code></li>
<li><code>isDesktop(): bool</code></li>
<li><code>getDeviceType(): string</code></li>
<li><code>getViewport(): array</code></li>
<li><code>getUserAgent(): ?string</code></li>
<li><code>isIOS(): bool</code></li>
<li><code>isAndroid(): bool</code></li>
<li><code>isTouchDevice(): bool</code></li>
<li><code>getOS(): string</code></li>
<li><code>getBrowser(): string</code></li>
<li><code>supportsWebP(): bool</code></li>
<li><code>supportsPWA(): bool</code></li>
<li><code>getDevicePixelRatio(): float</code></li>
</ul>
<hr />
<h3 id="navigationservice">NavigationService<a class="headerlink" href="#navigationservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>getResourceGroup(string $resource): ?string</code></li>
</ul>
<p>Get navigation group for a resource
- <code>getGroupLabel(string $group): string</code></p>
<p>Get navigation group label
- <code>getGroupSort(string $group): int</code></p>
<p>Get navigation group sort order
- <code>getGroupIcon(string $group): string</code></p>
<p>Get navigation group icon
- <code>getResourceSort(string $resource, int $default = 10): int</code></p>
<p>Get sort order for a resource within its group
- <code>canViewGroup(string $group, $user = null): bool</code></p>
<p>Check if user has permission to view a navigation group
- <code>getVisibleGroups($user = null): array</code></p>
<p>Get all visible groups for a user
- <code>getNavigationForResource(string $resourceClass): array</code></p>
<p>Get navigation structure for use in Filament resources
- <code>registerWithFilament(): void</code></p>
<p>Register navigation groups with Filament
  Call this in a service provider
- <code>getBreadcrumbs(string $resourceClass, array $additionalCrumbs = []): array</code></p>
<p>Get breadcrumb structure for a resource
- <code>getActionLabel(string $action): string</code></p>
<p>Get a consistent label for common actions</p>
<hr />
<h3 id="notificationservice">NotificationService<a class="headerlink" href="#notificationservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>sendAppointmentReminders(): void</code></li>
</ul>
<p>Sende Terminerinnerungen
- <code>sendAppointmentConfirmation(App\Models\Appointment $appointment): void</code></p>
<p>Sende Terminbestätigung</p>
<hr />
<h3 id="onboardingservice">OnboardingService<a class="headerlink" href="#onboardingservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>getProgress(App\Models\Company $company, App\Models\User $user): array</code></li>
</ul>
<p>Get or create onboarding progress for a company/user
- <code>updateProgress(App\Models\Company $company, App\Models\User $user, string $step, array $data = []): array</code></p>
<p>Update onboarding progress
- <code>validateStep(App\Models\Company $company, string $step): bool</code></p>
<p>Validate a specific step
- <code>getSampleData(string $step): array</code></p>
<p>Get sample data for a step
- <code>getChecklist(App\Models\Company $company, string $type = "getting_started"): array</code></p>
<p>Get checklist for a company
- <code>updateChecklistItem(App\Models\Company $company, string $type, string $itemKey, bool $completed): void</code></p>
<p>Update checklist item status
- <code>awardAchievement(App\Models\Company $company, string $achievementKey): void</code></p>
<p>Award achievement to company
- <code>getAchievements(App\Models\Company $company): Illuminate\Support\Collection</code></p>
<p>Get company achievements
- <code>getTutorialsForPage(string $pageRoute): Illuminate\Support\Collection</code></p>
<p>Get available tutorials for a page
- <code>markTutorialProgress(App\Models\User $user, int $tutorialId, bool $completed = false): void</code></p>
<p>Mark tutorial as viewed/completed
- <code>getSteps(): array</code></p>
<p>Get all defined steps
- <code>getReadinessScore(App\Models\Company $company): int</code></p>
<p>Calculate overall readiness score</p>
<hr />
<h3 id="phonenumberresolver">PhoneNumberResolver<a class="headerlink" href="#phonenumberresolver" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>resolve(string $phoneNumber): array</code></li>
</ul>
<p>Simple resolve method for MCPContextResolver compatibility
- <code>resolveFromWebhook(array $webhookData): array</code></p>
<p>Resolve branch and agent from phone number or metadata
  Enhanced for multi-location support
- <code>normalize(string $phoneNumber): string</code></p>
<p>Public method to normalize phone numbers</p>
<hr />
<h3 id="pricingservice">PricingService<a class="headerlink" href="#pricingservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>calculateCallPrice(App\Models\Call $call): array</code></li>
</ul>
<p>Calculate the customer price for a call
- <code>getCurrentMonthMinutes($companyId, $branchId = null): float</code></p>
<p>Get total minutes used in current month
- <code>calculateBillingPeriod($companyId, Carbon\Carbon $startDate, Carbon\Carbon $endDate)</code></p>
<p>Calculate billing for a period
- <code>saveBillingPeriod(array $billingData): App\Models\BillingPeriod</code></p>
<p>Create or update billing period record</p>
<hr />
<h3 id="prompttemplateservice">PromptTemplateService<a class="headerlink" href="#prompttemplateservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>getAvailableTemplates(): array</code></li>
</ul>
<p>Get available industry templates
- <code>renderPrompt(App\Models\Branch $branch, string $industry = "generic", array $additionalData = []): string</code></p>
<p>Render a prompt template for a branch
- <code>generateRetellPrompt(App\Models\Branch $branch, array $config = []): array</code></p>
<p>Generate prompt for Retell agent</p>
<hr />
<h3 id="querycache">QueryCache<a class="headerlink" href="#querycache" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>getAppointmentStats($companyId, $dateRange = "month")</code></li>
</ul>
<p>Cache appointment statistics
- <code>getCustomerMetrics($companyId)</code></p>
<p>Cache customer metrics
- <code>getCallStats($companyId, $days = 30)</code></p>
<p>Cache call statistics
- <code>getStaffPerformance($companyId, $staffId = null, $days = 30)</code></p>
<p>Cache staff performance metrics
- <code>getBranchComparison($companyId, $dateRange = "month")</code></p>
<p>Cache branch comparison data
- <code>clearCompanyCache($companyId)</code></p>
<p>Clear cache for a specific company
- <code>clearAllCaches()</code></p>
<p>Clear all query caches
- <code>getCacheStats()</code></p>
<p>Get cache statistics</p>
<hr />
<h3 id="querymonitor">QueryMonitor<a class="headerlink" href="#querymonitor" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>enable(): void</code></li>
</ul>
<p>Enable query monitoring
- <code>getStats(): array</code></p>
<p>Get query statistics
- <code>getRecentQueries(int $limit = 50): array</code></p>
<p>Get recent queries
- <code>getSlowQueries(int $limit = 50): array</code></p>
<p>Get slow queries
- <code>clearStats(): void</code></p>
<p>Clear query statistics
- <code>analyzePatterns(): array</code></p>
<p>Analyze query patterns
- <code>setSlowQueryThreshold(int $milliseconds): void</code></p>
<p>Set slow query threshold</p>
<hr />
<h3 id="queryoptimizer">QueryOptimizer<a class="headerlink" href="#queryoptimizer" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>optimizeEagerLoading(Illuminate\Database\Eloquent\Builder $query, array $relationships): Illuminate\Database\Eloquent\Builder</code></li>
</ul>
<p>Eagerly load relationships to prevent N+1 queries
- <code>applyIndexHints(Illuminate\Database\Eloquent\Builder $query, string $table, array $indexes): Illuminate\Database\Eloquent\Builder</code></p>
<p>Apply index hints for better query performance
- <code>optimizeAppointmentQuery(Illuminate\Database\Eloquent\Builder $query): Illuminate\Database\Eloquent\Builder</code></p>
<p>Optimize appointment queries
- <code>optimizeCustomerQuery(Illuminate\Database\Eloquent\Builder $query): Illuminate\Database\Eloquent\Builder</code></p>
<p>Optimize customer queries
- <code>optimizeCallQuery(Illuminate\Database\Eloquent\Builder $query): Illuminate\Database\Eloquent\Builder</code></p>
<p>Optimize call queries
- <code>optimizeStaffQuery(Illuminate\Database\Eloquent\Builder $query): Illuminate\Database\Eloquent\Builder</code></p>
<p>Optimize staff queries
- <code>cacheAggregation(string $key, Closure $callback, int $ttl = 300)</code></p>
<p>Cache complex aggregation queries
- <code>analyzeQuery(Illuminate\Database\Eloquent\Builder $query): array</code></p>
<p>Analyze query performance
- <code>getQueryStats(): array</code></p>
<p>Get query statistics
- <code>optimizePagination(Illuminate\Database\Eloquent\Builder $query, int $perPage = 15): Illuminate\Database\Eloquent\Builder</code></p>
<p>Optimize pagination queries
- <code>forceIndex(Illuminate\Database\Eloquent\Builder $query, string $table, string $index): Illuminate\Database\Eloquent\Builder</code></p>
<p>Force use of specific index
- <code>addQueryHint(Illuminate\Database\Eloquent\Builder $query, string $hint): Illuminate\Database\Eloquent\Builder</code></p>
<p>Add query hints</p>
<hr />
<h3 id="screenshotauthservice">ScreenshotAuthService<a class="headerlink" href="#screenshotauthservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>getAuthCookies(): array</code></li>
</ul>
<p>Get authentication cookies for screenshot service
- <code>authenticateViaHttp(string $email, string $password): ?array</code></p>
<p>Authenticate via HTTP request (for testing)</p>
<hr />
<h3 id="screenshotservice">ScreenshotService<a class="headerlink" href="#screenshotservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>capture(string $urlOrRoute, array $options = []): string</code></li>
</ul>
<p>Capture a screenshot of a given URL or route
- <code>captureSync(string $url, string $savePath, array $options = []): string</code></p>
<p>Capture screenshot synchronously
- <code>captureBatch(array $routes, array $options = []): array</code></p>
<p>Capture multiple screenshots in batch
- <code>getLatest(string $route): ?string</code></p>
<p>Get the latest screenshot for a route
- <code>cleanup(int $daysToKeep = 7): int</code></p>
<p>Clean up old screenshots</p>
<hr />
<h3 id="serviceservice">ServiceService<a class="headerlink" href="#serviceservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>getServicesList(int $companyId, ?int $branchId = null): Illuminate\Support\Collection</code></li>
</ul>
<p>Get services list with caching
- <code>getServicesByCategory(int $companyId, string $category): Illuminate\Support\Collection</code></p>
<p>Get services by category
- <code>getOnlineBookableServices(int $companyId, ?int $branchId = null): Illuminate\Support\Collection</code></p>
<p>Get online bookable services
- <code>getService(int $serviceId): ?App\Models\Service</code></p>
<p>Get service by ID with caching
- <code>create(array $data): App\Models\Service</code></p>
<p>Create new service
- <code>update(int $serviceId, array $data): bool</code></p>
<p>Update service
- <code>delete(int $serviceId): bool</code></p>
<p>Delete service
- <code>getServicesGroupedByCategory(int $companyId, ?int $branchId = null): array</code></p>
<p>Get services grouped by category
- <code>getServiceStatistics(int $serviceId): array</code></p>
<p>Get service statistics</p>
<hr />
<h3 id="smarteventtypenameparser">SmartEventTypeNameParser<a class="headerlink" href="#smarteventtypenameparser" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>extractCleanServiceName(string $eventTypeName): string</code></li>
</ul>
<p>Extrahiere einen sauberen Service-Namen aus Marketing-Text
- <code>generateNameFormats(App\Models\Branch $branch, string $serviceName): array</code></p>
<p>Generiere verschiedene Namensformate für den Import
- <code>analyzeEventTypesForImport(array $eventTypes, App\Models\Branch $targetBranch): array</code></p>
<p>Analysiere Event-Types für Import mit intelligenter Namensgebung</p>
<hr />
<h3 id="smartmigrationservice">SmartMigrationService<a class="headerlink" href="#smartmigrationservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>analyzeMigration(string $migrationPath): array</code></li>
</ul>
<p>Analyze migration impact before execution
- <code>executeSafeMigration(string $migrationClass, array $options = []): bool</code></p>
<p>Execute migration with zero downtime strategies
- <code>performOnlineSchemaChange(string $table, callable $schemaChange): bool</code></p>
<p>Perform online schema change for large tables</p>
<hr />
<h3 id="staffservice">StaffService<a class="headerlink" href="#staffservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>getSchedule(int $staffId): array</code></li>
</ul>
<p>Get staff schedules with caching
- <code>getWeeklySchedule(int $staffId, ?Carbon\Carbon $weekStart = null): array</code></p>
<p>Get weekly schedule for staff
- <code>updateWorkingHours(int $staffId, array $workingHours): bool</code></p>
<p>Update staff working hours
- <code>getCompanyStaff(int $companyId): Illuminate\Support\Collection</code></p>
<p>Get all staff members for a company
- <code>getAvailableStaff(int $serviceId, int $branchId, Carbon\Carbon $date): Illuminate\Support\Collection</code></p>
<p>Get available staff for a specific service and branch</p>
<hr />
<h3 id="taxservice">TaxService<a class="headerlink" href="#taxservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>getDeterminedTaxRate(App\Models\Company $company, ?string $taxType = "standard"): array</code></li>
</ul>
<p>Ermittelt den anzuwendenden Steuersatz basierend auf Unternehmenskonfiguration
- <code>getOrCreateTaxRate(App\Models\Company $company, string $name, float $rate)</code></p>
<p>Erstellt oder holt einen Steuersatz
- <code>checkSmallBusinessThreshold(App\Models\Company $company): array</code></p>
<p>Überprüft und aktualisiert Kleinunternehmer-Status
- <code>validateVatId(string $vatId, string $countryCode = "DE"): array</code></p>
<p>Validiert eine USt-ID über VIES
- <code>shouldApplyReverseCharge(App\Models\Company $company, ?string $customerVatId, string $customerCountry): bool</code></p>
<p>Prüft ob Reverse-Charge anzuwenden ist
- <code>generateTaxNote(App\Models\Company $company, App\Models\Invoice $invoice): ?string</code></p>
<p>Generiert Steuerhinweis für Rechnung
- <code>calculateInvoiceTaxes(App\Models\Invoice $invoice): array</code></p>
<p>Berechnet Steuern für eine Rechnung
- <code>syncStripeEUtaxRate(App\Models\Company $company, float $rate, string $name): ?string</code></p>
<p>Erstellt Stripe Tax Rate</p>
<hr />
<h3 id="tutorialservice">TutorialService<a class="headerlink" href="#tutorialservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>initializeDefaultTutorials(): void</code></li>
</ul>
<p>Initialize default tutorials
- <code>getTutorialsForCurrentPage(string $currentRoute, App\Models\User $user): Illuminate\Support\Collection</code></p>
<p>Get tutorials for current page
- <code>markAsViewed(App\Models\User $user, int $tutorialId): void</code></p>
<p>Mark tutorial as viewed
- <code>markAsCompleted(App\Models\User $user, int $tutorialId): void</code></p>
<p>Mark tutorial as completed
- <code>getUserProgress(App\Models\User $user): array</code></p>
<p>Get user's tutorial progress summary
- <code>resetProgress(App\Models\User $user): void</code></p>
<p>Reset user's tutorial progress
- <code>getNextTutorial(App\Models\User $user, string $currentRoute): ?object</code></p>
<p>Get next unviewed tutorial for user</p>
<hr />
<h3 id="validationservice">ValidationService<a class="headerlink" href="#validationservice" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>validateBranch(App\Models\Branch $branch): array</code></li>
</ul>
<hr />
<h3 id="webhookprocessor">WebhookProcessor<a class="headerlink" href="#webhookprocessor" title="Permanent link">&para;</a></h3>
<p><strong>Public Methods</strong>:</p>
<ul>
<li><code>process(string $provider, array $payload, array $headers = [], ?string $correlationId = null): array</code></li>
</ul>
<p>Process an incoming webhook request
- <code>retry(int $webhookEventId): array</code></p>
<p>Retry a failed webhook</p>
<hr />









  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Zurück zum Seitenanfang
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2024-2025 <a href="https://askproai.de" target="_blank" rel="noopener">AskProAI</a> - AI-Powered Appointment Booking Platform
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/askproai" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/askproai" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.prune", "navigation.top", "navigation.footer", "toc.follow", "toc.integrate", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.code.annotate", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "In Zwischenablage kopiert", "clipboard.copy": "In Zwischenablage kopieren", "search.result.more.one": "1 weiteres Suchergebnis auf dieser Seite", "search.result.more.other": "# weitere Suchergebnisse auf dieser Seite", "search.result.none": "Keine Suchergebnisse", "search.result.one": "1 Suchergebnis", "search.result.other": "# Suchergebnisse", "search.result.placeholder": "Suchbegriff eingeben", "search.result.term.missing": "Es fehlt", "select.version": "Version ausw\u00e4hlen"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>