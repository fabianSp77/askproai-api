<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://api.askproai.de/mkdocs/DEPLOYMENT_GUIDE/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>AskProAI Deployment Guide - AskProAI Dokumentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "AskProAI Deployment Guide";
        var mkdocs_page_input_path = "DEPLOYMENT_GUIDE.md";
        var mkdocs_page_url = "/mkdocs/DEPLOYMENT_GUIDE/";
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> AskProAI Dokumentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Start</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Hauptdokumentation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../CLAUDE/">Projekt Übersicht</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../CLAUDE_QUICK_REFERENCE/">Quick Reference</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../CLAUDE_CONTEXT_SUMMARY/">Context Summary</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Power User</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../TOP_10_COMMANDS/">Top 10 Commands</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../CLAUDE_BEFEHLE_FUER_DICH/">Claude Befehle für dich</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../MY_COMMANDS/">Meine Commands</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Best Practices 2025</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../BEST_PRACTICES_IMPLEMENTATION/">Implementation Guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../DEVELOPMENT_PROCESS_2025/">Development Process</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../CLAUDE_DOCUMENTATION_GAPS_ANALYSIS.md">Documentation Gaps</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Schnellstart</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../5-MINUTEN_ONBOARDING_PLAYBOOK/">5-Minuten Onboarding</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Architektur</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../architecture/overview/">Übersicht</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../architecture/services/">Services</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../architecture/system-design/">System Design</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../architecture/mcp-architecture/">MCP Architecture</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../architecture/database-schema/">Database Schema</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../architecture/security/">Security</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../architecture/performance/">Performance</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="../api/overview.md">Übersicht</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../api/authentication/">Authentication</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../api/endpoints.md">Endpoints</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../api/webhooks/">Webhooks</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Features</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../features/appointment-booking/">Appointment Booking</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../features/call-management.md">Call Management</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../features/customer-portal.md">Customer Portal</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../features/multi-tenancy/">Multi-Tenancy</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Development</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="../development/setup.md">Setup</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../development/testing.md">Testing</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../development/code-standards.md">Code Standards</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Deployment</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="../deployment/overview.md">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../deployment/production.md">Production</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../deployment/environment-variables.md">Environment Variables</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Betrieb</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../CUSTOMER_SUCCESS_RUNBOOK/">Customer Success</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../EMERGENCY_RESPONSE_PLAYBOOK/">Emergency Response</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ERROR_PATTERNS/">Error Patterns</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../TROUBLESHOOTING_DECISION_TREE/">Troubleshooting</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../DEPLOYMENT_CHECKLIST/">Deployment Checklist</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Monitoring</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../KPI_DASHBOARD_TEMPLATE/">KPI Dashboard</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../INTEGRATION_HEALTH_MONITOR/">Health Monitor</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../PHONE_TO_APPOINTMENT_FLOW/">Phone to Appointment Flow</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">AskProAI Dokumentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>AskProAI Deployment Guide</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="askproai-deployment-guide">AskProAI Deployment Guide</h1>
<p><strong>Version</strong>: 1.0<br />
<strong>Date</strong>: 2025-06-18<br />
<strong>Status</strong>: Production Ready</p>
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li><a href="#overview">Overview</a></li>
<li><a href="#pre-deployment-checklist">Pre-Deployment Checklist</a></li>
<li><a href="#deployment-process">Deployment Process</a></li>
<li><a href="#rollback-procedures">Rollback Procedures</a></li>
<li><a href="#monitoring--verification">Monitoring &amp; Verification</a></li>
<li><a href="#backup--recovery">Backup &amp; Recovery</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
<li><a href="#emergency-contacts">Emergency Contacts</a></li>
</ol>
<h2 id="overview">Overview</h2>
<p>This guide provides step-by-step instructions for deploying AskProAI to production. The deployment process is designed to be zero-downtime with automatic rollback capabilities.</p>
<h3 id="key-features">Key Features</h3>
<ul>
<li><strong>Zero-downtime deployment</strong> using maintenance mode</li>
<li><strong>Automatic health checks</strong> after deployment</li>
<li><strong>Rollback capability</strong> with automated backup</li>
<li><strong>Comprehensive monitoring</strong> during and after deployment</li>
<li><strong>Automated backup system</strong> with retention policies</li>
</ul>
<h2 id="pre-deployment-checklist">Pre-Deployment Checklist</h2>
<h3 id="1-run-pre-deployment-check-script">1. Run Pre-Deployment Check Script</h3>
<pre><code class="language-bash">cd /var/www/api-gateway
./deploy/pre-deploy-check.sh
</code></pre>
<p>This script verifies:
- ✅ Environment requirements (PHP, Node, Redis, MySQL)
- ✅ Application configuration
- ✅ Database connectivity and migrations
- ✅ External service availability
- ✅ File permissions
- ✅ Security settings</p>
<h3 id="2-manual-verifications">2. Manual Verifications</h3>
<ul>
<li>[ ] Recent backup exists (check <code>/var/backups/askproai/</code>)</li>
<li>[ ] Team is notified of deployment window</li>
<li>[ ] No critical alerts in monitoring</li>
<li>[ ] Recent commits are tested in staging</li>
<li>[ ] Database migrations reviewed</li>
<li>[ ] Rollback plan communicated</li>
</ul>
<h3 id="3-environment-variables">3. Environment Variables</h3>
<p>Ensure these are set in <code>.env.production</code>:</p>
<pre><code class="language-env">APP_ENV=production
APP_DEBUG=false
APP_URL=https://api.askproai.de

# Database
DB_CONNECTION=mysql
DB_HOST=localhost
DB_DATABASE=askproai
DB_USERNAME=askproai_user
DB_PASSWORD=&lt;secure-password&gt;

# Redis
REDIS_HOST=127.0.0.1
REDIS_PASSWORD=&lt;redis-password&gt;

# Cal.com Integration
DEFAULT_CALCOM_API_KEY=&lt;api-key&gt;
DEFAULT_CALCOM_TEAM_SLUG=&lt;team-slug&gt;

# Retell.ai Integration
DEFAULT_RETELL_API_KEY=&lt;api-key&gt;
DEFAULT_RETELL_AGENT_ID=&lt;agent-id&gt;

# Queue Configuration
QUEUE_CONNECTION=redis
HORIZON_PREFIX=horizon:askproai
</code></pre>
<h2 id="deployment-process">Deployment Process</h2>
<h3 id="step-1-connect-to-production-server">Step 1: Connect to Production Server</h3>
<pre><code class="language-bash">ssh deploy@production-server
cd /var/www/api-gateway
</code></pre>
<h3 id="step-2-run-deployment-script">Step 2: Run Deployment Script</h3>
<pre><code class="language-bash">./deploy/production-deploy.sh
</code></pre>
<p>The script automatically:
1. Checks disk space and services
2. Creates backup
3. Enables maintenance mode
4. Pulls latest code
5. Installs dependencies
6. Runs migrations
7. Optimizes application
8. Restarts services
9. Runs health checks
10. Disables maintenance mode
11. Monitors for 5 minutes</p>
<h3 id="step-3-monitor-deployment">Step 3: Monitor Deployment</h3>
<p>Watch the deployment output. Key indicators:
- <code>[✓] Health check passed</code>
- <code>[✓] Cal.com integration healthy</code>
- <code>[✓] Queue workers running</code>
- <code>[✓] Cache warmed up</code></p>
<h3 id="manual-deployment-if-automated-fails">Manual Deployment (If Automated Fails)</h3>
<pre><code class="language-bash"># 1. Enable maintenance mode
php artisan down

# 2. Pull latest code
git pull origin main

# 3. Install dependencies
composer install --no-dev --optimize-autoloader
npm ci --production

# 4. Run migrations
php artisan migrate --force

# 5. Clear and optimize caches
php artisan optimize:clear
php artisan optimize

# 6. Restart queue workers
php artisan horizon:terminate
sleep 5
php artisan horizon

# 7. Disable maintenance mode
php artisan up
</code></pre>
<h2 id="rollback-procedures">Rollback Procedures</h2>
<h3 id="automatic-rollback">Automatic Rollback</h3>
<p>The deployment script automatically rolls back if:
- Migration fails
- Health check fails after deployment
- Critical error during deployment</p>
<h3 id="manual-rollback">Manual Rollback</h3>
<pre><code class="language-bash"># Quick rollback to latest backup
./deploy/rollback.sh

# Rollback to specific backup
./deploy/rollback.sh /var/backups/askproai/backup-20250618-120000.tar.gz
</code></pre>
<h3 id="rollback-steps">Rollback Steps</h3>
<ol>
<li><strong>Immediate Actions</strong>
   ```bash
   # Enable maintenance mode
   php artisan down</li>
</ol>
<p># Stop services
   php artisan horizon:terminate
   ```</p>
<ol>
<li>
<p><strong>Restore from Backup</strong>
   <code>bash
   # The rollback script handles this automatically
   ./deploy/rollback.sh</code></p>
</li>
<li>
<p><strong>Verify Rollback</strong>
   ```bash
   # Check application version
   git log -1 --oneline</p>
</li>
</ol>
<p># Run health check
   curl http://localhost/api/health
   ```</p>
<h2 id="monitoring-verification">Monitoring &amp; Verification</h2>
<h3 id="health-check-endpoints">Health Check Endpoints</h3>
<ol>
<li><strong>Main Health Check</strong>
   <code>bash
   curl https://api.askproai.de/api/health</code></li>
</ol>
<p>Expected response:
   <code>json
   {
     "status": "healthy",
     "checks": {
       "database": {"status": "healthy"},
       "cache": {"status": "healthy"},
       "queue": {"status": "healthy"}
     }
   }</code></p>
<ol>
<li>
<p><strong>Cal.com Integration Health</strong>
   <code>bash
   curl https://api.askproai.de/api/health/calcom</code></p>
</li>
<li>
<p><strong>Metrics Endpoint</strong>
   <code>bash
   curl https://api.askproai.de/api/metrics</code></p>
</li>
</ol>
<h3 id="post-deployment-verification">Post-Deployment Verification</h3>
<ol>
<li><strong>Test Critical Flows</strong></li>
<li>Make test phone call</li>
<li>Verify appointment creation</li>
<li>Check webhook processing</li>
<li>
<p>Confirm email delivery</p>
</li>
<li>
<p><strong>Monitor Logs</strong>
   ```bash
   # Application logs
   tail -f storage/logs/laravel.log</p>
</li>
</ol>
<p># Queue logs
   php artisan horizon:status</p>
<p># Nginx logs
   tail -f /var/log/nginx/access.log
   ```</p>
<ol>
<li><strong>Check Metrics</strong></li>
<li>Response times &lt; 200ms</li>
<li>Error rate &lt; 1%</li>
<li>Queue size &lt; 100</li>
<li>Memory usage stable</li>
</ol>
<h2 id="backup-recovery">Backup &amp; Recovery</h2>
<h3 id="automated-backups">Automated Backups</h3>
<p>Backups run automatically via cron:
- <strong>Daily</strong>: 2:00 AM
- <strong>Weekly</strong>: Sunday 3:00 AM
- <strong>Monthly</strong>: 1st day 4:00 AM</p>
<h3 id="manual-backup">Manual Backup</h3>
<pre><code class="language-bash">./deploy/backup-automation.sh daily
</code></pre>
<h3 id="backup-contents">Backup Contents</h3>
<ul>
<li>Database dump (compressed)</li>
<li>Application files (excluding vendor/node_modules)</li>
<li>Environment configuration</li>
<li>Backup manifest with checksums</li>
</ul>
<h3 id="recovery-process">Recovery Process</h3>
<ol>
<li>
<p><strong>List Available Backups</strong>
   <code>bash
   ls -la /var/backups/askproai/</code></p>
</li>
<li>
<p><strong>Verify Backup Integrity</strong>
   <code>bash
   gunzip -t /var/backups/askproai/db-daily-*.sql.gz
   tar -tzf /var/backups/askproai/app-daily-*.tar.gz</code></p>
</li>
<li>
<p><strong>Restore Database</strong>
   <code>bash
   gunzip &lt; backup.sql.gz | mysql -u root -p askproai</code></p>
</li>
<li>
<p><strong>Restore Application</strong>
   <code>bash
   cd /
   tar -xzf /var/backups/askproai/app-daily-*.tar.gz</code></p>
</li>
</ol>
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="common-issues">Common Issues</h3>
<ol>
<li><strong>Migration Fails</strong>
   ```bash
   # Check migration status
   php artisan migrate:status</li>
</ol>
<p># Rollback last batch
   php artisan migrate:rollback
   ```</p>
<ol>
<li><strong>Queue Workers Not Starting</strong>
   ```bash
   # Check Horizon status
   php artisan horizon:status</li>
</ol>
<p># Clear failed jobs
   php artisan queue:flush</p>
<p># Restart manually
   php artisan horizon
   ```</p>
<ol>
<li><strong>Cache Issues</strong>
   ```bash
   # Clear all caches
   php artisan optimize:clear</li>
</ol>
<p># Rebuild caches
   php artisan optimize
   ```</p>
<ol>
<li><strong>Permission Issues</strong>
   <code>bash
   # Fix permissions
   chown -R deploy:www-data /var/www/api-gateway
   find storage -type d -exec chmod 775 {} \;
   find storage -type f -exec chmod 664 {} \;</code></li>
</ol>
<h3 id="debug-mode">Debug Mode</h3>
<p>For emergency debugging:</p>
<pre><code class="language-bash"># Temporarily enable debug mode
APP_DEBUG=true php artisan serve
</code></pre>
<p><strong>Warning</strong>: Never leave debug mode enabled in production!</p>
<h3 id="log-locations">Log Locations</h3>
<ul>
<li>Application: <code>/var/www/api-gateway/storage/logs/</code></li>
<li>Nginx: <code>/var/log/nginx/</code></li>
<li>PHP-FPM: <code>/var/log/php8.2-fpm.log</code></li>
<li>MySQL: <code>/var/log/mysql/error.log</code></li>
<li>Redis: <code>/var/log/redis/redis-server.log</code></li>
</ul>
<h2 id="emergency-contacts">Emergency Contacts</h2>
<h3 id="escalation-path">Escalation Path</h3>
<ol>
<li><strong>Level 1 - DevOps Team</strong></li>
<li>Primary: [DevOps Lead]</li>
<li>Secondary: [DevOps Engineer]</li>
<li>
<p>Response Time: 15 minutes</p>
</li>
<li>
<p><strong>Level 2 - Development Team</strong></p>
</li>
<li>Primary: [Tech Lead]</li>
<li>Secondary: [Senior Developer]</li>
<li>
<p>Response Time: 30 minutes</p>
</li>
<li>
<p><strong>Level 3 - Management</strong></p>
</li>
<li>CTO: [CTO Contact]</li>
<li>Response Time: 1 hour</li>
</ol>
<h3 id="external-services">External Services</h3>
<ul>
<li><strong>Cal.com Support</strong>: support@cal.com</li>
<li><strong>Retell.ai Support</strong>: support@retellai.com</li>
<li><strong>Hosting Provider</strong>: [Provider emergency line]</li>
</ul>
<h2 id="best-practices">Best Practices</h2>
<ol>
<li><strong>Always deploy during low-traffic periods</strong></li>
<li><strong>Test deployment in staging first</strong></li>
<li><strong>Keep deployment windows under 30 minutes</strong></li>
<li><strong>Monitor for at least 1 hour post-deployment</strong></li>
<li><strong>Document any issues or changes</strong></li>
<li><strong>Update this guide with lessons learned</strong></li>
</ol>
<h2 id="deployment-schedule">Deployment Schedule</h2>
<p>Recommended deployment windows:
- <strong>Regular Updates</strong>: Tuesday/Thursday 2:00-4:00 AM CET
- <strong>Emergency Fixes</strong>: As needed with approval
- <strong>Major Releases</strong>: Saturday 2:00-6:00 AM CET</p>
<hr />
<p><strong>Last Updated</strong>: 2025-06-18<br />
<strong>Maintained by</strong>: DevOps Team<br />
<strong>Review Cycle</strong>: Monthly</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
