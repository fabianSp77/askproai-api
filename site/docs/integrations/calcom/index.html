<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://api.askproai.de/mkdocs/docs/integrations/calcom/" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Cal.com Integration - AskProAI Dokumentation</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Cal.com Integration";
        var mkdocs_page_input_path = "docs/integrations/calcom.md";
        var mkdocs_page_url = "/mkdocs/docs/integrations/calcom/";
      </script>
    
    <script src="../../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> AskProAI Dokumentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Start</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Hauptdokumentation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../CLAUDE/">Projekt Übersicht</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../CLAUDE_QUICK_REFERENCE/">Quick Reference</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../CLAUDE_CONTEXT_SUMMARY/">Context Summary</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Power User</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../TOP_10_COMMANDS/">Top 10 Commands</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../CLAUDE_BEFEHLE_FUER_DICH/">Claude Befehle für dich</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../MY_COMMANDS/">Meine Commands</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Best Practices 2025</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../BEST_PRACTICES_IMPLEMENTATION/">Implementation Guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../DEVELOPMENT_PROCESS_2025/">Development Process</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../CLAUDE_DOCUMENTATION_GAPS_ANALYSIS.md">Documentation Gaps</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Schnellstart</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../5-MINUTEN_ONBOARDING_PLAYBOOK/">5-Minuten Onboarding</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Architektur</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../architecture/overview/">Übersicht</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../architecture/services/">Services</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../architecture/system-design/">System Design</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../architecture/mcp-architecture/">MCP Architecture</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../architecture/database-schema/">Database Schema</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../architecture/security/">Security</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../architecture/performance/">Performance</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="../../../api/overview.md">Übersicht</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../api/authentication/">Authentication</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../api/endpoints.md">Endpoints</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../api/webhooks/">Webhooks</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Features</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../features/appointment-booking/">Appointment Booking</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../features/call-management.md">Call Management</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../features/customer-portal.md">Customer Portal</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../features/multi-tenancy/">Multi-Tenancy</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Development</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="../../../development/setup.md">Setup</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../development/testing.md">Testing</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../development/code-standards.md">Code Standards</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Deployment</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="../../../deployment/overview.md">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../deployment/production.md">Production</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../deployment/environment-variables.md">Environment Variables</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Betrieb</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../CUSTOMER_SUCCESS_RUNBOOK/">Customer Success</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../EMERGENCY_RESPONSE_PLAYBOOK/">Emergency Response</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../ERROR_PATTERNS/">Error Patterns</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../TROUBLESHOOTING_DECISION_TREE/">Troubleshooting</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../DEPLOYMENT_CHECKLIST/">Deployment Checklist</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Monitoring</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../KPI_DASHBOARD_TEMPLATE/">KPI Dashboard</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../INTEGRATION_HEALTH_MONITOR/">Health Monitor</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../PHONE_TO_APPOINTMENT_FLOW/">Phone to Appointment Flow</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">AskProAI Dokumentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>Cal.com Integration</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="calcom-integration">Cal.com Integration</h1>
<h2 id="overview">Overview</h2>
<p>Cal.com integration enables AskProAI to check availability and book appointments in real-time. The system supports both Cal.com v1 and v2 APIs, with v2 being the recommended version for new implementations.</p>
<h2 id="configuration">Configuration</h2>
<h3 id="environment-variables">Environment Variables</h3>
<pre><code class="language-bash"># Cal.com API Configuration
DEFAULT_CALCOM_API_KEY=cal_live_xxxxxxxxxxxxxx
DEFAULT_CALCOM_TEAM_SLUG=your-team-slug
CALCOM_API_BASE_URL=https://api.cal.com/v2
CALCOM_WEBHOOK_SECRET=your-webhook-secret
</code></pre>
<h3 id="company-level-configuration">Company-Level Configuration</h3>
<pre><code class="language-php">// Set Cal.com credentials for a company
$company-&gt;update([
    'calcom_api_key' =&gt; 'cal_live_xxxxxxxxxxxxxx',
    'calcom_team_id' =&gt; 12345,
    'calcom_organization_id' =&gt; 67890
]);
</code></pre>
<h2 id="event-types">Event Types</h2>
<h3 id="syncing-event-types">Syncing Event Types</h3>
<pre><code class="language-bash"># Sync all event types from Cal.com
php artisan calcom:sync-event-types --company=1

# Sync specific branch
php artisan calcom:sync-event-types --branch=5
</code></pre>
<h3 id="event-type-mapping">Event Type Mapping</h3>
<pre><code class="language-php">// Map Cal.com event type to branch
$branch-&gt;calcom_event_types()-&gt;create([
    'calcom_event_type_id' =&gt; 2026361,
    'title' =&gt; '30 Min Consultation',
    'slug' =&gt; '30min-consultation',
    'description' =&gt; 'Initial consultation',
    'length' =&gt; 30,
    'locations' =&gt; ['inPerson'],
    'is_active' =&gt; true
]);
</code></pre>
<h2 id="booking-flow">Booking Flow</h2>
<h3 id="1-check-availability">1. Check Availability</h3>
<pre><code class="language-php">use App\Services\CalcomV2Service;

$calcomService = app(CalcomV2Service::class);

// Get available slots
$slots = $calcomService-&gt;getAvailability(
    eventTypeId: 2026361,
    startDate: '2025-06-25',
    endDate: '2025-06-25'
);
</code></pre>
<h3 id="2-create-booking">2. Create Booking</h3>
<pre><code class="language-php">// Book appointment
$booking = $calcomService-&gt;createBooking([
    'eventTypeId' =&gt; 2026361,
    'start' =&gt; '2025-06-25T10:00:00Z',
    'responses' =&gt; [
        'name' =&gt; 'John Doe',
        'email' =&gt; 'john@example.com',
        'phone' =&gt; '+49 30 123456',
        'notes' =&gt; 'First time patient'
    ],
    'metadata' =&gt; [
        'askproai_appointment_id' =&gt; $appointment-&gt;id,
        'branch_id' =&gt; $branch-&gt;id
    ]
]);
</code></pre>
<h3 id="3-handle-response">3. Handle Response</h3>
<pre><code class="language-php">// Store Cal.com booking reference
$appointment-&gt;update([
    'calcom_booking_id' =&gt; $booking['id'],
    'calcom_booking_uid' =&gt; $booking['uid'],
    'calcom_reschedule_uid' =&gt; $booking['rescheduleUid'],
    'calcom_cancel_uid' =&gt; $booking['cancelUid']
]);
</code></pre>
<h2 id="webhook-integration">Webhook Integration</h2>
<h3 id="webhook-endpoints">Webhook Endpoints</h3>
<pre><code class="language-php">// routes/api.php
Route::post('/webhooks/calcom', [CalcomWebhookController::class, 'handle'])
    -&gt;middleware(VerifyCalcomSignature::class);
</code></pre>
<h3 id="webhook-events">Webhook Events</h3>
<pre><code class="language-php">// Handle Cal.com webhook events
class CalcomWebhookController
{
    public function handle(Request $request)
    {
        $event = $request-&gt;input('triggerEvent');

        switch ($event) {
            case 'BOOKING_CREATED':
                $this-&gt;handleBookingCreated($request-&gt;payload);
                break;

            case 'BOOKING_RESCHEDULED':
                $this-&gt;handleBookingRescheduled($request-&gt;payload);
                break;

            case 'BOOKING_CANCELLED':
                $this-&gt;handleBookingCancelled($request-&gt;payload);
                break;
        }
    }
}
</code></pre>
<h3 id="webhook-security">Webhook Security</h3>
<pre><code class="language-php">// Verify Cal.com webhook signature
class VerifyCalcomSignature
{
    public function handle($request, $next)
    {
        $signature = $request-&gt;header('X-Cal-Signature-256');
        $payload = $request-&gt;getContent();
        $secret = config('services.calcom.webhook_secret');

        $expected = hash_hmac('sha256', $payload, $secret);

        if (!hash_equals($expected, $signature)) {
            abort(401, 'Invalid signature');
        }

        return $next($request);
    }
}
</code></pre>
<h2 id="api-v2-migration">API v2 Migration</h2>
<h3 id="service-comparison">Service Comparison</h3>
<pre><code class="language-php">// Legacy v1 Service
$calcomV1 = app(CalcomService::class);
$slots = $calcomV1-&gt;getAvailableSlots($eventTypeId, $date);

// New v2 Service (Recommended)
$calcomV2 = app(CalcomV2Service::class);
$slots = $calcomV2-&gt;getAvailability(
    eventTypeId: $eventTypeId,
    startDate: $date,
    endDate: $date
);
</code></pre>
<h3 id="v2-advantages">v2 Advantages</h3>
<ul>
<li>Better error handling</li>
<li>Improved performance</li>
<li>More detailed responses</li>
<li>Extended metadata support</li>
<li>Webhook reliability</li>
</ul>
<h2 id="advanced-features">Advanced Features</h2>
<h3 id="recurring-appointments">Recurring Appointments</h3>
<pre><code class="language-php">// Book recurring appointment
$booking = $calcomService-&gt;createRecurringBooking([
    'eventTypeId' =&gt; $eventTypeId,
    'recurringCount' =&gt; 4,
    'recurringInterval' =&gt; 'weekly',
    'start' =&gt; '2025-06-25T10:00:00Z',
    'responses' =&gt; $customerData
]);
</code></pre>
<h3 id="team-scheduling">Team Scheduling</h3>
<pre><code class="language-php">// Get team availability
$teamSlots = $calcomService-&gt;getTeamAvailability(
    teamId: $company-&gt;calcom_team_id,
    eventTypeId: $eventTypeId,
    date: '2025-06-25'
);
</code></pre>
<h3 id="custom-fields">Custom Fields</h3>
<pre><code class="language-php">// Event type with custom fields
$eventType = [
    'customInputs' =&gt; [
        [
            'label' =&gt; 'Insurance Provider',
            'type' =&gt; 'text',
            'required' =&gt; true,
            'placeholder' =&gt; 'e.g., AOK, TK'
        ]
    ]
];
</code></pre>
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="common-issues">Common Issues</h3>
<h4 id="event-type-not-found">"Event Type Not Found"</h4>
<pre><code class="language-bash"># Re-sync event types
php artisan calcom:sync-event-types --force

# Check event type status
php artisan tinker
&gt;&gt;&gt; CalcomEventType::where('calcom_event_type_id', 2026361)-&gt;first()
</code></pre>
<h4 id="no-available-slots">"No Available Slots"</h4>
<pre><code class="language-php">// Debug availability
$debug = $calcomService-&gt;debugAvailability($eventTypeId, $date);
Log::info('Availability debug:', $debug);
</code></pre>
<h4 id="booking-failed">"Booking Failed"</h4>
<pre><code class="language-php">// Check Cal.com API status
$health = $calcomService-&gt;checkHealth();
if (!$health['operational']) {
    // Fall back to manual booking
    $appointment-&gt;update(['requires_manual_booking' =&gt; true]);
}
</code></pre>
<h3 id="debug-mode">Debug Mode</h3>
<pre><code class="language-php">// Enable Cal.com debug logging
config(['services.calcom.debug' =&gt; true]);

// View debug logs
tail -f storage/logs/calcom.log
</code></pre>
<h2 id="performance-optimization">Performance Optimization</h2>
<h3 id="caching">Caching</h3>
<pre><code class="language-php">// Cache availability for 5 minutes
$slots = Cache::remember(
    &quot;calcom:availability:{$eventTypeId}:{$date}&quot;,
    300,
    fn() =&gt; $calcomService-&gt;getAvailability($eventTypeId, $date)
);
</code></pre>
<h3 id="batch-operations">Batch Operations</h3>
<pre><code class="language-php">// Sync multiple event types efficiently
$calcomService-&gt;batchSyncEventTypes($eventTypeIds);
</code></pre>
<h2 id="related-documentation">Related Documentation</h2>
<ul>
<li><a href="../api/webhooks.md">Webhook Configuration</a></li>
<li><a href="../../configuration/services/">Service Configuration</a></li>
<li><a href="../../migration/calcom-v2/">Cal.com v2 Migration</a></li>
</ul>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme_extra.js" defer></script>
    <script src="../../../js/theme.js" defer></script>
      <script src="../../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
