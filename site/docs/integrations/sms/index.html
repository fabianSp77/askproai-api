<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://api.askproai.de/mkdocs/docs/integrations/sms/" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>SMS Integration - AskProAI Dokumentation</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "SMS Integration";
        var mkdocs_page_input_path = "docs/integrations/sms.md";
        var mkdocs_page_url = "/mkdocs/docs/integrations/sms/";
      </script>
    
    <script src="../../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> AskProAI Dokumentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Start</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Hauptdokumentation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../CLAUDE/">Projekt Übersicht</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../CLAUDE_QUICK_REFERENCE/">Quick Reference</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../CLAUDE_CONTEXT_SUMMARY/">Context Summary</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Power User</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../TOP_10_COMMANDS/">Top 10 Commands</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../CLAUDE_BEFEHLE_FUER_DICH/">Claude Befehle für dich</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../MY_COMMANDS/">Meine Commands</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Best Practices 2025</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../BEST_PRACTICES_IMPLEMENTATION/">Implementation Guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../DEVELOPMENT_PROCESS_2025/">Development Process</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../CLAUDE_DOCUMENTATION_GAPS_ANALYSIS.md">Documentation Gaps</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Schnellstart</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../5-MINUTEN_ONBOARDING_PLAYBOOK/">5-Minuten Onboarding</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Architektur</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../architecture/overview/">Übersicht</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../architecture/services/">Services</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../architecture/system-design/">System Design</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../architecture/mcp-architecture/">MCP Architecture</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../architecture/database-schema/">Database Schema</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../architecture/security/">Security</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../architecture/performance/">Performance</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="../../../api/overview.md">Übersicht</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../api/authentication/">Authentication</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../api/endpoints.md">Endpoints</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../api/webhooks/">Webhooks</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Features</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../features/appointment-booking/">Appointment Booking</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../features/call-management.md">Call Management</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../features/customer-portal.md">Customer Portal</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../features/multi-tenancy/">Multi-Tenancy</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Development</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="../../../development/setup.md">Setup</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../development/testing.md">Testing</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../development/code-standards.md">Code Standards</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Deployment</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="../../../deployment/overview.md">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../deployment/production.md">Production</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../deployment/environment-variables.md">Environment Variables</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Betrieb</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../CUSTOMER_SUCCESS_RUNBOOK/">Customer Success</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../EMERGENCY_RESPONSE_PLAYBOOK/">Emergency Response</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../ERROR_PATTERNS/">Error Patterns</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../TROUBLESHOOTING_DECISION_TREE/">Troubleshooting</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../DEPLOYMENT_CHECKLIST/">Deployment Checklist</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Monitoring</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../KPI_DASHBOARD_TEMPLATE/">KPI Dashboard</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../INTEGRATION_HEALTH_MONITOR/">Health Monitor</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../PHONE_TO_APPOINTMENT_FLOW/">Phone to Appointment Flow</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">AskProAI Dokumentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>SMS Integration</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="sms-integration">SMS Integration</h1>
<h2 id="overview">Overview</h2>
<p>SMS integration enables AskProAI to send appointment confirmations, reminders, and notifications via text message. The system supports multiple SMS providers with automatic failover.</p>
<h2 id="supported-providers">Supported Providers</h2>
<h3 id="primary-providers">Primary Providers</h3>
<ul>
<li><strong>Twilio</strong> - Global coverage, reliable delivery</li>
<li><strong>Vonage (Nexmo)</strong> - European focus, good pricing</li>
<li><strong>MessageBird</strong> - EU-based, GDPR compliant</li>
<li><strong>Plivo</strong> - Cost-effective, good API</li>
</ul>
<h3 id="configuration">Configuration</h3>
<pre><code class="language-bash"># SMS Provider Configuration
SMS_PROVIDER=twilio
SMS_FALLBACK_PROVIDER=messagebird

***REMOVED***
TWILIO_SID=ACxxxxxxxxxxxxxx
TWILIO_TOKEN=xxxxxxxxxxxxxx
TWILIO_FROM=+4930xxxxxxx

# MessageBird (Fallback)
MESSAGEBIRD_ACCESS_KEY=xxxxxxxxxxxxxx
MESSAGEBIRD_ORIGINATOR=AskProAI
</code></pre>
<h2 id="sms-service-implementation">SMS Service Implementation</h2>
<h3 id="service-interface">Service Interface</h3>
<pre><code class="language-php">namespace App\Services\SMS;

interface SMSProviderInterface
{
    public function send(string $to, string $message): SMSResponse;
    public function sendBulk(array $recipients, string $message): array;
    public function getBalance(): float;
    public function checkStatus(string $messageId): string;
}
</code></pre>
<h3 id="multi-provider-service">Multi-Provider Service</h3>
<pre><code class="language-php">namespace App\Services;

class SMSService
{
    private array $providers;
    private SMSProviderInterface $activeProvider;

    public function __construct()
    {
        $this-&gt;providers = [
            'twilio' =&gt; app(TwilioProvider::class),
            'messagebird' =&gt; app(MessageBirdProvider::class),
            'vonage' =&gt; app(VonageProvider::class),
        ];

        $this-&gt;activeProvider = $this-&gt;providers[config('sms.provider')];
    }

    public function send(string $to, string $message): bool
    {
        try {
            // Format phone number
            $to = $this-&gt;formatPhoneNumber($to);

            // Try primary provider
            $response = $this-&gt;activeProvider-&gt;send($to, $message);

            // Log success
            $this-&gt;logMessage($to, $message, $response);

            return true;

        } catch (\Exception $e) {
            // Try fallback provider
            return $this-&gt;sendWithFallback($to, $message);
        }
    }

    private function sendWithFallback(string $to, string $message): bool
    {
        $fallbackProvider = $this-&gt;providers[config('sms.fallback_provider')];

        try {
            $response = $fallbackProvider-&gt;send($to, $message);
            $this-&gt;logMessage($to, $message, $response, 'fallback');

            // Alert about primary provider failure
            $this-&gt;alertProviderFailure($this-&gt;activeProvider);

            return true;
        } catch (\Exception $e) {
            Log::error('SMS failed on all providers', [
                'to' =&gt; $to,
                'error' =&gt; $e-&gt;getMessage()
            ]);

            return false;
        }
    }
}
</code></pre>
<h2 id="provider-implementations">Provider Implementations</h2>
<h3 id="twilio-provider">Twilio Provider</h3>
<pre><code class="language-php">namespace App\Services\SMS\Providers;

use Twilio\Rest\Client;

class TwilioProvider implements SMSProviderInterface
{
    private Client $client;

    public function __construct()
    {
        $this-&gt;client = new Client(
            config('services.twilio.sid'),
            config('services.twilio.token')
        );
    }

    public function send(string $to, string $message): SMSResponse
    {
        $response = $this-&gt;client-&gt;messages-&gt;create($to, [
            'from' =&gt; config('services.twilio.from'),
            'body' =&gt; $message
        ]);

        return new SMSResponse([
            'id' =&gt; $response-&gt;sid,
            'status' =&gt; $response-&gt;status,
            'price' =&gt; $response-&gt;price,
            'provider' =&gt; 'twilio'
        ]);
    }

    public function getBalance(): float
    {
        $account = $this-&gt;client-&gt;api-&gt;v2010-&gt;accounts(config('services.twilio.sid'))-&gt;fetch();
        return (float) $account-&gt;balance;
    }
}
</code></pre>
<h3 id="messagebird-provider">MessageBird Provider</h3>
<pre><code class="language-php">namespace App\Services\SMS\Providers;

use MessageBird\Client;

class MessageBirdProvider implements SMSProviderInterface
{
    private Client $client;

    public function __construct()
    {
        $this-&gt;client = new Client(config('services.messagebird.access_key'));
    }

    public function send(string $to, string $message): SMSResponse
    {
        $sms = new \MessageBird\Objects\Message();
        $sms-&gt;originator = config('services.messagebird.originator');
        $sms-&gt;recipients = [$to];
        $sms-&gt;body = $message;

        $response = $this-&gt;client-&gt;messages-&gt;create($sms);

        return new SMSResponse([
            'id' =&gt; $response-&gt;id,
            'status' =&gt; $response-&gt;recipients-&gt;items[0]-&gt;status,
            'provider' =&gt; 'messagebird'
        ]);
    }
}
</code></pre>
<h2 id="message-templates">Message Templates</h2>
<h3 id="template-management">Template Management</h3>
<pre><code class="language-php">namespace App\Services\SMS;

class SMSTemplateService
{
    private array $templates = [
        'appointment_confirmation' =&gt; [
            'de' =&gt; 'Termin bestätigt: {date} um {time} bei {company}. Adresse: {address}',
            'en' =&gt; 'Appointment confirmed: {date} at {time} with {company}. Address: {address}'
        ],
        'appointment_reminder' =&gt; [
            'de' =&gt; 'Erinnerung: Ihr Termin bei {company} ist morgen um {time}',
            'en' =&gt; 'Reminder: Your appointment with {company} is tomorrow at {time}'
        ],
        'appointment_cancelled' =&gt; [
            'de' =&gt; 'Ihr Termin bei {company} am {date} wurde storniert',
            'en' =&gt; 'Your appointment with {company} on {date} has been cancelled'
        ]
    ];

    public function render(string $template, array $data, string $locale = 'de'): string
    {
        $text = $this-&gt;templates[$template][$locale] ?? $this-&gt;templates[$template]['de'];

        foreach ($data as $key =&gt; $value) {
            $text = str_replace('{' . $key . '}', $value, $text);
        }

        return $text;
    }
}
</code></pre>
<h3 id="using-templates">Using Templates</h3>
<pre><code class="language-php">// Send appointment confirmation
$template = app(SMSTemplateService::class);
$sms = app(SMSService::class);

$message = $template-&gt;render('appointment_confirmation', [
    'date' =&gt; $appointment-&gt;date-&gt;format('d.m.Y'),
    'time' =&gt; $appointment-&gt;time-&gt;format('H:i'),
    'company' =&gt; $appointment-&gt;branch-&gt;company-&gt;name,
    'address' =&gt; $appointment-&gt;branch-&gt;address
]);

$sms-&gt;send($appointment-&gt;customer-&gt;phone, $message);
</code></pre>
<h2 id="notification-jobs">Notification Jobs</h2>
<h3 id="appointment-confirmation-job">Appointment Confirmation Job</h3>
<pre><code class="language-php">namespace App\Jobs;

class SendSMSConfirmation extends Job
{
    use Dispatchable, InteractsWithQueue, Queueable;

    private Appointment $appointment;

    public function handle()
    {
        // Check if customer wants SMS
        if (!$this-&gt;appointment-&gt;customer-&gt;sms_notifications) {
            return;
        }

        $sms = app(SMSService::class);
        $template = app(SMSTemplateService::class);

        $message = $template-&gt;render('appointment_confirmation', [
            'date' =&gt; $this-&gt;appointment-&gt;date-&gt;format('d.m.Y'),
            'time' =&gt; $this-&gt;appointment-&gt;time-&gt;format('H:i'),
            'company' =&gt; $this-&gt;appointment-&gt;branch-&gt;company-&gt;name,
            'address' =&gt; $this-&gt;appointment-&gt;branch-&gt;full_address
        ]);

        $sent = $sms-&gt;send($this-&gt;appointment-&gt;customer-&gt;phone, $message);

        // Update appointment
        $this-&gt;appointment-&gt;update([
            'sms_confirmation_sent' =&gt; $sent,
            'sms_confirmation_sent_at' =&gt; now()
        ]);
    }
}
</code></pre>
<h3 id="reminder-scheduler">Reminder Scheduler</h3>
<pre><code class="language-php">namespace App\Console\Commands;

class ScheduleSMSReminders extends Command
{
    protected $signature = 'sms:schedule-reminders';

    public function handle()
    {
        // 24-hour reminders
        $tomorrow = now()-&gt;addDay();
        $appointments = Appointment::whereDate('date', $tomorrow-&gt;toDateString())
            -&gt;where('sms_reminder_sent', false)
            -&gt;get();

        foreach ($appointments as $appointment) {
            SendSMSReminder::dispatch($appointment, '24h');
        }

        // 1-hour reminders
        $inOneHour = now()-&gt;addHour();
        $appointments = Appointment::where('datetime', '&gt;=', $inOneHour)
            -&gt;where('datetime', '&lt;=', $inOneHour-&gt;copy()-&gt;addMinutes(15))
            -&gt;where('sms_1h_reminder_sent', false)
            -&gt;get();

        foreach ($appointments as $appointment) {
            SendSMSReminder::dispatch($appointment, '1h');
        }
    }
}
</code></pre>
<h2 id="phone-number-management">Phone Number Management</h2>
<h3 id="number-formatting">Number Formatting</h3>
<pre><code class="language-php">namespace App\Services\SMS;

use libphonenumber\PhoneNumberUtil;
use libphonenumber\PhoneNumberFormat;

class PhoneNumberFormatter
{
    private PhoneNumberUtil $phoneUtil;

    public function __construct()
    {
        $this-&gt;phoneUtil = PhoneNumberUtil::getInstance();
    }

    public function format(string $number, string $country = 'DE'): string
    {
        try {
            $phoneNumber = $this-&gt;phoneUtil-&gt;parse($number, $country);

            if (!$this-&gt;phoneUtil-&gt;isValidNumber($phoneNumber)) {
                throw new \Exception('Invalid phone number');
            }

            return $this-&gt;phoneUtil-&gt;format($phoneNumber, PhoneNumberFormat::E164);
        } catch (\Exception $e) {
            Log::warning('Phone number formatting failed', [
                'number' =&gt; $number,
                'error' =&gt; $e-&gt;getMessage()
            ]);

            // Fallback to basic formatting
            return $this-&gt;basicFormat($number);
        }
    }
}
</code></pre>
<h2 id="cost-tracking">Cost Tracking</h2>
<h3 id="sms-cost-calculator">SMS Cost Calculator</h3>
<pre><code class="language-php">namespace App\Services\SMS;

class SMSCostTracker
{
    private array $rates = [
        'DE' =&gt; 0.075,  // EUR per SMS
        'AT' =&gt; 0.080,
        'CH' =&gt; 0.085,
        'default' =&gt; 0.10
    ];

    public function trackMessage(string $to, string $provider, ?float $actualCost = null)
    {
        $country = $this-&gt;getCountryCode($to);
        $estimatedCost = $this-&gt;rates[$country] ?? $this-&gt;rates['default'];

        SMSLog::create([
            'to' =&gt; $to,
            'provider' =&gt; $provider,
            'estimated_cost' =&gt; $estimatedCost,
            'actual_cost' =&gt; $actualCost,
            'sent_at' =&gt; now()
        ]);
    }

    public function getMonthlyCost(Company $company): array
    {
        $logs = SMSLog::where('company_id', $company-&gt;id)
            -&gt;whereMonth('sent_at', now()-&gt;month)
            -&gt;get();

        return [
            'total_messages' =&gt; $logs-&gt;count(),
            'estimated_cost' =&gt; $logs-&gt;sum('estimated_cost'),
            'actual_cost' =&gt; $logs-&gt;sum('actual_cost'),
            'by_provider' =&gt; $logs-&gt;groupBy('provider')-&gt;map-&gt;count()
        ];
    }
}
</code></pre>
<h2 id="opt-out-management">Opt-Out Management</h2>
<h3 id="unsubscribe-handling">Unsubscribe Handling</h3>
<pre><code class="language-php">namespace App\Services\SMS;

class SMSOptOutService
{
    private array $optOutKeywords = [
        'STOP', 'STOPP', 'ABMELDEN', 'UNSUBSCRIBE', 'CANCEL'
    ];

    public function processIncomingSMS(string $from, string $message)
    {
        $message = strtoupper(trim($message));

        if (in_array($message, $this-&gt;optOutKeywords)) {
            $this-&gt;handleOptOut($from);
        }
    }

    private function handleOptOut(string $phoneNumber)
    {
        // Find customer
        $customer = Customer::where('phone', $phoneNumber)-&gt;first();

        if ($customer) {
            $customer-&gt;update(['sms_notifications' =&gt; false]);

            // Send confirmation
            app(SMSService::class)-&gt;send(
                $phoneNumber,
                'Sie wurden erfolgreich von SMS-Benachrichtigungen abgemeldet.'
            );

            // Log opt-out
            OptOutLog::create([
                'customer_id' =&gt; $customer-&gt;id,
                'channel' =&gt; 'sms',
                'opted_out_at' =&gt; now()
            ]);
        }
    }
}
</code></pre>
<h2 id="testing">Testing</h2>
<h3 id="sms-testing-service">SMS Testing Service</h3>
<pre><code class="language-php">namespace App\Services\SMS;

class SMSTestService
{
    public function sendTestSMS(string $to, string $provider = null)
    {
        $providers = $provider ? [$provider] : ['twilio', 'messagebird', 'vonage'];
        $results = [];

        foreach ($providers as $providerName) {
            try {
                $provider = app(&quot;sms.provider.{$providerName}&quot;);
                $response = $provider-&gt;send($to, &quot;Test SMS from AskProAI via {$providerName}&quot;);

                $results[$providerName] = [
                    'success' =&gt; true,
                    'message_id' =&gt; $response-&gt;id,
                    'cost' =&gt; $response-&gt;price
                ];
            } catch (\Exception $e) {
                $results[$providerName] = [
                    'success' =&gt; false,
                    'error' =&gt; $e-&gt;getMessage()
                ];
            }
        }

        return $results;
    }
}
</code></pre>
<h3 id="test-commands">Test Commands</h3>
<pre><code class="language-bash"># Test SMS sending
php artisan sms:test +49xxxxxxxxx --provider=twilio

# Check provider balance
php artisan sms:balance

# Verify phone number
php artisan sms:verify +49xxxxxxxxx
</code></pre>
<h2 id="monitoring-alerts">Monitoring &amp; Alerts</h2>
<h3 id="delivery-monitoring">Delivery Monitoring</h3>
<pre><code class="language-php">class SMSMonitor
{
    public function checkDeliveryRates()
    {
        $stats = SMSLog::where('created_at', '&gt;=', now()-&gt;subHour())
            -&gt;selectRaw('
                provider,
                COUNT(*) as total,
                SUM(CASE WHEN status = &quot;delivered&quot; THEN 1 ELSE 0 END) as delivered,
                SUM(CASE WHEN status = &quot;failed&quot; THEN 1 ELSE 0 END) as failed
            ')
            -&gt;groupBy('provider')
            -&gt;get();

        foreach ($stats as $stat) {
            $deliveryRate = $stat-&gt;delivered / $stat-&gt;total * 100;

            if ($deliveryRate &lt; 95) {
                $this-&gt;alertLowDeliveryRate($stat-&gt;provider, $deliveryRate);
            }
        }
    }
}
</code></pre>
<h2 id="related-documentation">Related Documentation</h2>
<ul>
<li><a href="../whatsapp/">WhatsApp Integration</a></li>
<li><a href="../email/">Email Integration</a></li>
<li><a href="../features/notifications.md">Notification System</a></li>
</ul>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme_extra.js" defer></script>
    <script src="../../../js/theme.js" defer></script>
      <script src="../../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
