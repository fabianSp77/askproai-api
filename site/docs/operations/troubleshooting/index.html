<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://api.askproai.de/mkdocs/docs/operations/troubleshooting/" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Troubleshooting Guide - AskProAI Dokumentation</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Troubleshooting Guide";
        var mkdocs_page_input_path = "docs/operations/troubleshooting.md";
        var mkdocs_page_url = "/mkdocs/docs/operations/troubleshooting/";
      </script>
    
    <script src="../../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> AskProAI Dokumentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Start</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Hauptdokumentation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../CLAUDE/">Projekt Übersicht</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../CLAUDE_QUICK_REFERENCE/">Quick Reference</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../CLAUDE_CONTEXT_SUMMARY/">Context Summary</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Power User</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../TOP_10_COMMANDS/">Top 10 Commands</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../CLAUDE_BEFEHLE_FUER_DICH/">Claude Befehle für dich</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../MY_COMMANDS/">Meine Commands</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Best Practices 2025</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../BEST_PRACTICES_IMPLEMENTATION/">Implementation Guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../DEVELOPMENT_PROCESS_2025/">Development Process</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../CLAUDE_DOCUMENTATION_GAPS_ANALYSIS.md">Documentation Gaps</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Schnellstart</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../5-MINUTEN_ONBOARDING_PLAYBOOK/">5-Minuten Onboarding</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Architektur</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../architecture/overview/">Übersicht</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../architecture/services/">Services</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../architecture/system-design/">System Design</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../architecture/mcp-architecture/">MCP Architecture</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../architecture/database-schema/">Database Schema</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../architecture/security/">Security</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../architecture/performance/">Performance</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="../../../api/overview.md">Übersicht</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../api/authentication/">Authentication</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../api/endpoints.md">Endpoints</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../api/webhooks/">Webhooks</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Features</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../features/appointment-booking/">Appointment Booking</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../features/call-management.md">Call Management</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../features/customer-portal.md">Customer Portal</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../features/multi-tenancy/">Multi-Tenancy</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Development</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="../../../development/setup.md">Setup</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../development/testing.md">Testing</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../development/code-standards.md">Code Standards</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Deployment</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="../../../deployment/overview.md">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../deployment/production.md">Production</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../../deployment/environment-variables.md">Environment Variables</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Betrieb</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../CUSTOMER_SUCCESS_RUNBOOK/">Customer Success</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../EMERGENCY_RESPONSE_PLAYBOOK/">Emergency Response</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../ERROR_PATTERNS/">Error Patterns</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../TROUBLESHOOTING_DECISION_TREE/">Troubleshooting</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../DEPLOYMENT_CHECKLIST/">Deployment Checklist</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Monitoring</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../KPI_DASHBOARD_TEMPLATE/">KPI Dashboard</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../INTEGRATION_HEALTH_MONITOR/">Health Monitor</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../PHONE_TO_APPOINTMENT_FLOW/">Phone to Appointment Flow</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">AskProAI Dokumentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>Troubleshooting Guide</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="troubleshooting-guide">Troubleshooting Guide</h1>
<h2 id="overview">Overview</h2>
<p>This guide provides solutions to common issues encountered with AskProAI. It's organized by symptoms and includes step-by-step debugging procedures.</p>
<h2 id="common-issues">Common Issues</h2>
<h3 id="application-wont-start">Application Won't Start</h3>
<h4 id="symptoms">Symptoms</h4>
<ul>
<li>500 Internal Server Error</li>
<li>White screen</li>
<li>"Whoops, something went wrong" message</li>
</ul>
<h4 id="diagnosis-steps">Diagnosis Steps</h4>
<ol>
<li>
<p><strong>Check error logs</strong>:
   <code>bash
   tail -f /var/www/api-gateway/storage/logs/laravel.log
   tail -f /var/log/nginx/error.log
   tail -f /var/log/php8.2-fpm.log</code></p>
</li>
<li>
<p><strong>Verify file permissions</strong>:
   ```bash
   # Check ownership
   ls -la /var/www/api-gateway</p>
</li>
</ol>
<p># Fix permissions
   sudo chown -R askproai:www-data /var/www/api-gateway
   sudo chmod -R 755 /var/www/api-gateway
   sudo chmod -R 775 /var/www/api-gateway/storage
   sudo chmod -R 775 /var/www/api-gateway/bootstrap/cache
   ```</p>
<ol>
<li><strong>Check environment file</strong>:
   ```bash
   # Verify .env exists
   ls -la /var/www/api-gateway/.env</li>
</ol>
<p># Check critical variables
   grep -E "APP_KEY|DB_" /var/www/api-gateway/.env
   ```</p>
<ol>
<li><strong>Clear caches</strong>:
   <code>bash
   php artisan optimize:clear
   php artisan config:clear
   php artisan cache:clear
   php artisan view:clear
   php artisan route:clear</code></li>
</ol>
<h4 id="common-solutions">Common Solutions</h4>
<ul>
<li><strong>Missing APP_KEY</strong>: Run <code>php artisan key:generate</code></li>
<li><strong>Database connection error</strong>: Verify database credentials and server is running</li>
<li><strong>Permission denied</strong>: Fix file permissions as shown above</li>
<li><strong>Class not found</strong>: Run <code>composer dump-autoload</code></li>
</ul>
<h3 id="database-connection-issues">Database Connection Issues</h3>
<h4 id="symptoms_1">Symptoms</h4>
<ul>
<li>"SQLSTATE[HY000] [2002] Connection refused"</li>
<li>"Access denied for user"</li>
<li>"Unknown database"</li>
</ul>
<h4 id="diagnosis-steps_1">Diagnosis Steps</h4>
<ol>
<li><strong>Test database connection</strong>:
   ```bash
   # Test MySQL connection
   mysql -h 127.0.0.1 -u askproai_user -p</li>
</ol>
<p># From application
   php artisan tinker</p>
<blockquote>
<blockquote>
<blockquote>
<p>DB::connection()-&gt;getPdo();
   ```</p>
</blockquote>
</blockquote>
</blockquote>
<ol>
<li><strong>Check MySQL service</strong>:
   ```bash
   sudo systemctl status mysql
   sudo systemctl start mysql</li>
</ol>
<p># Check if listening
   sudo netstat -tlnp | grep 3306
   ```</p>
<ol>
<li><strong>Verify credentials</strong>:
   <code>bash
   # In .env file
   DB_HOST=127.0.0.1
   DB_PORT=3306
   DB_DATABASE=askproai_db
   DB_USERNAME=askproai_user
   DB_PASSWORD=your_password</code></li>
</ol>
<h4 id="common-solutions_1">Common Solutions</h4>
<pre><code class="language-sql">-- Create database and user
CREATE DATABASE IF NOT EXISTS askproai_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER IF NOT EXISTS 'askproai_user'@'localhost' IDENTIFIED BY 'password';
GRANT ALL PRIVILEGES ON askproai_db.* TO 'askproai_user'@'localhost';
FLUSH PRIVILEGES;

-- Check user permissions
SHOW GRANTS FOR 'askproai_user'@'localhost';
</code></pre>
<h3 id="queue-processing-issues">Queue Processing Issues</h3>
<h4 id="symptoms_2">Symptoms</h4>
<ul>
<li>Jobs not being processed</li>
<li>Emails not sending</li>
<li>Webhooks not being handled</li>
<li>High job failure rate</li>
</ul>
<h4 id="diagnosis-steps_2">Diagnosis Steps</h4>
<ol>
<li><strong>Check queue workers</strong>:
   ```bash
   # Check Horizon status
   php artisan horizon:status</li>
</ol>
<p># Check supervisor
   sudo supervisorctl status</p>
<p># View Horizon dashboard
   http://your-domain/horizon
   ```</p>
<ol>
<li>
<p><strong>Monitor queue sizes</strong>:
   ```bash
   # Check Redis queues
   redis-cli</p>
<blockquote>
<p>LLEN queues:default
LLEN queues:high
LLEN queues:failed
   ```</p>
</blockquote>
</li>
<li>
<p><strong>Check failed jobs</strong>:
   ```bash
   php artisan queue:failed</p>
</li>
</ol>
<p># Inspect specific failed job
   php artisan queue:failed:show {id}
   ```</p>
<h4 id="common-solutions_2">Common Solutions</h4>
<ol>
<li>
<p><strong>Restart queue workers</strong>:
   <code>bash
   sudo supervisorctl restart horizon
   # or
   php artisan horizon:terminate
   php artisan horizon</code></p>
</li>
<li>
<p><strong>Process failed jobs</strong>:
   ```bash
   # Retry all failed jobs
   php artisan queue:retry all</p>
</li>
</ol>
<p># Retry specific job
   php artisan queue:retry {id}</p>
<p># Clear failed jobs
   php artisan queue:flush
   ```</p>
<ol>
<li><strong>Debug specific job</strong>:
   <code>php
   // Add to job class
   public function failed(Throwable $exception)
   {
       Log::error('Job failed', [
           'job' =&gt; static::class,
           'data' =&gt; $this-&gt;data,
           'exception' =&gt; $exception-&gt;getMessage(),
           'trace' =&gt; $exception-&gt;getTraceAsString(),
       ]);
   }</code></li>
</ol>
<h3 id="webhook-issues">Webhook Issues</h3>
<h4 id="symptoms_3">Symptoms</h4>
<ul>
<li>Webhooks not being received</li>
<li>"Invalid signature" errors</li>
<li>Webhook processing failures</li>
</ul>
<h4 id="diagnosis-steps_3">Diagnosis Steps</h4>
<ol>
<li><strong>Check webhook logs</strong>:
   ```bash
   # Application logs
   grep -i webhook /var/www/api-gateway/storage/logs/laravel.log</li>
</ol>
<p># Nginx access logs
   grep webhook /var/log/nginx/access.log
   ```</p>
<ol>
<li>
<p><strong>Test webhook endpoint</strong>:
   <code>bash
   # Test Retell webhook
   curl -X POST https://your-domain/api/retell/webhook \
     -H "Content-Type: application/json" \
     -H "x-retell-signature: test" \
     -d '{"event_type":"test"}'</code></p>
</li>
<li>
<p><strong>Verify webhook configuration</strong>:
   ```php
   php artisan tinker</p>
<blockquote>
<blockquote>
<blockquote>
<p>config('services.retell.webhook_secret')
config('services.calcom.webhook_secret')
   ```</p>
</blockquote>
</blockquote>
</blockquote>
</li>
</ol>
<h4 id="common-solutions_3">Common Solutions</h4>
<ol>
<li>
<p><strong>Fix signature verification</strong>:
   ```php
   // app/Http/Middleware/VerifyRetellSignature.php
   public function handle($request, Closure $next)
   {
       Log::debug('Webhook received', [
           'headers' =&gt; $request-&gt;headers-&gt;all(),
           'body' =&gt; $request-&gt;getContent(),
       ]);</p>
<p>// Temporarily bypass for testing (remove in production!)
   if (app()-&gt;environment('local')) {
       return $next($request);
   }</p>
<p>// Normal verification
   $signature = $request-&gt;header('x-retell-signature');
   // ... rest of verification
   }
   ```</p>
</li>
<li>
<p><strong>Process webhook manually</strong>:
   ```php
   php artisan tinker</p>
<blockquote>
<blockquote>
<blockquote>
<p>$webhook = \App\Models\WebhookEvent::find(123);
app(\App\Services\Webhooks\RetellWebhookHandler::class)-&gt;handle($webhook-&gt;payload);
   ```</p>
</blockquote>
</blockquote>
</blockquote>
</li>
</ol>
<h3 id="performance-issues">Performance Issues</h3>
<h4 id="symptoms_4">Symptoms</h4>
<ul>
<li>Slow page loads</li>
<li>High response times</li>
<li>Database queries timing out</li>
<li>High memory usage</li>
</ul>
<h4 id="diagnosis-steps_4">Diagnosis Steps</h4>
<ol>
<li>
<p><strong>Enable query logging</strong>:
   <code>php
   // Add to AppServiceProvider
   if (config('app.debug')) {
       DB::listen(function ($query) {
           if ($query-&gt;time &gt; 100) {
               Log::warning('Slow query detected', [
                   'sql' =&gt; $query-&gt;sql,
                   'time' =&gt; $query-&gt;time,
                   'bindings' =&gt; $query-&gt;bindings,
               ]);
           }
       });
   }</code></p>
</li>
<li>
<p><strong>Profile with Laravel Debugbar</strong>:
   <code>bash
   composer require barryvdh/laravel-debugbar --dev</code></p>
</li>
<li>
<p><strong>Check resource usage</strong>:
   ```bash
   # CPU and memory
   top -p $(pgrep -d',' php)</p>
</li>
</ol>
<p># MySQL processes
   mysql -e "SHOW PROCESSLIST"</p>
<p># Redis memory
   redis-cli INFO memory
   ```</p>
<h4 id="common-solutions_4">Common Solutions</h4>
<ol>
<li><strong>Optimize database queries</strong>:
   ```php
   // Bad - N+1 problem
   $appointments = Appointment::all();
   foreach ($appointments as $appointment) {
       echo $appointment-&gt;customer-&gt;name;
   }</li>
</ol>
<p>// Good - Eager loading
   $appointments = Appointment::with('customer')-&gt;get();
   ```</p>
<ol>
<li>
<p><strong>Add database indexes</strong>:
   <code>sql
   -- Check missing indexes
   SELECT 
       t.TABLE_NAME,
       t.COLUMN_NAME,
       t.DATA_TYPE
   FROM INFORMATION_SCHEMA.COLUMNS t
   WHERE t.TABLE_SCHEMA = 'askproai_db'
       AND t.COLUMN_NAME LIKE '%_id'
       AND NOT EXISTS (
           SELECT 1 
           FROM INFORMATION_SCHEMA.STATISTICS s 
           WHERE s.TABLE_SCHEMA = t.TABLE_SCHEMA 
               AND s.TABLE_NAME = t.TABLE_NAME 
               AND s.COLUMN_NAME = t.COLUMN_NAME
       );</code></p>
</li>
<li>
<p><strong>Enable caching</strong>:
   <code>php
   // Cache expensive queries
   $eventTypes = Cache::remember('event-types', 3600, function () {
       return EventType::with('services')-&gt;get();
   });</code></p>
</li>
</ol>
<h3 id="external-service-integration-issues">External Service Integration Issues</h3>
<h4 id="calcom-issues">Cal.com Issues</h4>
<p><strong>Symptoms</strong>:
- "Event type not found"
- "No available slots"
- Booking failures</p>
<p><strong>Solutions</strong>:</p>
<pre><code class="language-bash"># Test Cal.com connection
php artisan debug:calcom test

# Sync event types
php artisan calcom:sync-event-types --force

# Debug specific booking
php artisan tinker
&gt;&gt;&gt; $service = app(\App\Services\CalcomV2Service::class);
&gt;&gt;&gt; $service-&gt;getAvailability(2026361, '2025-07-01');
</code></pre>
<h4 id="retellai-issues">Retell.ai Issues</h4>
<p><strong>Symptoms</strong>:
- Calls not being logged
- Agent not responding
- Webhook not received</p>
<p><strong>Solutions</strong>:</p>
<pre><code class="language-bash"># Test Retell connection
php artisan debug:retell test

# Check agent configuration
curl -H &quot;Authorization: Bearer YOUR_API_KEY&quot; \
     https://api.retellai.com/v1/agents

# Manually import calls
php artisan retell:import-calls --days=7
</code></pre>
<h3 id="email-delivery-issues">Email Delivery Issues</h3>
<h4 id="symptoms_5">Symptoms</h4>
<ul>
<li>Emails not being sent</li>
<li>Emails going to spam</li>
<li>SMTP connection errors</li>
</ul>
<h4 id="diagnosis-steps_5">Diagnosis Steps</h4>
<ol>
<li>
<p><strong>Test email configuration</strong>:
   ```php
   php artisan tinker</p>
<blockquote>
<blockquote>
<blockquote>
<p>Mail::raw('Test email', function($message) {
   ...     $message-&gt;to('test@example.com')-&gt;subject('Test');
   ... });
   ```</p>
</blockquote>
</blockquote>
</blockquote>
</li>
<li>
<p><strong>Check mail logs</strong>:
   ```bash
   # If using log driver
   tail -f /var/www/api-gateway/storage/logs/laravel.log | grep -i mail</p>
</li>
</ol>
<p># Check mail queue
   sudo mailq
   ```</p>
<ol>
<li><strong>Verify SMTP settings</strong>:
   <code>bash
   # Test SMTP connection
   telnet smtp.server.com 587</code></li>
</ol>
<h4 id="common-solutions_5">Common Solutions</h4>
<ol>
<li>
<p><strong>Use different mail driver for testing</strong>:
   <code>env
   # In .env
   MAIL_MAILER=log  # Logs emails instead of sending
   # or
   MAIL_MAILER=smtp
   MAIL_HOST=localhost
   MAIL_PORT=1025  # For Mailhog</code></p>
</li>
<li>
<p><strong>Fix authentication</strong>:
   <code>env
   MAIL_USERNAME=your-username
   MAIL_PASSWORD="your-password"  # Quote if special characters
   MAIL_ENCRYPTION=tls</code></p>
</li>
</ol>
<h3 id="caching-issues">Caching Issues</h3>
<h4 id="symptoms_6">Symptoms</h4>
<ul>
<li>Stale data being displayed</li>
<li>Changes not reflecting</li>
<li>"Cache store not found" errors</li>
</ul>
<h4 id="diagnosis-steps_6">Diagnosis Steps</h4>
<ol>
<li>
<p><strong>Check Redis connection</strong>:
   <code>bash
   redis-cli ping
   redis-cli INFO</code></p>
</li>
<li>
<p><strong>Verify cache configuration</strong>:
   ```php
   php artisan tinker</p>
<blockquote>
<blockquote>
<blockquote>
<p>Cache::put('test', 'value', 60);
Cache::get('test');
   ```</p>
</blockquote>
</blockquote>
</blockquote>
</li>
</ol>
<h4 id="common-solutions_6">Common Solutions</h4>
<ol>
<li>
<p><strong>Clear all caches</strong>:
   <code>bash
   php artisan cache:clear
   redis-cli FLUSHDB</code></p>
</li>
<li>
<p><strong>Fix Redis connection</strong>:
   <code>env
   REDIS_HOST=127.0.0.1
   REDIS_PASSWORD=null
   REDIS_PORT=6379
   CACHE_DRIVER=redis</code></p>
</li>
</ol>
<h2 id="debugging-tools">Debugging Tools</h2>
<h3 id="artisan-commands">Artisan Commands</h3>
<pre><code class="language-bash"># System information
php artisan about

# List all routes
php artisan route:list

# Test database connection
php artisan db:show

# View configuration
php artisan config:show

# Queue status
php artisan queue:monitor

# Clear everything
php artisan optimize:clear
</code></pre>
<h3 id="tinker-debugging">Tinker Debugging</h3>
<pre><code class="language-php">// Test database
DB::connection()-&gt;getPdo();
DB::select('SELECT 1');

// Test Redis
Redis::ping();
Redis::set('test', 'value');
Redis::get('test');

// Test services
app(RetellService::class)-&gt;testConnection();
app(CalcomService::class)-&gt;getEventTypes();

// Debug specific models
$appointment = Appointment::with(['customer', 'service', 'branch'])-&gt;find(1);
dd($appointment-&gt;toArray());

// Check configuration
config('services.retell');
env('DEFAULT_RETELL_API_KEY');
</code></pre>
<h3 id="log-analysis">Log Analysis</h3>
<pre><code class="language-bash"># Find errors in logs
grep -i error /var/www/api-gateway/storage/logs/*.log

# Find specific user activity
grep &quot;user_id:123&quot; /var/www/api-gateway/storage/logs/*.log

# Monitor logs in real-time
tail -f /var/www/api-gateway/storage/logs/laravel.log | grep -v INFO

# Count errors by type
grep ERROR /var/www/api-gateway/storage/logs/*.log | awk '{print $4}' | sort | uniq -c
</code></pre>
<h2 id="emergency-procedures">Emergency Procedures</h2>
<h3 id="application-down">Application Down</h3>
<ol>
<li><strong>Immediate Actions</strong>:
   ```bash
   # Restart services
   sudo systemctl restart nginx
   sudo systemctl restart php8.2-fpm
   sudo systemctl restart mysql
   sudo systemctl restart redis</li>
</ol>
<p># Check disk space
   df -h</p>
<p># Check memory
   free -m
   ```</p>
<ol>
<li>
<p><strong>Enable maintenance mode</strong>:
   <code>bash
   php artisan down --message="Maintenance in progress" --retry=60</code></p>
</li>
<li>
<p><strong>Quick diagnostics</strong>:
   ```bash
   # Check last 100 errors
   tail -n 1000 /var/www/api-gateway/storage/logs/laravel.log | grep ERROR</p>
</li>
</ol>
<p># Check system load
   uptime
   top
   ```</p>
<h3 id="database-locked">Database Locked</h3>
<pre><code class="language-sql">-- Show running processes
SHOW PROCESSLIST;

-- Kill long-running query
KILL QUERY process_id;

-- Show locks
SELECT * FROM INFORMATION_SCHEMA.INNODB_LOCKS;
SELECT * FROM INFORMATION_SCHEMA.INNODB_LOCK_WAITS;

-- Force unlock tables
UNLOCK TABLES;
</code></pre>
<h3 id="high-load-emergency">High Load Emergency</h3>
<pre><code class="language-bash">#!/bin/bash
# Emergency load reduction

# 1. Enable maintenance mode
php artisan down

# 2. Stop non-critical services
sudo supervisorctl stop horizon

# 3. Increase PHP-FPM limits temporarily
sudo sed -i 's/pm.max_children = .*/pm.max_children = 100/' /etc/php/8.2/fpm/pool.d/www.conf
sudo systemctl reload php8.2-fpm

# 4. Clear caches
redis-cli FLUSHDB

# 5. Restart services
sudo systemctl restart nginx
sudo systemctl restart php8.2-fpm

# 6. Gradually bring back online
php artisan up
sudo supervisorctl start horizon
</code></pre>
<h2 id="monitoring-commands">Monitoring Commands</h2>
<h3 id="health-check-script">Health Check Script</h3>
<pre><code class="language-bash">#!/bin/bash
# health-check.sh

echo &quot;=== AskProAI Health Check ===&quot;

# Check services
services=(&quot;nginx&quot; &quot;php8.2-fpm&quot; &quot;mysql&quot; &quot;redis&quot; &quot;supervisor&quot;)
for service in &quot;${services[@]}&quot;; do
    if systemctl is-active --quiet $service; then
        echo &quot;✓ $service is running&quot;
    else
        echo &quot;✗ $service is down&quot;
    fi
done

# Check disk space
echo -e &quot;\n=== Disk Usage ===&quot;
df -h | grep -E &quot;^/dev|Filesystem&quot;

# Check memory
echo -e &quot;\n=== Memory Usage ===&quot;
free -h

# Check database
echo -e &quot;\n=== Database Status ===&quot;
mysql -e &quot;SELECT COUNT(*) as connections FROM information_schema.processlist;&quot; 2&gt;/dev/null || echo &quot;✗ Cannot connect to MySQL&quot;

# Check Redis
echo -e &quot;\n=== Redis Status ===&quot;
redis-cli ping 2&gt;/dev/null || echo &quot;✗ Cannot connect to Redis&quot;

# Check application
echo -e &quot;\n=== Application Status ===&quot;
curl -s -o /dev/null -w &quot;HTTP Status: %{http_code}\n&quot; http://localhost/health || echo &quot;✗ Application not responding&quot;
</code></pre>
<h2 id="best-practices">Best Practices</h2>
<ol>
<li><strong>Always backup before changes</strong></li>
<li><strong>Test in staging first</strong></li>
<li><strong>Monitor logs during changes</strong></li>
<li><strong>Document issues and solutions</strong></li>
<li><strong>Keep debug mode off in production</strong></li>
<li><strong>Use version control for configurations</strong></li>
<li><strong>Maintain runbooks for common issues</strong></li>
</ol>
<h2 id="related-documentation">Related Documentation</h2>
<ul>
<li><a href="../../development/debugging/">Debugging Guide</a></li>
<li><a href="../monitoring/">Monitoring Guide</a></li>
<li><a href="performance.md">Performance Optimization</a></li>
<li><a href="../../deployment/production/">Deployment Guide</a></li>
</ul>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme_extra.js" defer></script>
    <script src="../../../js/theme.js" defer></script>
      <script src="../../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
