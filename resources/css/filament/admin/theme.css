@import '../../../../vendor/filament/filament/resources/css/theme.css';

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer components {
/* Modern Sky-Blue Theme for AskProAI */
:root {
    --color-primary-50: 240 249 255;
    --color-primary-100: 224 242 254;
    --color-primary-200: 186 230 253;
    --color-primary-300: 125 211 252;
    --color-primary-400: 56 189 248;
    --color-primary-500: 14 165 233;
    --color-primary-600: 2 132 199;
    --color-primary-700: 3 105 161;
    --color-primary-800: 7 89 133;
    --color-primary-900: 12 74 110;
    --color-primary-950: 8 47 73;
}

/* Modern Sidebar Styling */
.fi-sidebar {
    @apply bg-gradient-to-b from-white to-gray-50 border-r border-gray-200;
    background: white !important; /* Ensure solid background */
    opacity: 1 !important; /* Prevent any transparency */
}

.fi-sidebar-header {
    @apply bg-gradient-to-r from-sky-500 to-sky-600 text-white shadow-md;
}

.fi-sidebar-nav {
    @apply bg-transparent;
}

.fi-sidebar-item a {
    @apply rounded-lg mx-2 transition-all duration-200;
}

.fi-sidebar-item-active {
    @apply bg-sky-50 text-sky-700 shadow-sm;
}

.fi-sidebar-item:hover:not(.fi-sidebar-item-active) a {
    @apply bg-gray-100 text-gray-700;
}

/* Modern Cards with Flowbite styling */
.fi-wi-widget {
    @apply rounded-2xl shadow-sm border border-gray-100 overflow-hidden;
}

.fi-section {
    @apply rounded-2xl bg-white shadow-sm border border-gray-100;
}

/* Clean Tables */
.fi-ta-table {
    @apply divide-y divide-gray-100;
}

.fi-ta-row {
    @apply hover:bg-sky-50 transition-colors duration-150;
}

/* Modern Form Inputs */
.fi-input {
    @apply rounded-lg border-gray-200 focus:border-sky-400 focus:ring-sky-400;
}

/* Better Buttons with Flowbite style */
.fi-btn {
    @apply rounded-lg font-medium transition-all duration-200 shadow-sm hover:shadow-md;
}

.fi-btn-primary {
    @apply bg-gradient-to-r from-sky-500 to-sky-600 hover:from-sky-600 hover:to-sky-700 text-white;
}

/* Fix Login Button specifically */
button[type="submit"], 
.fi-btn-color-primary,
.fi-ac-btn-action {
    @apply bg-sky-600 hover:bg-sky-700 text-white !important;
    color: white !important;
}

/* Filament Primary Button Override */
.fi-btn.fi-color-custom {
    @apply bg-sky-600 hover:bg-sky-700 text-white;
}

/* Login Form Specific */
.fi-login-panel {
    @apply shadow-2xl rounded-2xl;
}

.fi-login-panel .fi-btn {
    @apply bg-sky-600 hover:bg-sky-700 text-white font-semibold;
}

/* Dashboard Stats Cards */
.fi-stats-card {
    @apply bg-white rounded-2xl p-6 border border-gray-100 shadow-sm hover:shadow-lg transition-shadow duration-300;
}

/* FIX for Issue #658 - Main Content Viewport Displacement */
/* Desktop Grid Layout - Fixed ordering without flex-row-reverse */
@media (min-width: 1024px) {
    /* Ultra-high specificity to override any inline styles or other CSS */
    body .fi-layout[class],
    body:not(:has(.fi-simple-page)) .fi-layout {
        display: grid !important;
        grid-template-columns: 16rem 1fr !important; /* Sidebar: 16rem, Main: remaining */
        grid-template-areas: "sidebar main" !important;
        min-height: 100vh !important;
        width: 100% !important;
        position: relative !important;
        isolation: isolate !important; /* Create new stacking context */
    }

    .fi-sidebar {
        grid-area: sidebar !important;
        grid-column: 1 !important; /* Explicitly first column */
        order: 1 !important; /* Ensure sidebar comes first visually */
        position: sticky !important;
        top: 0 !important;
        height: 100vh !important;
        overflow-y: auto !important;
        background: white !important;
        border-right: 1px solid rgb(229 231 235) !important;
        width: 16rem !important;
        z-index: 40 !important; /* Ensure sidebar is above main content */
        opacity: 1 !important; /* Remove any transparency */
    }

    /* Main container in grid context - don't use flex here */
    .fi-layout > .fi-main-ctn {
        grid-area: main !important;
        grid-column: 2 !important; /* Explicitly place in second column */
        order: 2 !important; /* Ensure main content comes second visually */
        display: block !important; /* Block, not flex, to respect grid */
        min-height: 100vh !important;
        width: auto !important; /* Respect grid column width */
        max-width: 100% !important;
        overflow-x: hidden !important;
        position: relative !important;
        opacity: 1 !important;
        z-index: 10 !important; /* Below sidebar */
        margin-left: 0 !important; /* Remove any left margin */
        background: rgb(249 250 251) !important; /* Ensure solid background */
    }
    
    /* The inner content can be flex */
    .fi-layout > .fi-main-ctn > * {
        display: flex !important;
        flex-direction: column !important;
        width: 100% !important;
    }
    
    /* Override any w-screen classes that break the grid */
    .fi-layout .fi-main-ctn.w-screen {
        width: auto !important;
    }
    
    /* Ensure proper ordering when sidebar is collapsed */
    .fi-main-ctn-sidebar-open {
        grid-area: main !important;
        margin-left: 0 !important; /* Grid handles spacing */
    }
    
    /* Fix for main content area */
    .fi-main {
        width: 100% !important;
        max-width: 100% !important;
        margin-left: 0 !important; /* Remove any default margins */
    }
}

/* Fix navigation items spacing */
.fi-sidebar-nav {
    padding: 0.5rem !important;
}

.fi-sidebar-item {
    margin-bottom: 0.125rem !important;
}

.fi-sidebar-item a {
    display: flex !important;
    align-items: center !important;
    padding: 0.625rem 0.75rem !important;
    border-radius: 0.5rem !important;
}

.fi-sidebar-item-icon {
    width: 1.25rem !important;
    height: 1.25rem !important;
    margin-right: 0.75rem !important;
}

/* Fix Dashboard heading cutoff - ensure proper spacing */
.fi-header-heading {
    margin-left: 0 !important;
    padding-left: 0 !important;
    width: 100% !important;
    display: block !important;
}

.fi-page-header {
    padding-left: 2rem !important;
    padding-right: 2rem !important;
}

/* Mobile responsive fix - No grid on mobile, pure flex */
@media (max-width: 1023px) {
    .fi-layout {
        display: flex !important;
        flex-direction: column !important;
        grid-template-columns: none !important;
        grid-template-areas: none !important;
        min-height: 100vh !important;
        width: 100% !important;
        position: relative !important;
    }
    
    .fi-sidebar {
        position: fixed !important;
        left: 0 !important;
        top: 0 !important;
        width: 16rem !important;
        max-width: 80vw !important;
        height: 100vh !important;
        transform: translateX(-100%) !important;
        transition: transform 0.3s ease-in-out !important;
        z-index: 50 !important;
        background: white !important;
        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1) !important;
    }
    
    .fi-sidebar.fi-sidebar-open,
    .fi-sidebar[x-show="$store.sidebar.isOpen"] {
        transform: translateX(0) !important;
    }
    
    .fi-main-ctn {
        grid-area: unset !important;
        width: 100% !important;
        max-width: 100% !important;
        margin: 0 !important;
        padding: 0 !important;
        position: relative !important;
        opacity: 1 !important;
    }
    
    .fi-main {
        width: 100% !important;
        max-width: 100% !important;
        padding-left: 1rem !important;
        padding-right: 1rem !important;
    }
}
} /* End of @layer components */

/* Hide all navigation on login/auth pages */
body:has(.fi-simple-page) .fi-sidebar,
body:has(.fi-simple-page) .stripe-menu,
body:has(.fi-simple-page) .stripe-mobile-menu,
body:has(.fi-simple-page) .stripe-mega-menu,
body:has([class*="fi-login"]) .fi-sidebar,
body:has([class*="fi-login"]) .stripe-menu {
    display: none !important;
}

/* FIX: Ensure sidebar is always visible on desktop after login */
@media (min-width: 1024px) {
    body:not(:has(.fi-simple-page)):not(:has([class*="fi-login"])) .fi-sidebar {
        display: block !important;
        visibility: visible !important;
        transform: translateX(0) !important;
        opacity: 1 !important;
    }
    
    /* Ensure the layout maintains its grid structure */
    body:not(:has(.fi-simple-page)):not(:has([class*="fi-login"])) .fi-layout {
        display: grid !important;
        grid-template-columns: 16rem 1fr !important;
    }
    
    /* Force main content to respect grid position */
    body:not(:has(.fi-simple-page)):not(:has([class*="fi-login"])) .fi-main-ctn {
        grid-column: 2 !important; /* Explicitly place in second column */
        margin-left: 0 !important;
        width: auto !important;
    }
}

/* TEMPORARILY DISABLED - Restoring Filament sidebar */
/* Hide Filament sidebar on desktop when Stripe menu is active */
/*
@media (min-width: 1024px) {
    .fi-sidebar {
        display: none !important;
    }
    
    // Adjust main content to full width since sidebar is hidden
    .fi-layout {
        grid-template-columns: 1fr !important;
    }
    
    .fi-main {
        margin-left: 0 !important;
        grid-column: 1 !important;
    }
    
    // Hide the sidebar toggle button on desktop
    .fi-sidebar-open-btn,
    .fi-sidebar-close-btn {
        display: none !important;
    }
}
*/

/* Keep Filament sidebar on mobile (hidden by default, can be toggled) */
/*
@media (max-width: 1023px) {
    // Stripe menu handles mobile navigation
    .fi-sidebar {
        display: none !important;
    }
    
    // Hide Filament mobile toggle since we use Stripe menu
    .fi-sidebar-open-btn {
        display: none !important;
    }
}
*/

/* Enhanced Calls Mobile Responsiveness - Added 2025-09-09 */
@media (max-width: 640px) {
    /* Prevent horizontal overflow on mobile */
    .tier-1-critical,
    .tier-2-contextual,
    .tier-3-detailed,
    .tier-4-technical {
        max-width: 100vw;
        overflow-x: hidden;
    }
    
    /* Ensure all containers respect mobile viewport */
    .transcript-container {
        max-width: calc(100vw - 2rem);
    }
    
    /* Touch-friendly tap targets (minimum 44px) */
    .tier-1-critical button,
    .tier-2-contextual button,
    .tier-3-detailed button {
        min-height: 44px;
    }
    
    /* Prevent text from pushing layout */
    .tier-1-critical p,
    .tier-1-critical span,
    .tier-2-contextual p,
    .tier-2-contextual span {
        word-break: break-word;
        overflow-wrap: break-word;
    }
    
    /* Mobile-optimized transcript messages */
    .transcript-container > div > div {
        max-width: 85% !important;
    }
    
    /* Ensure search input doesn't overflow */
    #transcript-search {
        max-width: 100%;
    }
    
    /* Stack metric cards vertically on very small screens */
    @media (max-width: 400px) {
        .tier-1-critical .flex-wrap {
            flex-direction: column !important;
            align-items: stretch !important;
        }
        
        /* Ensure buttons take full width on very small screens */
        .tier-1-critical button {
            width: 100% !important;
        }
    }
    
    /* Optimize table display for mobile */
    table {
        display: block;
        overflow-x: auto;
        white-space: nowrap;
    }
    
    /* Ensure pre-formatted code blocks are scrollable */
    pre {
        max-width: 100%;
        overflow-x: auto;
        white-space: pre-wrap;
        word-wrap: break-word;
    }
    
    /* Fix grid layouts on mobile */
    .grid {
        gap: 0.75rem !important;
    }
}

/* Tablet-specific optimizations */
@media (min-width: 641px) and (max-width: 1024px) {
    .tier-2-contextual > div {
        min-height: auto;
    }
    
    /* Optimize grid layouts for tablets */
    .grid {
        gap: 1rem;
    }
    
    /* Ensure proper button sizing on tablets */
    button {
        min-height: 40px;
    }
}

/* Fix for iOS Safari input zoom issue */
@media (max-width: 768px) {
    input[type="text"],
    input[type="search"],
    textarea,
    select {
        font-size: 16px !important;
    }
}

/* Enhanced calls specific responsive fixes */
.enhanced-call-view {
    max-width: 100%;
    overflow-x: hidden;
}

/* Ensure modals and overlays are mobile-friendly */
@media (max-width: 640px) {
    .fi-modal {
        max-width: calc(100vw - 1rem);
        margin: 0.5rem;
    }
    
    details summary {
        padding: 1rem;
        font-size: 0.875rem;
    }
}
