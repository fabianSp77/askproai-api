<x-filament-panels::page>
    {{-- Load Fixed UI/UX Styles --}}
    <link rel="stylesheet" href="{{ asset('css/filament/admin/retell-control-center-fixed.css') }}">
    
    {{-- Inline Styles f√ºr modernes, helles Design --}}
    <style>
        /* Modern Light Design System */
        :root {
            --modern-primary: #6366f1;
            --modern-secondary: #8b5cf6;
            --modern-success: #10b981;
            --modern-warning: #f59e0b;
            --modern-error: #ef4444;
            --modern-info: #3b82f6;
            
            --modern-gradient-primary: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            --modern-gradient-success: linear-gradient(135deg, #10b981 0%, #059669 100%);
            --modern-gradient-light: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%);
            
            --modern-bg-primary: #ffffff;
            --modern-bg-secondary: #f9fafb;
            --modern-bg-tertiary: #f3f4f6;
            
            --modern-border: #e5e7eb;
            --modern-border-focus: #6366f1;
            
            --modern-text-primary: #111827;
            --modern-text-secondary: #6b7280;
            --modern-text-tertiary: #9ca3af;
            
            --modern-shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --modern-shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --modern-shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --modern-shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            
            --modern-transition: all 0.2s ease;
        }
        
        /* Main Container - Light Background */
        .control-center-container {
            background: var(--modern-bg-secondary);
            min-height: calc(100vh - 64px);
            position: relative;
            padding: 1rem;
        }
        
        @media (min-width: 768px) {
            .control-center-container {
                padding: 1.5rem;
            }
        }
        
        /* Modern Card Component */
        .modern-card {
            background: var(--modern-bg-primary);
            border: 1px solid var(--modern-border);
            border-radius: 0.75rem;
            padding: 1.5rem;
            transition: var(--modern-transition);
            position: relative;
            overflow: hidden;
            box-shadow: var(--modern-shadow-sm);
        }
        
        /* Agent Card Specific Styles */
        .agent-card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 1.5rem;
        }
        
        @media (max-width: 768px) {
            .agent-card-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .modern-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--modern-shadow-lg);
            border-color: var(--modern-border-focus);
        }
        
        /* Compact spacing for MacBook */
        @media (max-width: 1440px) {
            .modern-card {
                padding: 1rem;
            }
        }
        
        /* Tab Navigation - Compact */
        .modern-tabs {
            display: flex;
            gap: 0.5rem;
            padding: 0.5rem;
            background: var(--modern-bg-primary);
            border: 1px solid var(--modern-border);
            border-radius: 0.75rem;
            margin-bottom: 1rem;
            box-shadow: var(--modern-shadow-sm);
        }
        
        .modern-tab {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: var(--modern-transition);
            color: var(--modern-text-secondary);
            font-weight: 500;
            font-size: 0.875rem;
            white-space: nowrap;
        }
        
        .modern-tab:hover {
            color: var(--modern-text-primary);
            background: var(--modern-bg-tertiary);
        }
        
        .modern-tab.active {
            color: white;
            background: var(--modern-gradient-primary);
            box-shadow: var(--modern-shadow-sm);
        }
        
        /* Metric Cards - Compact */
        .metric-card {
            background: var(--modern-bg-primary);
            border: 1px solid var(--modern-border);
            border-radius: 0.75rem;
            padding: 1rem;
            position: relative;
            overflow: hidden;
            transition: var(--modern-transition);
            box-shadow: var(--modern-shadow-sm);
        }
        
        .metric-card:hover {
            transform: scale(1.01);
            box-shadow: var(--modern-shadow-md);
        }
        
        .metric-value {
            font-size: 1.875rem;
            font-weight: 700;
            color: var(--modern-text-primary);
            line-height: 1;
        }
        
        .metric-label {
            color: var(--modern-text-secondary);
            font-size: 0.75rem;
            font-weight: 500;
            margin-bottom: 0.25rem;
        }
        
        .metric-trend {
            display: inline-flex;
            align-items: center;
            gap: 2px;
            font-size: 0.75rem;
            font-weight: 600;
            padding: 2px 8px;
            border-radius: 12px;
            margin-top: 0.25rem;
        }
        
        .metric-trend.positive {
            color: var(--modern-success);
            background: rgba(16, 185, 129, 0.1);
        }
        
        .metric-trend.negative {
            color: var(--modern-error);
            background: rgba(239, 68, 68, 0.1);
        }
        
        /* Agent Cards - Compact */
        .agent-card {
            background: var(--modern-bg-primary);
            border: 1px solid var(--modern-border);
            border-radius: 0.75rem;
            padding: 1rem;
            transition: var(--modern-transition);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            box-shadow: var(--modern-shadow-sm);
        }
        
        .agent-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--modern-shadow-md);
            border-color: var(--modern-border-focus);
        }
        
        .agent-card.selected {
            border-color: var(--modern-primary);
            box-shadow: 0 0 0 2px var(--modern-primary);
        }
        
        /* Function Builder */
        .function-template {
            background: var(--modern-bg-tertiary);
            border: 2px dashed var(--modern-border);
            border-radius: 0.5rem;
            padding: 0.75rem;
            cursor: grab;
            transition: var(--modern-transition);
        }
        
        .function-template:hover {
            border-color: var(--modern-primary);
            background: rgba(99, 102, 241, 0.05);
        }
        
        .function-template:active {
            cursor: grabbing;
            transform: scale(0.98);
        }
        
        /* Buttons - Compact */
        .modern-btn {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            font-size: 0.875rem;
            transition: var(--modern-transition);
            cursor: pointer;
            border: none;
            position: relative;
            overflow: hidden;
        }
        
        .modern-btn-primary {
            background: var(--modern-gradient-primary);
            color: white;
            box-shadow: var(--modern-shadow-sm);
        }
        
        .modern-btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: var(--modern-shadow-md);
        }
        
        .modern-btn-secondary {
            background: var(--modern-bg-primary);
            border: 1px solid var(--modern-border);
            color: var(--modern-text-primary);
        }
        
        .modern-btn-secondary:hover {
            background: var(--modern-bg-tertiary);
            border-color: var(--modern-border-focus);
        }
        
        /* Loading Animation */
        .modern-loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid var(--modern-border);
            border-radius: 50%;
            border-top-color: var(--modern-primary);
            animation: modern-spin 1s ease-in-out infinite;
        }
        
        @keyframes modern-spin {
            to { transform: rotate(360deg); }
        }
        
        /* Pulse Animation for Active Status */
        .pulse-dot {
            display: inline-block;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--modern-success);
            position: relative;
        }
        
        .pulse-dot::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: var(--modern-success);
            animation: pulse-animation 2s infinite;
        }
        
        @keyframes pulse-animation {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            100% {
                transform: scale(2);
                opacity: 0;
            }
        }
        
        /* Compact header */
        .compact-header {
            margin-bottom: 1rem;
        }
        
        /* Responsive grid adjustments */
        .compact-grid {
            gap: 0.75rem;
        }
    </style>
    
    <div class="control-center-container" x-data="controlCenter">
        {{-- Header Section - Compact --}}
        <div class="modern-card compact-header">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-xl font-bold text-gray-900">Retell Control Center</h1>
                    <p class="text-sm text-gray-500">Manage your AI phone agents</p>
                </div>
                <div class="flex items-center gap-2">
                    @if($error)
                        <div class="px-3 py-1.5 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm">
                            {{ $error }}
                        </div>
                    @endif
                    
                    @if($successMessage)
                        <div class="px-3 py-1.5 bg-green-50 border border-green-200 rounded-lg text-green-700 text-sm">
                            {{ $successMessage }}
                        </div>
                    @endif
                    
                    <button wire:click="refreshData" class="modern-btn modern-btn-secondary">
                        <svg class="w-4 h-4 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                        </svg>
                        Refresh
                    </button>
                </div>
            </div>
        </div>
        
        {{-- Tab Navigation - Compact --}}
        <div class="modern-tabs">
            <button 
                @click="activeTab = 'dashboard'"
                :class="activeTab === 'dashboard' ? 'active' : ''"
                class="modern-tab"
                wire:click="changeTab('dashboard')"
            >
                <svg class="w-4 h-4 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                </svg>
                Dashboard
            </button>
            
            <button 
                @click="activeTab = 'agents'"
                :class="activeTab === 'agents' ? 'active' : ''"
                class="modern-tab"
                wire:click="changeTab('agents')"
            >
                <svg class="w-4 h-4 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                </svg>
                Agents
            </button>
            
            <button 
                @click="activeTab = 'functions'"
                :class="activeTab === 'functions' ? 'active' : ''"
                class="modern-tab"
                wire:click="changeTab('functions')"
            >
                <svg class="w-4 h-4 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path>
                </svg>
                Functions
            </button>
            
            <button 
                @click="activeTab = 'webhooks'"
                :class="activeTab === 'webhooks' ? 'active' : ''"
                class="modern-tab"
                wire:click="changeTab('webhooks')"
            >
                <svg class="w-4 h-4 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path>
                </svg>
                Webhooks
            </button>
            
            <button 
                @click="activeTab = 'phones'"
                :class="activeTab === 'phones' ? 'active' : ''"
                class="modern-tab"
                wire:click="changeTab('phones')"
            >
                <svg class="w-4 h-4 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                </svg>
                Phones
            </button>
            
            <button 
                @click="activeTab = 'settings'"
                :class="activeTab === 'settings' ? 'active' : ''"
                class="modern-tab"
                wire:click="changeTab('settings')"
            >
                <svg class="w-4 h-4 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                </svg>
                Settings
            </button>
        </div>
        
        {{-- Content Area --}}
        <div class="tab-content">
            {{-- Dashboard Tab --}}
            <div x-show="activeTab === 'dashboard'" x-transition>
                {{-- Dashboard Filters with Modern Design --}}
                <div style="
                    margin-bottom: 20px;
                    background-color: #ffffff;
                    padding: 16px;
                    border-radius: 8px;
                    border: 1px solid #e5e7eb;
                ">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                        <h4 style="font-size: 16px; font-weight: 600; color: #111827;">Live Data Filters</h4>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <button 
                                wire:click="setDashboardFilter('all')"
                                style="
                                    height: 36px;
                                    padding: 0 16px;
                                    font-size: 14px;
                                    border-radius: 8px;
                                    border: none;
                                    cursor: pointer;
                                    transition: all 0.2s ease;
                                    font-weight: {{ $dashboardFilter === 'all' ? '600' : '500' }};
                                    background-color: {{ $dashboardFilter === 'all' ? '#e0e7ff' : '#f3f4f6' }};
                                    color: {{ $dashboardFilter === 'all' ? '#4338ca' : '#6b7280' }};
                                    white-space: nowrap;
                                "
                                onmouseover="if(this.style.backgroundColor !== '#e0e7ff') this.style.backgroundColor='#e5e7eb'"
                                onmouseout="if(this.style.color !== '#4338ca') this.style.backgroundColor='#f3f4f6'"
                            >
                                All Data
                            </button>
                            <button 
                                wire:click="setDashboardFilter('phone')"
                                style="
                                    height: 36px;
                                    padding: 0 16px;
                                    font-size: 14px;
                                    border-radius: 8px;
                                    border: none;
                                    cursor: pointer;
                                    transition: all 0.2s ease;
                                    font-weight: {{ $dashboardFilter === 'phone' ? '600' : '500' }};
                                    background-color: {{ $dashboardFilter === 'phone' ? '#e0e7ff' : '#f3f4f6' }};
                                    color: {{ $dashboardFilter === 'phone' ? '#4338ca' : '#6b7280' }};
                                    white-space: nowrap;
                                "
                                onmouseover="if(this.style.backgroundColor !== '#e0e7ff') this.style.backgroundColor='#e5e7eb'"
                                onmouseout="if(this.style.color !== '#4338ca') this.style.backgroundColor='#f3f4f6'"
                            >
                                By Phone
                            </button>
                            <button 
                                wire:click="setDashboardFilter('agent')"
                                style="
                                    height: 36px;
                                    padding: 0 16px;
                                    font-size: 14px;
                                    border-radius: 8px;
                                    border: none;
                                    cursor: pointer;
                                    transition: all 0.2s ease;
                                    font-weight: {{ $dashboardFilter === 'agent' ? '600' : '500' }};
                                    background-color: {{ $dashboardFilter === 'agent' ? '#e0e7ff' : '#f3f4f6' }};
                                    color: {{ $dashboardFilter === 'agent' ? '#4338ca' : '#6b7280' }};
                                    white-space: nowrap;
                                "
                                onmouseover="if(this.style.backgroundColor !== '#e0e7ff') this.style.backgroundColor='#e5e7eb'"
                                onmouseout="if(this.style.color !== '#4338ca') this.style.backgroundColor='#f3f4f6'"
                            >
                                By Agent
                            </button>
                        </div>
                    </div>
                    
                    {{-- Filter Options --}}
                    @if($dashboardFilter === 'phone')
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <label style="font-size: 14px; color: #6b7280;">Phone Number:</label>
                            <select 
                                wire:model.live="selectedPhoneFilter"
                                style="
                                    height: 36px;
                                    padding: 0 36px 0 12px;
                                    font-size: 14px;
                                    border: 1px solid #d1d5db;
                                    border-radius: 8px;
                                    background-color: #ffffff;
                                    color: #374151;
                                    cursor: pointer;
                                    transition: all 0.2s ease;
                                    min-width: 200px;
                                    appearance: none;
                                    background-image: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"%236b7280\"><path fill-rule=\"evenodd\" d=\"M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z\" clip-rule=\"evenodd\"/></svg>');
                                    background-position: right 8px center;
                                    background-size: 20px;
                                    background-repeat: no-repeat;
                                "
                                onfocus="this.style.borderColor='#6366f1'; this.style.boxShadow='0 0 0 3px rgba(99, 102, 241, 0.1)'"
                                onblur="this.style.borderColor='#d1d5db'; this.style.boxShadow='none'"
                            >
                                <option value="">Select Phone Number</option>
                                @foreach($phoneNumbers as $phone)
                                    <option value="{{ $phone['phone_number'] ?? '' }}">{{ $phone['phone_number'] ?? 'Unknown' }} ({{ $phone['agent_name'] ?? 'No Agent' }})</option>
                                @endforeach
                            </select>
                        </div>
                    @elseif($dashboardFilter === 'agent')
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <label style="font-size: 14px; color: #6b7280;">Agent:</label>
                            <select 
                                wire:model.live="selectedAgentFilter"
                                style="
                                    height: 36px;
                                    padding: 0 36px 0 12px;
                                    font-size: 14px;
                                    border: 1px solid #d1d5db;
                                    border-radius: 8px;
                                    background-color: #ffffff;
                                    color: #374151;
                                    cursor: pointer;
                                    transition: all 0.2s ease;
                                    min-width: 200px;
                                    appearance: none;
                                    background-image: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"%236b7280\"><path fill-rule=\"evenodd\" d=\"M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z\" clip-rule=\"evenodd\"/></svg>');
                                    background-position: right 8px center;
                                    background-size: 20px;
                                    background-repeat: no-repeat;
                                "
                                onfocus="this.style.borderColor='#6366f1'; this.style.boxShadow='0 0 0 3px rgba(99, 102, 241, 0.1)'"
                                onblur="this.style.borderColor='#d1d5db'; this.style.boxShadow='none'"
                            >
                                <option value="">Select Agent</option>
                                @foreach($agents as $agent)
                                    <option value="{{ $agent['agent_id'] ?? '' }}">{{ $agent['display_name'] ?? 'Unknown' }} {{ $agent['version'] ?? '' }}</option>
                                @endforeach
                            </select>
                        </div>
                    @endif
                </div>
                
                {{-- Metrics Grid with Modern Cards --}}
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px; margin-bottom: 20px;">
                    {{-- Active Calls Card --}}
                    <div style="
                        background: linear-gradient(135deg, #ffffff 0%, #f9fafb 100%);
                        border: 1px solid #e5e7eb;
                        border-radius: 12px;
                        padding: 20px;
                        position: relative;
                        overflow: hidden;
                        transition: all 0.2s ease;
                        cursor: pointer;
                    "
                    onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 10px 15px -3px rgba(0, 0, 0, 0.1)'"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                            <span style="font-size: 14px; color: #6b7280; font-weight: 500;">Active Calls</span>
                            <span style="
                                width: 8px;
                                height: 8px;
                                background-color: #10b981;
                                border-radius: 50%;
                                display: inline-block;
                                animation: pulse 2s infinite;
                            "></span>
                        </div>
                        <div style="font-size: 32px; font-weight: 700; color: #111827; margin-bottom: 4px;">
                            {{ $realtimeMetrics['active_calls'] }}
                        </div>
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <svg style="width: 14px; height: 14px; color: #10b981;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/>
                            </svg>
                            <span style="font-size: 12px; color: #10b981; font-weight: 500;">Live Status</span>
                        </div>
                    </div>
                    
                    {{-- Success Rate Card --}}
                    <div style="
                        background: linear-gradient(135deg, #ffffff 0%, #f9fafb 100%);
                        border: 1px solid #e5e7eb;
                        border-radius: 12px;
                        padding: 20px;
                        position: relative;
                        overflow: hidden;
                        transition: all 0.2s ease;
                        cursor: pointer;
                    "
                    onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 10px 15px -3px rgba(0, 0, 0, 0.1)'"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                        <div style="font-size: 14px; color: #6b7280; font-weight: 500; margin-bottom: 8px;">Success Rate</div>
                        <div style="font-size: 32px; font-weight: 700; color: #111827; margin-bottom: 8px;">
                            {{ $realtimeMetrics['success_rate'] }}%
                        </div>
                        <div style="position: relative; width: 100%; height: 6px; background-color: #e5e7eb; border-radius: 3px; overflow: hidden;">
                            <div style="
                                position: absolute;
                                left: 0;
                                top: 0;
                                height: 100%;
                                width: {{ $realtimeMetrics['success_rate'] }}%;
                                background: linear-gradient(90deg, #10b981 0%, #059669 100%);
                                border-radius: 3px;
                                transition: width 0.5s ease;
                            "></div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 6px; margin-top: 8px;">
                            <svg style="width: 14px; height: 14px; color: #10b981;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"/>
                            </svg>
                            <span style="font-size: 12px; color: #10b981; font-weight: 500;">+12% vs last week</span>
                        </div>
                    </div>
                    
                    {{-- Total Calls Card --}}
                    <div style="
                        background: linear-gradient(135deg, #ffffff 0%, #f9fafb 100%);
                        border: 1px solid #e5e7eb;
                        border-radius: 12px;
                        padding: 20px;
                        position: relative;
                        overflow: hidden;
                        transition: all 0.2s ease;
                        cursor: pointer;
                    "
                    onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 10px 15px -3px rgba(0, 0, 0, 0.1)'"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                        <div style="font-size: 14px; color: #6b7280; font-weight: 500; margin-bottom: 8px;">Total Calls Today</div>
                        <div style="font-size: 32px; font-weight: 700; color: #111827; margin-bottom: 4px;">
                            {{ $realtimeMetrics['total_calls_today'] }}
                        </div>
                        <div style="font-size: 13px; color: #9ca3af;">
                            Average duration: 4:23
                        </div>
                    </div>
                    
                    {{-- Bookings Card --}}
                    <div style="
                        background: linear-gradient(135deg, #ffffff 0%, #f9fafb 100%);
                        border: 1px solid #e5e7eb;
                        border-radius: 12px;
                        padding: 20px;
                        position: relative;
                        overflow: hidden;
                        transition: all 0.2s ease;
                        cursor: pointer;
                    "
                    onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 10px 15px -3px rgba(0, 0, 0, 0.1)'"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                        <div style="font-size: 14px; color: #6b7280; font-weight: 500; margin-bottom: 8px;">Bookings Today</div>
                        <div style="font-size: 32px; font-weight: 700; color: #111827; margin-bottom: 4px;">
                            {{ $realtimeMetrics['total_bookings_today'] }}
                        </div>
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <svg style="width: 14px; height: 14px; color: #8b5cf6;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"/>
                            </svg>
                            <span style="font-size: 12px; color: #8b5cf6; font-weight: 500;">+25% conversion rate</span>
                        </div>
                    </div>
                </div>
                
                {{-- Performance Chart --}}
                <div style="
                    background: #ffffff;
                    border: 1px solid #e5e7eb;
                    border-radius: 12px;
                    padding: 24px;
                ">
                    <h3 style="font-size: 18px; font-weight: 600; color: #111827; margin-bottom: 16px;">
                        Performance Overview
                    </h3>
                    <div style="
                        height: 300px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        background-color: #f9fafb;
                        border-radius: 8px;
                    ">
                        <div style="text-align: center;">
                            <svg style="width: 48px; height: 48px; margin: 0 auto 12px; color: #9ca3af;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                            </svg>
                            <p style="font-size: 14px; color: #6b7280;">Chart.js integration coming soon</p>
                            <p style="font-size: 12px; color: #9ca3af; margin-top: 4px;">Real-time performance metrics will be displayed here</p>
                        </div>
                    </div>
                </div>
            </div>
            
            {{-- Agents Tab --}}
            <div x-show="activeTab === 'agents'" x-transition>
                {{-- Search and Filter Bar --}}
                <div style="
                    margin-bottom: 20px;
                    display: flex;
                    align-items: center;
                    justify-content: space-between;
                    gap: 16px;
                    background-color: #ffffff;
                    padding: 16px;
                    border-radius: 8px;
                    border: 1px solid #e5e7eb;
                ">
                    <div style="display: flex; align-items: center; gap: 12px; flex: 1;">
                        {{-- Search Input with Icon - Fixed No Overlap --}}
                        <div style="position: relative; flex: 1; max-width: 400px;">
                            <svg style="position: absolute; left: 14px; top: 50%; transform: translateY(-50%); width: 18px; height: 18px; color: #9ca3af; pointer-events: none; z-index: 10;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                            </svg>
                            <input type="text" 
                                   wire:model.live="agentSearch"
                                   placeholder="Search agents by name..."
                                   style="
                                       width: 100%;
                                       height: 40px;
                                       padding: 0 16px 0 44px;
                                       font-size: 14px;
                                       color: #111827;
                                       background: #ffffff;
                                       border: 1px solid #d1d5db;
                                       border-radius: 8px;
                                       outline: none;
                                       transition: all 0.2s ease;
                                       position: relative;
                                   "
                                   onfocus="this.style.borderColor='#6366f1'; this.style.boxShadow='0 0 0 3px rgba(99, 102, 241, 0.1)'"
                                   onblur="this.style.borderColor='#d1d5db'; this.style.boxShadow='none'"
                                   title="Search agents by name or ID">
                        </div>
                        
                        {{-- Refresh Button - Fixed Height --}}
                        <button wire:click="loadAgents" 
                                style="
                                    display: inline-flex;
                                    align-items: center;
                                    justify-content: center;
                                    height: 40px;
                                    padding: 0 16px;
                                    font-size: 14px;
                                    font-weight: 500;
                                    border-radius: 8px;
                                    background-color: #f3f4f6;
                                    color: #374151;
                                    border: none;
                                    cursor: pointer;
                                    transition: all 0.2s ease;
                                    white-space: nowrap;
                                "
                                onmouseover="this.style.backgroundColor='#e5e7eb'"
                                onmouseout="this.style.backgroundColor='#f3f4f6'"
                                title="Refresh agent list">
                            <svg style="width: 16px; height: 16px; margin-right: 6px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                            </svg>
                            Refresh
                        </button>
                        
                        {{-- Help Tooltip - Fixed Size --}}
                        <div style="position: relative; display: inline-block;">
                            <button style="
                                width: 40px;
                                height: 40px;
                                border-radius: 50%;
                                background-color: #f3f4f6;
                                border: none;
                                cursor: help;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                transition: all 0.2s ease;
                            "
                            onmouseover="this.style.backgroundColor='#e5e7eb'; this.nextElementSibling.style.display='block'"
                            onmouseout="this.style.backgroundColor='#f3f4f6'; this.nextElementSibling.style.display='none'">
                                <svg style="width: 18px; height: 18px; color: #6b7280;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                            </button>
                            <div style="
                                display: none;
                                position: absolute;
                                z-index: 50;
                                top: 100%;
                                left: 50%;
                                transform: translateX(-50%);
                                margin-top: 8px;
                                padding: 12px 16px;
                                background-color: #1f2937;
                                color: white;
                                font-size: 13px;
                                border-radius: 6px;
                                white-space: nowrap;
                                box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
                            ">
                                <div style="font-weight: 600; margin-bottom: 4px;">Agent Management</div>
                                <div style="color: #d1d5db; max-width: 250px; white-space: normal;">
                                    Manage your Retell.ai phone agents here.<br/>
                                    Each agent can have multiple versions.
                                </div>
                                <div style="
                                    position: absolute;
                                    top: -4px;
                                    left: 50%;
                                    transform: translateX(-50%);
                                    width: 8px;
                                    height: 8px;
                                    background-color: #1f2937;
                                    transform: rotate(45deg);
                                "></div>
                            </div>
                        </div>
                    </div>
                    
                    {{-- Create Agent Button - Fixed Height --}}
                    <button wire:click="openAgentCreator" 
                            style="
                                display: inline-flex;
                                align-items: center;
                                justify-content: center;
                                height: 40px;
                                padding: 0 20px;
                                font-size: 14px;
                                font-weight: 600;
                                border-radius: 8px;
                                background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
                                color: white;
                                border: none;
                                cursor: pointer;
                                transition: all 0.2s ease;
                                box-shadow: 0 2px 4px rgba(99, 102, 241, 0.2);
                                white-space: nowrap;
                            "
                            onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 8px rgba(99, 102, 241, 0.3)'"
                            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 4px rgba(99, 102, 241, 0.2)'"
                            title="Create a new agent">
                        <svg style="width: 16px; height: 16px; margin-right: 8px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                        </svg>
                        Create Agent
                    </button>
                </div>
                
                @if(count($agents) > 0)
                    <div class="agent-card-grid">
                        @foreach($agents as $agent)
                            @php
                            // Prepare agent data with all versions for the component
                            $agentData = $agent;
                            $agentData['all_versions'] = [];
                            
                            // Get all versions for this agent base name
                            if (isset($agent['base_name'])) {
                                for ($i = 1; $i <= ($agent['total_versions'] ?? 1); $i++) {
                                    $agentData['all_versions'][] = [
                                        'version' => 'V' . $i,
                                        'is_active' => ($agent['active_version']['version'] ?? '') === 'V' . $i
                                    ];
                                }
                            }
                            @endphp
                            
                            <x-retell-agent-card 
                                :agent="$agentData"
                                :globalState="$globalState ?? []"
                                wire:key="{{ $agent['agent_id'] ?? uniqid() }}"
                            />
                        @endforeach
                    </div>
                @else
                    <div class="modern-card text-center py-8">
                        <svg class="w-12 h-12 mx-auto mb-3 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                        </svg>
                        <p class="text-gray-500 text-sm">No agents found. Create your first agent to get started.</p>
                        <button wire:click="openAgentCreator" class="modern-btn modern-btn-primary mt-3">
                            Create Agent
                        </button>
                    </div>
                @endif
            </div>
            
            {{-- Functions Tab --}}
            <div x-show="activeTab === 'functions'" x-transition>
                {{-- Header with Search and Filters --}}
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 24px; flex-wrap: wrap; gap: 16px;">
                    {{-- Search Bar - Fixed No Overlap --}}
                    <div style="position: relative; flex: 1; max-width: 400px;">
                        <svg style="position: absolute; left: 14px; top: 50%; transform: translateY(-50%); width: 18px; height: 18px; color: #9ca3af; pointer-events: none; z-index: 10;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                        <input 
                            type="text" 
                            wire:model.live="functionSearchTerm"
                            placeholder="Search functions..."
                            style="width: 100%; height: 40px; padding: 0 16px 0 44px; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 14px; color: #111827; background: #ffffff; transition: all 0.2s ease; outline: none;"
                            onfocus="this.style.borderColor='#6366f1'; this.style.boxShadow='0 0 0 3px rgba(99, 102, 241, 0.1)';"
                            onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';"
                        />
                    </div>
                    
                    {{-- Filter Controls --}}
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <select 
                            wire:model.live="functionTypeFilter"
                            style="height: 40px; padding: 0 36px 0 12px; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 14px; color: #374151; background: #ffffff; cursor: pointer; transition: all 0.2s ease; outline: none; appearance: none; background-image: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"%236b7280\"><path fill-rule=\"evenodd\" d=\"M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z\" clip-rule=\"evenodd\"/></svg>'); background-position: right 8px center; background-size: 20px; background-repeat: no-repeat;"
                            onfocus="this.style.borderColor='#6366f1'; this.style.boxShadow='0 0 0 3px rgba(99, 102, 241, 0.1)';"
                            onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';"
                        >
                            <option value="">All Types</option>
                            <option value="cal_com">Cal.com</option>
                            <option value="custom">Custom</option>
                            <option value="database">Database</option>
                            <option value="system">System</option>
                        </select>
                        
                        <button 
                            wire:click="openFunctionBuilder"
                            style="display: inline-flex; align-items: center; justify-content: center; gap: 8px; height: 40px; padding: 0 20px; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: white; border: none; border-radius: 8px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); white-space: nowrap;"
                            onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)';"
                            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 1px 2px 0 rgba(0, 0, 0, 0.05)';"
                        >
                            <svg style="width: 16px; height: 16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                            </svg>
                            Add Function
                        </button>
                    </div>
                </div>
                
                {{-- Agent Selection Card --}}
                <div style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px; box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); margin-bottom: 24px;">
                    <div style="display: flex; align-items: center; justify-content: space-between; gap: 16px; flex-wrap: wrap;">
                        <div>
                            <h3 style="font-size: 16px; font-weight: 600; color: #111827; margin: 0;">Selected Agent</h3>
                            <p style="font-size: 14px; color: #6b7280; margin-top: 4px;">View and manage functions for the selected agent</p>
                        </div>
                        <select 
                            wire:model.live="selectedAgentId"
                            style="padding: 10px 40px 10px 16px; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 14px; color: #111827; background: #ffffff; cursor: pointer; transition: all 0.2s ease; outline: none; appearance: none; background-image: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"%236b7280\"><path fill-rule=\"evenodd\" d=\"M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z\" clip-rule=\"evenodd\"/></svg>'); background-position: right 12px center; background-size: 20px; background-repeat: no-repeat; min-width: 250px;"
                            onfocus="this.style.borderColor='#6366f1'; this.style.boxShadow='0 0 0 3px rgba(99, 102, 241, 0.1)';"
                            onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';"
                        >
                            <option value="">Choose an agent...</option>
                            @foreach($groupedAgents ?? [] as $baseName => $agentGroup)
                                @php
                                    $mainAgent = collect($agentGroup['versions'] ?? [])->first();
                                @endphp
                                @if($mainAgent)
                                    <option value="{{ $mainAgent['agent_id'] }}">
                                        {{ $baseName }} - {{ $mainAgent['version'] ?? 'V1' }}
                                        @if($mainAgent['is_active']) ‚úì Active @endif
                                    </option>
                                @endif
                            @endforeach
                        </select>
                    </div>
                </div>
                
                @if($selectedAgentId && isset($agentFunctions))
                    {{-- Functions Grid --}}
                    @if(count($agentFunctions) > 0)
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(380px, 1fr)); gap: 20px;">
                            @foreach($agentFunctions as $function)
                                <div style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px; transition: all 0.2s ease; position: relative; overflow: hidden;" 
                                    onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)'; this.style.borderColor='#6366f1';"
                                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 1px 2px 0 rgba(0, 0, 0, 0.05)'; this.style.borderColor='#e5e7eb';">
                                    
                                    {{-- Function Type Indicator --}}
                                    <div style="position: absolute; top: 0; right: 0; width: 80px; height: 80px; opacity: 0.1;">
                                        @if($function['type'] === 'cal_com')
                                            <svg style="width: 100%; height: 100%; color: #6366f1;" fill="currentColor" viewBox="0 0 24 24">
                                                <path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"/>
                                            </svg>
                                        @elseif($function['type'] === 'database')
                                            <svg style="width: 100%; height: 100%; color: #3b82f6;" fill="currentColor" viewBox="0 0 24 24">
                                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                                            </svg>
                                        @else
                                            <svg style="width: 100%; height: 100%; color: #8b5cf6;" fill="currentColor" viewBox="0 0 24 24">
                                                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                            </svg>
                                        @endif
                                    </div>
                                    
                                    {{-- Header --}}
                                    <div style="display: flex; align-items: start; justify-content: space-between; margin-bottom: 16px; position: relative; z-index: 1;">
                                        <div style="flex: 1;">
                                            <h4 style="font-size: 16px; font-weight: 600; color: #111827; margin: 0 0 4px 0;">{{ $function['name'] ?? 'Unnamed Function' }}</h4>
                                            <p style="font-size: 14px; color: #6b7280; margin: 0; line-height: 1.5;">{{ Str::limit($function['description'] ?? 'No description', 80) }}</p>
                                        </div>
                                        <div style="display: flex; gap: 4px; margin-left: 12px;">
                                            <button 
                                                wire:click="editFunction('{{ $function['name'] }}')"
                                                style="padding: 8px; border: none; background: transparent; cursor: pointer; border-radius: 6px; transition: all 0.2s ease;"
                                                onmouseover="this.style.background='#f3f4f6';"
                                                onmouseout="this.style.background='transparent';"
                                            >
                                                <svg style="width: 16px; height: 16px; color: #6b7280;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                                </svg>
                                            </button>
                                            <button 
                                                wire:click="testFunction('{{ $function['name'] }}')"
                                                style="padding: 8px; border: none; background: transparent; cursor: pointer; border-radius: 6px; transition: all 0.2s ease;"
                                                onmouseover="this.style.background='#f0f9ff';"
                                                onmouseout="this.style.background='transparent';"
                                            >
                                                <svg style="width: 16px; height: 16px; color: #3b82f6;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path>
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                                </svg>
                                            </button>
                                            <button 
                                                wire:click="deleteFunction('{{ $function['name'] }}')"
                                                wire:confirm="Are you sure you want to delete this function?"
                                                style="padding: 8px; border: none; background: transparent; cursor: pointer; border-radius: 6px; transition: all 0.2s ease;"
                                                onmouseover="this.style.background='#fef2f2';"
                                                onmouseout="this.style.background='transparent';"
                                            >
                                                <svg style="width: 16px; height: 16px; color: #ef4444;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    
                                    {{-- Function Details --}}
                                    <div style="display: flex; flex-wrap: wrap; gap: 12px; margin-bottom: 16px;">
                                        <div style="display: inline-flex; align-items: center; gap: 4px; padding: 4px 12px; background: #f3f4f6; border-radius: 6px;">
                                            <span style="font-size: 12px; color: #6b7280;">Type:</span>
                                            <span style="font-size: 12px; font-weight: 500; color: {{ $function['type'] === 'cal_com' ? '#6366f1' : ($function['type'] === 'database' ? '#3b82f6' : '#8b5cf6') }};">{{ ucfirst($function['type'] ?? 'custom') }}</span>
                                        </div>
                                        <div style="display: inline-flex; align-items: center; gap: 4px; padding: 4px 12px; background: #f3f4f6; border-radius: 6px;">
                                            <span style="font-size: 12px; color: #6b7280;">Method:</span>
                                            <span style="font-size: 12px; font-weight: 500; color: #111827; font-family: monospace;">{{ $function['method'] ?? 'POST' }}</span>
                                        </div>
                                        @if(isset($function['parameters']) && count($function['parameters']) > 0)
                                            <div style="display: inline-flex; align-items: center; gap: 4px; padding: 4px 12px; background: #fef3c7; border-radius: 6px;">
                                                <span style="font-size: 12px; color: #92400e;">{{ count($function['parameters']) }} parameters</span>
                                            </div>
                                        @endif
                                    </div>
                                    
                                    {{-- URL Display --}}
                                    @if(isset($function['url']))
                                        <div style="padding: 12px; background: #f9fafb; border-radius: 8px; margin-bottom: 16px;">
                                            <p style="font-size: 12px; color: #6b7280; margin: 0 0 4px 0;">Endpoint:</p>
                                            <p style="font-size: 13px; color: #111827; font-family: monospace; margin: 0; word-break: break-all;">{{ $function['url'] }}</p>
                                        </div>
                                    @endif
                                    
                                    {{-- Action Buttons --}}
                                    <div style="display: flex; gap: 8px; padding-top: 16px; border-top: 1px solid #e5e7eb;">
                                        <button 
                                            wire:click="duplicateFunction('{{ $function['name'] }}')"
                                            style="flex: 1; padding: 8px 16px; background: #ffffff; border: 1px solid #e5e7eb; border-radius: 6px; font-size: 13px; color: #374151; cursor: pointer; transition: all 0.2s ease;"
                                            onmouseover="this.style.borderColor='#6366f1'; this.style.color='#6366f1';"
                                            onmouseout="this.style.borderColor='#e5e7eb'; this.style.color='#374151';"
                                        >
                                            Duplicate
                                        </button>
                                        <button 
                                            wire:click="viewFunctionLogs('{{ $function['name'] }}')"
                                            style="flex: 1; padding: 8px 16px; background: #ffffff; border: 1px solid #e5e7eb; border-radius: 6px; font-size: 13px; color: #374151; cursor: pointer; transition: all 0.2s ease;"
                                            onmouseover="this.style.borderColor='#6366f1'; this.style.color='#6366f1';"
                                            onmouseout="this.style.borderColor='#e5e7eb'; this.style.color='#374151';"
                                        >
                                            View Logs
                                        </button>
                                    </div>
                                </div>
                            @endforeach
                        </div>
                    @else
                        <div style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 48px; text-align: center;">
                            <svg style="width: 48px; height: 48px; margin: 0 auto 16px; color: #9ca3af;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path>
                            </svg>
                            <h3 style="font-size: 16px; font-weight: 600; color: #111827; margin: 0 0 8px 0;">No functions configured</h3>
                            <p style="font-size: 14px; color: #6b7280; margin: 0 0 24px 0;">Get started by adding your first function to this agent.</p>
                            <button 
                                wire:click="openFunctionBuilder"
                                style="display: inline-flex; align-items: center; gap: 8px; padding: 10px 24px; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: white; border: none; border-radius: 8px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s ease;"
                                onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)';"
                                onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none';"
                            >
                                <svg style="width: 16px; height: 16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                                </svg>
                                Add Your First Function
                            </button>
                        </div>
                    @endif
                @else
                    <div style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 48px; text-align: center;">
                        <svg style="width: 48px; height: 48px; margin: 0 auto 16px; color: #9ca3af;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                        </svg>
                        <h3 style="font-size: 16px; font-weight: 600; color: #111827; margin: 0 0 8px 0;">Select an Agent</h3>
                        <p style="font-size: 14px; color: #6b7280; margin: 0;">Please select an agent from the dropdown above to view and manage its functions.</p>
                    </div>
                @endif
            </div>
            
            {{-- Webhooks Tab --}}
            <div x-show="activeTab === 'webhooks'" x-transition>
                {{-- Header --}}
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 24px; flex-wrap: wrap; gap: 16px;">
                    <div>
                        <h2 style="font-size: 20px; font-weight: 700; color: #111827; margin: 0;">Webhook Configuration</h2>
                        <p style="font-size: 14px; color: #6b7280; margin-top: 4px;">Manage webhook endpoints and event subscriptions</p>
                    </div>
                    <button 
                        wire:click="addWebhook"
                        style="display: inline-flex; align-items: center; gap: 8px; padding: 10px 20px; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: white; border: none; border-radius: 8px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);"
                        onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)';"
                        onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 1px 2px 0 rgba(0, 0, 0, 0.05)';"
                    >
                        <svg style="width: 16px; height: 16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                        </svg>
                        Add Webhook
                    </button>
                </div>
                
                {{-- Webhook Types Grid --}}
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 32px;">
                    {{-- Call Started --}}
                    <div style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px; transition: all 0.2s ease;" 
                        onmouseover="this.style.borderColor='#10b981'; this.style.boxShadow='0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)';"
                        onmouseout="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';">
                        <div style="display: flex; align-items: start; gap: 12px;">
                            <div style="padding: 10px; background: #d1fae5; border-radius: 8px;">
                                <svg style="width: 20px; height: 20px; color: #10b981;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                                </svg>
                            </div>
                            <div style="flex: 1;">
                                <h4 style="font-size: 16px; font-weight: 600; color: #111827; margin: 0 0 4px 0;">call_started</h4>
                                <p style="font-size: 14px; color: #6b7280; margin: 0 0 12px 0;">Triggered when an incoming call begins</p>
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <span style="width: 8px; height: 8px; background: #10b981; border-radius: 50%;"></span>
                                    <span style="font-size: 13px; color: #10b981; font-weight: 500;">Active</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    {{-- Call Ended --}}
                    <div style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px; transition: all 0.2s ease;" 
                        onmouseover="this.style.borderColor='#3b82f6'; this.style.boxShadow='0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)';"
                        onmouseout="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';">
                        <div style="display: flex; align-items: start; gap: 12px;">
                            <div style="padding: 10px; background: #dbeafe; border-radius: 8px;">
                                <svg style="width: 20px; height: 20px; color: #3b82f6;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 8l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2M5 3a2 2 0 00-2 2v1c0 8.284 6.716 15 15 15h1a2 2 0 002-2v-3.28a1 1 0 00-.684-.948l-4.493-1.498a1 1 0 00-1.21.502l-1.13 2.257a11.042 11.042 0 01-5.516-5.516l2.257-1.128a1 1 0 00.502-1.21L9.228 3.683A1 1 0 008.279 3H5z"></path>
                                </svg>
                            </div>
                            <div style="flex: 1;">
                                <h4 style="font-size: 16px; font-weight: 600; color: #111827; margin: 0 0 4px 0;">call_ended</h4>
                                <p style="font-size: 14px; color: #6b7280; margin: 0 0 12px 0;">Fired when a call is completed</p>
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <span style="width: 8px; height: 8px; background: #3b82f6; border-radius: 50%;"></span>
                                    <span style="font-size: 13px; color: #3b82f6; font-weight: 500;">Active</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    {{-- Call Analyzed --}}
                    <div style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px; transition: all 0.2s ease;" 
                        onmouseover="this.style.borderColor='#8b5cf6'; this.style.boxShadow='0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)';"
                        onmouseout="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';">
                        <div style="display: flex; align-items: start; gap: 12px;">
                            <div style="padding: 10px; background: #ede9fe; border-radius: 8px;">
                                <svg style="width: 20px; height: 20px; color: #8b5cf6;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                                </svg>
                            </div>
                            <div style="flex: 1;">
                                <h4 style="font-size: 16px; font-weight: 600; color: #111827; margin: 0 0 4px 0;">call_analyzed</h4>
                                <p style="font-size: 14px; color: #6b7280; margin: 0 0 12px 0;">Sent after call analysis is complete</p>
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <span style="width: 8px; height: 8px; background: #8b5cf6; border-radius: 50%;"></span>
                                    <span style="font-size: 13px; color: #8b5cf6; font-weight: 500;">Active</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                {{-- Webhook Endpoints --}}
                <div style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
                    <h3 style="font-size: 18px; font-weight: 600; color: #111827; margin: 0 0 20px 0;">Configured Endpoints</h3>
                    
                    {{-- Primary Webhook --}}
                    <div style="background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <div style="width: 10px; height: 10px; background: #10b981; border-radius: 50%; box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.2);"></div>
                                <h4 style="font-size: 16px; font-weight: 600; color: #111827; margin: 0;">Primary Endpoint</h4>
                                <span style="padding: 2px 8px; background: #10b981; color: white; font-size: 11px; font-weight: 500; border-radius: 4px;">VERIFIED</span>
                            </div>
                            <div style="display: flex; gap: 8px;">
                                <button 
                                    style="padding: 6px 12px; background: #ffffff; border: 1px solid #e5e7eb; border-radius: 6px; font-size: 13px; color: #374151; cursor: pointer; transition: all 0.2s ease;"
                                    onmouseover="this.style.borderColor='#6366f1'; this.style.color='#6366f1';"
                                    onmouseout="this.style.borderColor='#e5e7eb'; this.style.color='#374151';"
                                >
                                    Test
                                </button>
                                <button 
                                    style="padding: 6px 12px; background: #ffffff; border: 1px solid #e5e7eb; border-radius: 6px; font-size: 13px; color: #374151; cursor: pointer; transition: all 0.2s ease;"
                                    onmouseover="this.style.borderColor='#6366f1'; this.style.color='#6366f1';"
                                    onmouseout="this.style.borderColor='#e5e7eb'; this.style.color='#374151';"
                                >
                                    Edit
                                </button>
                            </div>
                        </div>
                        <div style="padding: 12px; background: #ffffff; border: 1px solid #e5e7eb; border-radius: 6px; font-family: monospace; font-size: 13px; color: #111827; word-break: break-all;">
                            https://api.askproai.de/api/retell/webhook
                        </div>
                        <div style="display: flex; gap: 16px; margin-top: 12px;">
                            <div style="display: flex; align-items: center; gap: 6px;">
                                <svg style="width: 14px; height: 14px; color: #6b7280;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                <span style="font-size: 12px; color: #6b7280;">Last triggered: 2 minutes ago</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 6px;">
                                <svg style="width: 14px; height: 14px; color: #6b7280;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                <span style="font-size: 12px; color: #6b7280;">Success rate: 99.8%</span>
                            </div>
                        </div>
                    </div>
                    
                    {{-- Backup Webhook --}}
                    <div style="background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px; padding: 16px; opacity: 0.7;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <div style="width: 10px; height: 10px; background: #6b7280; border-radius: 50%;"></div>
                                <h4 style="font-size: 16px; font-weight: 600; color: #111827; margin: 0;">Backup Endpoint</h4>
                                <span style="padding: 2px 8px; background: #6b7280; color: white; font-size: 11px; font-weight: 500; border-radius: 4px;">INACTIVE</span>
                            </div>
                            <button 
                                style="padding: 6px 12px; background: #ffffff; border: 1px solid #e5e7eb; border-radius: 6px; font-size: 13px; color: #374151; cursor: pointer; transition: all 0.2s ease;"
                                onmouseover="this.style.borderColor='#10b981'; this.style.color='#10b981';"
                                onmouseout="this.style.borderColor='#e5e7eb'; this.style.color='#374151';"
                            >
                                Activate
                            </button>
                        </div>
                        <div style="padding: 12px; background: #ffffff; border: 1px solid #e5e7eb; border-radius: 6px; font-family: monospace; font-size: 13px; color: #6b7280;">
                            Not configured
                        </div>
                    </div>
                </div>
                
                {{-- Webhook Security --}}
                <div style="background: #fef3c7; border: 1px solid #fcd34d; border-radius: 12px; padding: 20px;">
                    <div style="display: flex; gap: 12px; align-items: start;">
                        <svg style="width: 20px; height: 20px; color: #f59e0b; flex-shrink: 0;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                        </svg>
                        <div>
                            <h4 style="font-size: 16px; font-weight: 600; color: #92400e; margin: 0 0 4px 0;">Webhook Security</h4>
                            <p style="font-size: 14px; color: #92400e; margin: 0;">All webhooks are secured with HMAC-SHA256 signatures. Your webhook secret is stored encrypted and never exposed in the UI.</p>
                        </div>
                    </div>
                </div>
            </div>
            
            {{-- Phones Tab --}}
            <div x-show="activeTab === 'phones'" x-transition>
                {{-- Header --}}
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 24px; flex-wrap: wrap; gap: 16px;">
                    <div>
                        <h2 style="font-size: 20px; font-weight: 700; color: #111827; margin: 0;">Phone Numbers</h2>
                        <p style="font-size: 14px; color: #6b7280; margin-top: 4px;">Manage your phone numbers and agent assignments</p>
                    </div>
                    <button 
                        wire:click="addPhoneNumber"
                        style="display: inline-flex; align-items: center; gap: 8px; padding: 10px 20px; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: white; border: none; border-radius: 8px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);"
                        onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)';"
                        onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 1px 2px 0 rgba(0, 0, 0, 0.05)';"
                    >
                        <svg style="width: 16px; height: 16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                        </svg>
                        Add Phone Number
                    </button>
                </div>
                
                {{-- Phone Numbers Grid --}}
                @if(count($phoneNumbers) > 0)
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(380px, 1fr)); gap: 20px;">
                        @foreach($phoneNumbers as $phone)
                            <div style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px; transition: all 0.2s ease; position: relative; overflow: hidden;"
                                onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)'; this.style.borderColor='#6366f1';"
                                onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 1px 2px 0 rgba(0, 0, 0, 0.05)'; this.style.borderColor='#e5e7eb';">
                                
                                {{-- Status Indicator --}}
                                @if(($phone['status'] ?? 'inactive') === 'active')
                                    <div style="position: absolute; top: 20px; right: 20px;">
                                        <div style="position: relative;">
                                            <span style="display: block; width: 12px; height: 12px; background: #10b981; border-radius: 50%; box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.2);"></span>
                                            <span style="position: absolute; top: 0; left: 0; width: 12px; height: 12px; background: #10b981; border-radius: 50%; animation: ping 1s cubic-bezier(0, 0, 0.2, 1) infinite;"></span>
                                        </div>
                                    </div>
                                @endif
                                
                                {{-- Phone Number Header --}}
                                <div style="margin-bottom: 16px;">
                                    <h3 style="font-size: 18px; font-weight: 600; color: #111827; margin: 0 0 4px 0;">{{ $phone['phone_number'] ?? 'Unknown' }}</h3>
                                    @if($phone['nickname'] ?? null)
                                        <p style="font-size: 14px; color: #6b7280; margin: 0;">{{ $phone['nickname'] }}</p>
                                    @endif
                                </div>
                                
                                {{-- Agent Assignment --}}
                                <div style="padding: 16px; background: #f9fafb; border-radius: 8px; margin-bottom: 16px;">
                                    <p style="font-size: 12px; font-weight: 500; color: #6b7280; margin: 0 0 8px 0; text-transform: uppercase; letter-spacing: 0.5px;">Assigned Agent</p>
                                    @if(isset($phone['agent_name']))
                                        <div style="display: flex; align-items: center; gap: 8px; flex-wrap: wrap;">
                                            <span style="font-size: 15px; font-weight: 600; color: #111827;">{{ $phone['agent_name'] }}</span>
                                            <span style="padding: 2px 10px; background: #6366f1; color: white; font-size: 11px; font-weight: 600; border-radius: 12px;">{{ $phone['agent_version'] ?? 'V1' }}</span>
                                            @if($phone['agent_is_active'] ?? false)
                                                <span style="display: inline-flex; align-items: center; gap: 4px; padding: 2px 8px; background: #d1fae5; color: #065f46; font-size: 11px; font-weight: 500; border-radius: 4px;">
                                                    <svg style="width: 12px; height: 12px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
                                                    </svg>
                                                    Active
                                                </span>
                                            @else
                                                <span style="padding: 2px 8px; background: #f3f4f6; color: #6b7280; font-size: 11px; font-weight: 500; border-radius: 4px;">Inactive</span>
                                            @endif
                                        </div>
                                    @else
                                        <p style="font-size: 14px; color: #9ca3af; font-style: italic; margin: 0;">No agent assigned</p>
                                    @endif
                                </div>
                                
                                {{-- Agent Selection --}}
                                <div style="margin-bottom: 16px;">
                                    <label style="display: block; font-size: 12px; font-weight: 500; color: #6b7280; margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.5px;">Change Agent Assignment</label>
                                    <select 
                                        wire:change="assignAgentToPhone('{{ $phone['phone_number'] ?? '' }}', $event.target.value)"
                                        style="width: 100%; padding: 10px 36px 10px 12px; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 14px; color: #111827; background: #ffffff; cursor: pointer; transition: all 0.2s ease; outline: none; appearance: none; background-image: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"%236b7280\"><path fill-rule=\"evenodd\" d=\"M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z\" clip-rule=\"evenodd\"/></svg>'); background-position: right 8px center; background-size: 20px; background-repeat: no-repeat;"
                                        onfocus="this.style.borderColor='#6366f1'; this.style.boxShadow='0 0 0 3px rgba(99, 102, 241, 0.1)';"
                                        onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none';"
                                    >
                                        <option value="">Select Agent Version</option>
                                        @foreach($agents as $agent)
                                            <option value="{{ $agent['agent_id'] }}" @if(isset($phone['agent_id']) && $phone['agent_id'] === $agent['agent_id']) selected @endif>
                                                {{ $agent['display_name'] }} {{ $agent['version'] ?? 'V1' }}
                                                @if($agent['is_active'] ?? false) (Active) @endif
                                            </option>
                                        @endforeach
                                    </select>
                                </div>
                                
                                {{-- Phone Actions --}}
                                <div style="display: flex; gap: 8px;">
                                    <button 
                                        wire:click="testPhoneNumber('{{ $phone['phone_number'] ?? '' }}')"
                                        style="flex: 1; padding: 8px 16px; background: #ffffff; border: 1px solid #e5e7eb; border-radius: 6px; font-size: 13px; color: #374151; cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; justify-content: center; gap: 6px;"
                                        onmouseover="this.style.borderColor='#10b981'; this.style.color='#10b981';"
                                        onmouseout="this.style.borderColor='#e5e7eb'; this.style.color='#374151';"
                                    >
                                        <svg style="width: 14px; height: 14px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                                        </svg>
                                        Test Call
                                    </button>
                                    <button 
                                        wire:click="editPhoneNumber('{{ $phone['phone_number'] ?? '' }}')"
                                        style="flex: 1; padding: 8px 16px; background: #ffffff; border: 1px solid #e5e7eb; border-radius: 6px; font-size: 13px; color: #374151; cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; justify-content: center; gap: 6px;"
                                        onmouseover="this.style.borderColor='#6366f1'; this.style.color='#6366f1';"
                                        onmouseout="this.style.borderColor='#e5e7eb'; this.style.color='#374151';"
                                    >
                                        <svg style="width: 14px; height: 14px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                                        </svg>
                                        Configure
                                    </button>
                                </div>
                            </div>
                        @endforeach
                    </div>
                @else
                    <div style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 48px; text-align: center;">
                        <svg style="width: 48px; height: 48px; margin: 0 auto 16px; color: #9ca3af;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                        </svg>
                        <h3 style="font-size: 16px; font-weight: 600; color: #111827; margin: 0 0 8px 0;">No phone numbers configured</h3>
                        <p style="font-size: 14px; color: #6b7280; margin: 0;">Add your first phone number to start receiving calls.</p>
                    </div>
                @endif
                
                {{-- Pulse animation keyframes --}}
                <style>
                    @keyframes ping {
                        75%, 100% {
                            transform: scale(2);
                            opacity: 0;
                        }
                    }
                </style>
            </div>
            
            {{-- Settings Tab --}}
            <div x-show="activeTab === 'settings'" x-transition>
                {{-- Header --}}
                <div style="margin-bottom: 24px;">
                    <h2 style="font-size: 20px; font-weight: 700; color: #111827; margin: 0;">Settings</h2>
                    <p style="font-size: 14px; color: #6b7280; margin-top: 4px;">Configure your control center preferences and integrations</p>
                </div>
                
                <div style="display: grid; grid-template-columns: 300px 1fr; gap: 24px;">
                    {{-- Settings Navigation --}}
                    <div style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 8px; height: fit-content;">
                        <button 
                            style="width: 100%; padding: 12px 16px; text-align: left; background: #f3f4f6; border: none; border-radius: 8px; font-size: 14px; font-weight: 500; color: #111827; cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; gap: 12px;"
                            onclick="this.style.background='#e0e7ff'; this.style.color='#4338ca';"
                        >
                            <svg style="width: 16px; height: 16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path>
                            </svg>
                            General Settings
                        </button>
                        <button 
                            style="width: 100%; padding: 12px 16px; text-align: left; background: transparent; border: none; border-radius: 8px; font-size: 14px; font-weight: 500; color: #6b7280; cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; gap: 12px;"
                            onmouseover="this.style.background='#f9fafb'; this.style.color='#111827';"
                            onmouseout="this.style.background='transparent'; this.style.color='#6b7280';"
                        >
                            <svg style="width: 16px; height: 16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            API Keys
                        </button>
                        <button 
                            style="width: 100%; padding: 12px 16px; text-align: left; background: transparent; border: none; border-radius: 8px; font-size: 14px; font-weight: 500; color: #6b7280; cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; gap: 12px;"
                            onmouseover="this.style.background='#f9fafb'; this.style.color='#111827';"
                            onmouseout="this.style.background='transparent'; this.style.color='#6b7280';"
                        >
                            <svg style="width: 16px; height: 16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
                            </svg>
                            Notifications
                        </button>
                        <button 
                            style="width: 100%; padding: 12px 16px; text-align: left; background: transparent; border: none; border-radius: 8px; font-size: 14px; font-weight: 500; color: #6b7280; cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; gap: 12px;"
                            onmouseover="this.style.background='#f9fafb'; this.style.color='#111827';"
                            onmouseout="this.style.background='transparent'; this.style.color='#6b7280';"
                        >
                            <svg style="width: 16px; height: 16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                            </svg>
                            Security
                        </button>
                    </div>
                    
                    {{-- Settings Content --}}
                    <div style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 24px;">
                        {{-- General Settings Section --}}
                        <div style="margin-bottom: 32px;">
                            <h3 style="font-size: 18px; font-weight: 600; color: #111827; margin: 0 0 20px 0;">General Settings</h3>
                            
                            {{-- AI Assistant Toggle --}}
                            <div style="display: flex; align-items: center; justify-content: space-between; padding: 16px; background: #f9fafb; border-radius: 8px; margin-bottom: 16px;">
                                <div>
                                    <h4 style="font-size: 15px; font-weight: 500; color: #111827; margin: 0 0 4px 0;">AI Assistant</h4>
                                    <p style="font-size: 13px; color: #6b7280; margin: 0;">Enable AI-powered suggestions and insights</p>
                                </div>
                                <label style="position: relative; display: inline-block; width: 48px; height: 24px;">
                                    <input type="checkbox" wire:model="aiAssistantEnabled" style="opacity: 0; width: 0; height: 0;">
                                    <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: {{ $aiAssistantEnabled ? '#6366f1' : '#e5e7eb' }}; transition: .4s; border-radius: 24px;">
                                        <span style="position: absolute; content: ''; height: 16px; width: 16px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; transform: {{ $aiAssistantEnabled ? 'translateX(24px)' : 'translateX(0)' }};"></span>
                                    </span>
                                </label>
                            </div>
                            
                            {{-- Auto-refresh Toggle --}}
                            <div style="display: flex; align-items: center; justify-content: space-between; padding: 16px; background: #f9fafb; border-radius: 8px; margin-bottom: 16px;">
                                <div>
                                    <h4 style="font-size: 15px; font-weight: 500; color: #111827; margin: 0 0 4px 0;">Auto-refresh Data</h4>
                                    <p style="font-size: 13px; color: #6b7280; margin: 0;">Automatically refresh metrics every 30 seconds</p>
                                </div>
                                <label style="position: relative; display: inline-block; width: 48px; height: 24px;">
                                    <input type="checkbox" checked style="opacity: 0; width: 0; height: 0;">
                                    <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #6366f1; transition: .4s; border-radius: 24px;">
                                        <span style="position: absolute; content: ''; height: 16px; width: 16px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; transform: translateX(24px);"></span>
                                    </span>
                                </label>
                            </div>
                            
                            {{-- Theme Selection --}}
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; font-size: 14px; font-weight: 500; color: #111827; margin-bottom: 8px;">Dashboard Theme</label>
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
                                    <button 
                                        style="padding: 12px; border: 2px solid #6366f1; background: #ffffff; border-radius: 8px; cursor: pointer; transition: all 0.2s ease;"
                                        onclick="this.style.background='#f0f9ff';"
                                    >
                                        <svg style="width: 24px; height: 24px; margin: 0 auto 4px; color: #374151;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                                        </svg>
                                        <span style="font-size: 13px; color: #374151; font-weight: 500;">Light</span>
                                    </button>
                                    <button 
                                        style="padding: 12px; border: 2px solid #e5e7eb; background: #ffffff; border-radius: 8px; cursor: pointer; transition: all 0.2s ease;"
                                        onmouseover="this.style.borderColor='#6366f1';"
                                        onmouseout="this.style.borderColor='#e5e7eb';"
                                    >
                                        <svg style="width: 24px; height: 24px; margin: 0 auto 4px; color: #374151;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                                        </svg>
                                        <span style="font-size: 13px; color: #374151; font-weight: 500;">Dark</span>
                                    </button>
                                    <button 
                                        style="padding: 12px; border: 2px solid #e5e7eb; background: #ffffff; border-radius: 8px; cursor: pointer; transition: all 0.2s ease;"
                                        onmouseover="this.style.borderColor='#6366f1';"
                                        onmouseout="this.style.borderColor='#e5e7eb';"
                                    >
                                        <svg style="width: 24px; height: 24px; margin: 0 auto 4px; color: #374151;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                                        </svg>
                                        <span style="font-size: 13px; color: #374151; font-weight: 500;">System</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        {{-- Save Button --}}
                        <div style="display: flex; justify-content: flex-end; padding-top: 24px; border-top: 1px solid #e5e7eb;">
                            <button 
                                wire:click="saveSettings"
                                style="display: inline-flex; align-items: center; gap: 8px; padding: 10px 24px; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: white; border: none; border-radius: 8px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s ease;"
                                onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)';"
                                onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none';"
                            >
                                <svg style="width: 16px; height: 16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Save Changes
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        {{-- Function Builder Modal --}}
        @if($showFunctionBuilder)
            <div class="fixed inset-0 bg-gray-900/50 backdrop-blur-sm flex items-center justify-center z-50 p-4">
                <div class="bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                    <div class="flex items-center justify-between p-6 border-b border-gray-200">
                        <h3 class="text-xl font-bold text-gray-900">Function Builder</h3>
                        <button wire:click="closeFunctionBuilder" class="p-1.5 rounded-lg hover:bg-gray-100 transition-colors">
                            <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <div class="p-6 grid grid-cols-1 md:grid-cols-3 gap-6">
                        {{-- Templates --}}
                        <div class="md:col-span-1">
                            <h4 class="text-base font-semibold text-gray-900 mb-3">Templates</h4>
                            
                            <div class="space-y-3">
                                <div>
                                    <h5 class="text-sm font-medium text-gray-600 mb-2">Cal.com</h5>
                                    @foreach($functionTemplates['cal_com'] ?? [] as $template)
                                        <div 
                                            wire:click="selectFunctionTemplate('cal_com', '{{ $template['id'] }}')"
                                            class="function-template mb-2"
                                        >
                                            <div class="flex items-center gap-2">
                                                <svg class="w-4 h-4 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                                </svg>
                                                <span class="text-gray-700 text-sm">{{ $template['name'] }}</span>
                                            </div>
                                        </div>
                                    @endforeach
                                </div>
                                
                                <div>
                                    <h5 class="text-sm font-medium text-gray-600 mb-2">Database</h5>
                                    @foreach($functionTemplates['database'] ?? [] as $template)
                                        <div 
                                            wire:click="selectFunctionTemplate('database', '{{ $template['id'] }}')"
                                            class="function-template mb-2"
                                        >
                                            <div class="flex items-center gap-2">
                                                <svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"></path>
                                                </svg>
                                                <span class="text-gray-700 text-sm">{{ $template['name'] }}</span>
                                            </div>
                                        </div>
                                    @endforeach
                                </div>
                                
                                <div>
                                    <h5 class="text-sm font-medium text-gray-600 mb-2">System</h5>
                                    @foreach($functionTemplates['system'] ?? [] as $template)
                                        <div 
                                            wire:click="selectFunctionTemplate('system', '{{ $template['id'] }}')"
                                            class="function-template mb-2"
                                        >
                                            <div class="flex items-center gap-2">
                                                <svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                                </svg>
                                                <span class="text-gray-700 text-sm">{{ $template['name'] }}</span>
                                            </div>
                                        </div>
                                    @endforeach
                                </div>
                            </div>
                        </div>
                        
                        {{-- Editor --}}
                        <div class="md:col-span-2">
                            <h4 class="text-base font-semibold text-gray-900 mb-3">Function Configuration</h4>
                            
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Function Name</label>
                                    <input 
                                        type="text" 
                                        wire:model="editingFunction.name"
                                        class="w-full px-3 py-2 border border-gray-300 rounded-md text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                                        placeholder="my_custom_function"
                                    />
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                                    <textarea 
                                        wire:model="editingFunction.description"
                                        rows="3"
                                        class="w-full px-3 py-2 border border-gray-300 rounded-md text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                                        placeholder="Describe what this function does..."
                                    ></textarea>
                                </div>
                                
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">HTTP Method</label>
                                        <select 
                                            wire:model="editingFunction.method"
                                            class="w-full px-3 py-2 border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                                        >
                                            <option value="GET">GET</option>
                                            <option value="POST">POST</option>
                                            <option value="PUT">PUT</option>
                                            <option value="PATCH">PATCH</option>
                                            <option value="DELETE">DELETE</option>
                                        </select>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Type</label>
                                        <input 
                                            type="text" 
                                            wire:model="editingFunction.type"
                                            class="w-full px-3 py-2 border border-gray-300 rounded-md text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                                            placeholder="custom"
                                        />
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">URL</label>
                                    <input 
                                        type="text" 
                                        wire:model="editingFunction.url"
                                        class="w-full px-3 py-2 border border-gray-300 rounded-md text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                                        placeholder="https://api.example.com/endpoint"
                                    />
                                </div>
                                
                                <div class="space-y-2">
                                    <label class="flex items-center gap-2">
                                        <input 
                                            type="checkbox" 
                                            wire:model="editingFunction.speak_during_execution"
                                            class="w-4 h-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"
                                        />
                                        <span class="text-sm text-gray-700">Speak during execution</span>
                                    </label>
                                    
                                    @if($editingFunction['speak_during_execution'] ?? false)
                                        <input 
                                            type="text" 
                                            wire:model="editingFunction.speak_during_execution_message"
                                            class="w-full px-3 py-2 border border-gray-300 rounded-md text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 ml-6"
                                            placeholder="Message to speak during execution..."
                                        />
                                    @endif
                                    
                                    <label class="flex items-center gap-2">
                                        <input 
                                            type="checkbox" 
                                            wire:model="editingFunction.speak_after_execution"
                                            class="w-4 h-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"
                                        />
                                        <span class="text-sm text-gray-700">Speak after execution</span>
                                    </label>
                                    
                                    @if($editingFunction['speak_after_execution'] ?? false)
                                        <input 
                                            type="text" 
                                            wire:model="editingFunction.speak_after_execution_message"
                                            class="w-full px-3 py-2 border border-gray-300 rounded-md text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 ml-6"
                                            placeholder="Message to speak after execution..."
                                        />
                                    @endif
                                </div>
                            </div>
                            
                            <div class="flex justify-end gap-3 mt-6 pt-4 border-t border-gray-200">
                                <button wire:click="closeFunctionBuilder" class="modern-btn modern-btn-secondary">
                                    Cancel
                                </button>
                                <button wire:click="saveFunction" class="modern-btn modern-btn-primary">
                                    Save Function
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        @endif
    </div>
    
    {{-- Alpine.js Component --}}
    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.data('controlCenter', () => ({
                activeTab: 'dashboard',
                
                init() {
                    // Initialize any charts or real-time connections here
                    this.setupRealtimeUpdates();
                },
                
                setupRealtimeUpdates() {
                    // In production, this would connect to WebSocket for real-time updates
                    setInterval(() => {
                        // Simulate real-time metric updates
                        if (this.activeTab === 'dashboard') {
                            @this.call('loadMetrics');
                        }
                    }, 30000); // Update every 30 seconds
                }
            }));
        });
    </script>
</x-filament-panels::page>